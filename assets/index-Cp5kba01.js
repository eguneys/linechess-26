const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MainLegal-DUEYKLB5.js","assets/MainLegal-CZOPaPYE.css","assets/MainAbout-C_NaL66t.js","assets/MainContact-DwWDH6WT.js","assets/MainContact-BM86F0VK.css"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();const L={context:void 0,registry:void 0,effects:void 0,done:!1,getContextId(){return fr(this.context.count)},getNextContextId(){return fr(this.context.count++)}};function fr(e){const t=String(e),n=t.length-1;return L.context.id+(n?String.fromCharCode(96+n):"")+t}function at(e){L.context=e}const Tr=!1,Dr=(e,t)=>e===t,Rt=Symbol("solid-proxy"),Ir=typeof Proxy=="function",Yi=Symbol("solid-track"),Ot={equals:Dr};let Br=Hr;const ue=1,Lt=2,Fr={owned:null,cleanups:null,context:null,owner:null},un={};var I=null;let dn=null,Zi=null,q=null,X=null,he=null,Gt=0;function Ze(e,t){const n=q,r=I,i=e.length===0,o=t===void 0?r:t,s=i?Fr:{owned:null,cleanups:null,context:o?o.context:null,owner:o},l=i?e:()=>e(()=>J(()=>ft(s)));I=s,q=null;try{return be(l,!0)}finally{q=n,I=r}}function F(e,t){t=t?Object.assign({},Ot,t):Ot;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},r=i=>(typeof i=="function"&&(i=i(n.value)),zr(n,i));return[jr.bind(n),r]}function Ji(e,t,n){const r=_t(e,t,!0,ue);Ue(r)}function Y(e,t,n){const r=_t(e,t,!1,ue);Ue(r)}function we(e,t,n){Br=lo;const r=_t(e,t,!1,ue);(!n||!n.render)&&(r.user=!0),he?he.push(r):Ue(r)}function S(e,t,n){n=n?Object.assign({},Ot,n):Ot;const r=_t(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,Ue(r),jr.bind(r)}function eo(e){return e&&typeof e=="object"&&"then"in e}function to(e,t,n){let r,i,o;r=!0,i=e,o={};let s=null,l=un,c=null,a=!1,d="initialValue"in o,u=typeof r=="function"&&S(r);const f=new Set,[h,w]=(o.storage||F)(o.initialValue),[g,y]=F(void 0),[_,v]=F(void 0,{equals:!1}),[D,A]=F(d?"ready":"unresolved");L.context&&(c=L.getNextContextId(),o.ssrLoadFrom==="initial"?l=o.initialValue:L.load&&L.has(c)&&(l=L.load(c)));function P(T,b,E,C){return s===T&&(s=null,C!==void 0&&(d=!0),(T===l||b===l)&&o.onHydrated&&queueMicrotask(()=>o.onHydrated(C,{value:b})),l=un,U(b,E)),b}function U(T,b){be(()=>{b===void 0&&w(()=>T),A(b!==void 0?"errored":d?"ready":"unresolved"),y(b);for(const E of f.keys())E.decrement();f.clear()},!1)}function K(){const T=io,b=h(),E=g();if(E!==void 0&&!s)throw E;return q&&q.user,b}function O(T=!0){if(T!==!1&&a)return;a=!1;const b=u?u():r;if(b==null||b===!1){P(s,J(h));return}let E;const C=l!==un?l:J(()=>{try{return i(b,{value:h(),refetching:T})}catch($){E=$}});if(E!==void 0){P(s,void 0,At(E),b);return}else if(!eo(C))return P(s,C,void 0,b),C;return s=C,"v"in C?(C.s===1?P(s,C.v,void 0,b):P(s,void 0,At(C.v),b),C):(a=!0,queueMicrotask(()=>a=!1),be(()=>{A(d?"refreshing":"pending"),v()},!1),C.then($=>P(C,$,void 0,b),$=>P(C,void 0,At($),b)))}Object.defineProperties(K,{state:{get:()=>D()},error:{get:()=>g()},loading:{get(){const T=D();return T==="pending"||T==="refreshing"}},latest:{get(){if(!d)return K();const T=g();if(T&&!s)throw T;return h()}}});let ee=I;return u?Ji(()=>(ee=I,O(!1))):O(!1),[K,{refetch:T=>Vt(ee,()=>O(T)),mutate:w}]}function no(e,t=Dr,n){const r=new Map,i=_t(o=>{const s=e();for(const[l,c]of r.entries())if(t(l,s)!==t(l,o))for(const a of c.values())a.state=ue,a.pure?X.push(a):he.push(a);return s},void 0,!0,ue);return Ue(i),o=>{const s=q;if(s){let l;(l=r.get(o))?l.add(s):r.set(o,l=new Set([s])),Ce(()=>{l.delete(s),!l.size&&r.delete(o)})}return t(o,i.value)}}function qr(e){return be(e,!1)}function J(e){if(q===null)return e();const t=q;q=null;try{return e()}finally{q=t}}function Bn(e,t,n){const r=Array.isArray(e);let i,o=n&&n.defer;return s=>{let l;if(r){l=Array(e.length);for(let a=0;a<e.length;a++)l[a]=e[a]()}else l=e();if(o)return o=!1,s;const c=J(()=>t(l,i,s));return i=l,c}}function Fn(e){we(()=>J(e))}function Ce(e){return I===null||(I.cleanups===null?I.cleanups=[e]:I.cleanups.push(e)),e}function xt(){return I}function Vt(e,t){const n=I,r=q;I=e,q=null;try{return be(t,!0)}catch(i){Kn(i)}finally{I=n,q=r}}function ro(e){const t=q,n=I;return Promise.resolve().then(()=>{q=t,I=n;let r;return be(e,!1),q=I=null,r?r.done:void 0})}const[Ra,Oa]=F(!1);function Kr(e,t){const n=Symbol("context");return{id:n,Provider:co(n),defaultValue:e}}function qn(e){let t;return I&&I.context&&(t=I.context[e.id])!==void 0?t:e.defaultValue}function Qt(e){const t=S(e),n=S(()=>vn(t()));return n.toArray=()=>{const r=n();return Array.isArray(r)?r:r!=null?[r]:[]},n}let io;function jr(){if(this.sources&&this.state)if(this.state===ue)Ue(this);else{const e=X;X=null,be(()=>Tt(this),!1),X=e}if(q){const e=this.observers?this.observers.length:0;q.sources?(q.sources.push(this),q.sourceSlots.push(e)):(q.sources=[this],q.sourceSlots=[e]),this.observers?(this.observers.push(q),this.observerSlots.push(q.sources.length-1)):(this.observers=[q],this.observerSlots=[q.sources.length-1])}return this.value}function zr(e,t,n){let r=e.value;return(!e.comparator||!e.comparator(r,t))&&(e.value=t,e.observers&&e.observers.length&&be(()=>{for(let i=0;i<e.observers.length;i+=1){const o=e.observers[i],s=dn&&dn.running;s&&dn.disposed.has(o),(s?!o.tState:!o.state)&&(o.pure?X.push(o):he.push(o),o.observers&&Ur(o)),s||(o.state=ue)}if(X.length>1e6)throw X=[],new Error},!1)),t}function Ue(e){if(!e.fn)return;ft(e);const t=Gt;oo(e,e.value,t)}function oo(e,t,n){let r;const i=I,o=q;q=I=e;try{r=e.fn(t)}catch(s){return e.pure&&(e.state=ue,e.owned&&e.owned.forEach(ft),e.owned=null),e.updatedAt=n+1,Kn(s)}finally{q=o,I=i}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?zr(e,r):e.value=r,e.updatedAt=n)}function _t(e,t,n,r=ue,i){const o={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:I,context:I?I.context:null,pure:n};return I===null||I!==Fr&&(I.owned?I.owned.push(o):I.owned=[o]),o}function Nt(e){if(e.state===0)return;if(e.state===Lt)return Tt(e);if(e.suspense&&J(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<Gt);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===ue)Ue(e);else if(e.state===Lt){const r=X;X=null,be(()=>Tt(e,t[0]),!1),X=r}}function be(e,t){if(X)return e();let n=!1;t||(X=[]),he?n=!0:he=[],Gt++;try{const r=e();return so(n),r}catch(r){n||(he=null),X=null,Kn(r)}}function so(e){if(X&&(Hr(X),X=null),e)return;const t=he;he=null,t.length&&be(()=>Br(t),!1)}function Hr(e){for(let t=0;t<e.length;t++)Nt(e[t])}function lo(e){let t,n=0;for(t=0;t<e.length;t++){const r=e[t];r.user?e[n++]=r:Nt(r)}if(L.context){if(L.count){L.effects||(L.effects=[]),L.effects.push(...e.slice(0,n));return}at()}for(L.effects&&(L.done||!L.count)&&(e=[...L.effects,...e],n+=L.effects.length,delete L.effects),t=0;t<n;t++)Nt(e[t])}function Tt(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const r=e.sources[n];if(r.sources){const i=r.state;i===ue?r!==t&&(!r.updatedAt||r.updatedAt<Gt)&&Nt(r):i===Lt&&Tt(r,t)}}}function Ur(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=Lt,n.pure?X.push(n):he.push(n),n.observers&&Ur(n))}}function ft(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),i=n.observers;if(i&&i.length){const o=i.pop(),s=n.observerSlots.pop();r<i.length&&(o.sourceSlots[s]=r,i[r]=o,n.observerSlots[r]=s)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)ft(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)ft(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function At(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function Kn(e,t=I){throw At(e)}function vn(e){if(typeof e=="function"&&!e.length)return vn(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const r=vn(e[n]);Array.isArray(r)?t.push.apply(t,r):t.push(r)}return t}return e}function co(e,t){return function(r){let i;return Y(()=>i=J(()=>(I.context={...I.context,[e]:r.value},Qt(()=>r.children))),void 0),i}}const ao=Symbol("fallback");function hr(e){for(let t=0;t<e.length;t++)e[t]()}function uo(e,t,n={}){let r=[],i=[],o=[],s=0,l=t.length>1?[]:null;return Ce(()=>hr(o)),()=>{let c=e()||[],a=c.length,d,u;return c[Yi],J(()=>{let h,w,g,y,_,v,D,A,P;if(a===0)s!==0&&(hr(o),o=[],r=[],i=[],s=0,l&&(l=[])),n.fallback&&(r=[ao],i[0]=Ze(U=>(o[0]=U,n.fallback())),s=1);else if(s===0){for(i=new Array(a),u=0;u<a;u++)r[u]=c[u],i[u]=Ze(f);s=a}else{for(g=new Array(a),y=new Array(a),l&&(_=new Array(a)),v=0,D=Math.min(s,a);v<D&&r[v]===c[v];v++);for(D=s-1,A=a-1;D>=v&&A>=v&&r[D]===c[A];D--,A--)g[A]=i[D],y[A]=o[D],l&&(_[A]=l[D]);for(h=new Map,w=new Array(A+1),u=A;u>=v;u--)P=c[u],d=h.get(P),w[u]=d===void 0?-1:d,h.set(P,u);for(d=v;d<=D;d++)P=r[d],u=h.get(P),u!==void 0&&u!==-1?(g[u]=i[d],y[u]=o[d],l&&(_[u]=l[d]),u=w[u],h.set(P,u)):o[d]();for(u=v;u<a;u++)u in g?(i[u]=g[u],o[u]=y[u],l&&(l[u]=_[u],l[u](u))):i[u]=Ze(f);i=i.slice(0,s=a),r=c.slice(0)}return i});function f(h){if(o[u]=h,l){const[w,g]=F(u);return l[u]=g,t(c[u],w)}return t(c[u])}}}function m(e,t){return J(()=>e(t||{}))}function St(){return!0}const kn={get(e,t,n){return t===Rt?n:e.get(t)},has(e,t){return t===Rt?!0:e.has(t)},set:St,deleteProperty:St,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:St,deleteProperty:St}},ownKeys(e){return e.keys()}};function fn(e){return(e=typeof e=="function"?e():e)?e:{}}function fo(){for(let e=0,t=this.length;e<t;++e){const n=this[e]();if(n!==void 0)return n}}function Ae(...e){let t=!1;for(let s=0;s<e.length;s++){const l=e[s];t=t||!!l&&Rt in l,e[s]=typeof l=="function"?(t=!0,S(l)):l}if(Ir&&t)return new Proxy({get(s){for(let l=e.length-1;l>=0;l--){const c=fn(e[l])[s];if(c!==void 0)return c}},has(s){for(let l=e.length-1;l>=0;l--)if(s in fn(e[l]))return!0;return!1},keys(){const s=[];for(let l=0;l<e.length;l++)s.push(...Object.keys(fn(e[l])));return[...new Set(s)]}},kn);const n={},r=Object.create(null);for(let s=e.length-1;s>=0;s--){const l=e[s];if(!l)continue;const c=Object.getOwnPropertyNames(l);for(let a=c.length-1;a>=0;a--){const d=c[a];if(d==="__proto__"||d==="constructor")continue;const u=Object.getOwnPropertyDescriptor(l,d);if(!r[d])r[d]=u.get?{enumerable:!0,configurable:!0,get:fo.bind(n[d]=[u.get.bind(l)])}:u.value!==void 0?u:void 0;else{const f=n[d];f&&(u.get?f.push(u.get.bind(l)):u.value!==void 0&&f.push(()=>u.value))}}}const i={},o=Object.keys(r);for(let s=o.length-1;s>=0;s--){const l=o[s],c=r[l];c&&c.get?Object.defineProperty(i,l,c):i[l]=c?c.value:void 0}return i}function Wr(e,...t){const n=t.length;if(Ir&&Rt in e){const i=n>1?t.flat():t[0],o=t.map(s=>new Proxy({get(l){return s.includes(l)?e[l]:void 0},has(l){return s.includes(l)&&l in e},keys(){return s.filter(l=>l in e)}},kn));return o.push(new Proxy({get(s){return i.includes(s)?void 0:e[s]},has(s){return i.includes(s)?!1:s in e},keys(){return Object.keys(e).filter(s=>!i.includes(s))}},kn)),o}const r=[];for(let i=0;i<=n;i++)r[i]={};for(const i of Object.getOwnPropertyNames(e)){let o=n;for(let c=0;c<t.length;c++)if(t[c].includes(i)){o=c;break}const s=Object.getOwnPropertyDescriptor(e,i);!s.get&&!s.set&&s.enumerable&&s.writable&&s.configurable?r[o][i]=s.value:Object.defineProperty(r[o],i,s)}return r}function Xt(e){let t,n;const r=i=>{const o=L.context;if(o){const[l,c]=F();L.count||(L.count=0),L.count++,(n||(n=e())).then(a=>{!L.done&&at(o),L.count--,c(()=>a.default),at()}),t=l}else if(!t){const[l]=to(()=>(n||(n=e())).then(c=>c.default));t=l}let s;return S(()=>(s=t())?J(()=>{if(!o||L.done)return s(i);const l=L.context;at(o);const c=s(i);return at(l),c}):"")};return r.preload=()=>n||((n=e()).then(i=>t=()=>i.default),n),r}const ho=e=>`Stale read from <${e}>.`;function jn(e){const t="fallback"in e&&{fallback:()=>e.fallback};return S(uo(()=>e.each,e.children,t||void 0))}function et(e){const t=e.keyed,n=S(()=>e.when,void 0,void 0),r=t?n:S(n,void 0,{equals:(i,o)=>!i==!o});return S(()=>{const i=r();if(i){const o=e.children;return typeof o=="function"&&o.length>0?J(()=>o(t?i:()=>{if(!J(r))throw ho("Show");return n()})):o}return e.fallback},void 0,void 0)}const po=["allowfullscreen","async","alpha","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected","adauctionheaders","browsingtopics","credentialless","defaultchecked","defaultmuted","defaultselected","defer","disablepictureinpicture","disableremoteplayback","preservespitch","shadowrootclonable","shadowrootcustomelementregistry","shadowrootdelegatesfocus","shadowrootserializable","sharedstoragewritable"],go=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline","adAuctionHeaders","allowFullscreen","browsingTopics","defaultChecked","defaultMuted","defaultSelected","disablePictureInPicture","disableRemotePlayback","preservesPitch","shadowRootClonable","shadowRootCustomElementRegistry","shadowRootDelegatesFocus","shadowRootSerializable","sharedStorageWritable",...po]),mo=new Set(["innerHTML","textContent","innerText","children"]),wo=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),bo=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1},adauctionheaders:{$:"adAuctionHeaders",IFRAME:1},allowfullscreen:{$:"allowFullscreen",IFRAME:1},browsingtopics:{$:"browsingTopics",IMG:1},defaultchecked:{$:"defaultChecked",INPUT:1},defaultmuted:{$:"defaultMuted",AUDIO:1,VIDEO:1},defaultselected:{$:"defaultSelected",OPTION:1},disablepictureinpicture:{$:"disablePictureInPicture",VIDEO:1},disableremoteplayback:{$:"disableRemotePlayback",AUDIO:1,VIDEO:1},preservespitch:{$:"preservesPitch",AUDIO:1,VIDEO:1},shadowrootclonable:{$:"shadowRootClonable",TEMPLATE:1},shadowrootdelegatesfocus:{$:"shadowRootDelegatesFocus",TEMPLATE:1},shadowrootserializable:{$:"shadowRootSerializable",TEMPLATE:1},sharedstoragewritable:{$:"sharedStorageWritable",IFRAME:1,IMG:1}});function yo(e,t){const n=bo[e];return typeof n=="object"?n[t]?n.$:void 0:n}const vo=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),tt=e=>S(()=>e());function ko(e,t,n){let r=n.length,i=t.length,o=r,s=0,l=0,c=t[i-1].nextSibling,a=null;for(;s<i||l<o;){if(t[s]===n[l]){s++,l++;continue}for(;t[i-1]===n[o-1];)i--,o--;if(i===s){const d=o<r?l?n[l-1].nextSibling:n[o-l]:c;for(;l<o;)e.insertBefore(n[l++],d)}else if(o===l)for(;s<i;)(!a||!a.has(t[s]))&&t[s].remove(),s++;else if(t[s]===n[o-1]&&n[l]===t[i-1]){const d=t[--i].nextSibling;e.insertBefore(n[l++],t[s++].nextSibling),e.insertBefore(n[--o],d),t[i]=n[o]}else{if(!a){a=new Map;let u=l;for(;u<o;)a.set(n[u],u++)}const d=a.get(t[s]);if(d!=null)if(l<d&&d<o){let u=s,f=1,h;for(;++u<i&&u<o&&!((h=a.get(t[u]))==null||h!==d+f);)f++;if(f>d-l){const w=t[s];for(;l<d;)e.insertBefore(n[l++],w)}else e.replaceChild(n[l++],t[s++])}else s++;else t[s++].remove()}}}const pr="_$DX_DELEGATE";function _o(e,t,n,r={}){let i;return Ze(o=>{i=o,t===document?e():k(t,e(),t.firstChild?null:void 0,n)},r.owner),()=>{i(),t.textContent=""}}function N(e,t,n,r){let i;const o=()=>{const l=document.createElement("template");return l.innerHTML=e,l.content.firstChild},s=()=>(i||(i=o())).cloneNode(!0);return s.cloneNode=s,s}function Pe(e,t=window.document){const n=t[pr]||(t[pr]=new Set);for(let r=0,i=e.length;r<i;r++){const o=e[r];n.has(o)||(n.add(o),t.addEventListener(o,Ao))}}function ht(e,t,n){Ct(e)||(n==null?e.removeAttribute(t):e.setAttribute(t,n))}function Co(e,t,n){Ct(e)||(n?e.setAttribute(t,""):e.removeAttribute(t))}function Po(e,t){Ct(e)||(t==null?e.removeAttribute("class"):e.className=t)}function qe(e,t,n,r){if(r)Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n;else if(Array.isArray(n)){const i=n[0];e.addEventListener(t,n[0]=o=>i.call(e,n[1],o))}else e.addEventListener(t,n,typeof n!="function"&&n)}function Eo(e,t,n={}){const r=Object.keys(t||{}),i=Object.keys(n);let o,s;for(o=0,s=i.length;o<s;o++){const l=i[o];!l||l==="undefined"||t[l]||(gr(e,l,!1),delete n[l])}for(o=0,s=r.length;o<s;o++){const l=r[o],c=!!t[l];!l||l==="undefined"||n[l]===c||!c||(gr(e,l,!0),n[l]=c)}return n}function Gr(e,t,n){if(!t)return n?ht(e,"style"):t;const r=e.style;if(typeof t=="string")return r.cssText=t;typeof n=="string"&&(r.cssText=n=void 0),n||(n={}),t||(t={});let i,o;for(o in n)t[o]==null&&r.removeProperty(o),delete n[o];for(o in t)i=t[o],i!==n[o]&&(r.setProperty(o,i),n[o]=i);return n}function nt(e,t={},n,r){const i={};return Y(()=>i.children=pt(e,t.children,i.children)),Y(()=>typeof t.ref=="function"&&Me(t.ref,e)),Y(()=>$o(e,t,n,!0,i,!0)),i}function Me(e,t,n){return J(()=>e(t,n))}function k(e,t,n,r){if(n!==void 0&&!r&&(r=[]),typeof t!="function")return pt(e,t,r,n);Y(i=>pt(e,t(),i,n),r)}function $o(e,t,n,r,i={},o=!1){t||(t={});for(const s in i)if(!(s in t)){if(s==="children")continue;i[s]=mr(e,s,null,i[s],n,o,t)}for(const s in t){if(s==="children")continue;const l=t[s];i[s]=mr(e,s,l,i[s],n,o,t)}}function Ct(e){return!!L.context&&!L.done&&(!e||e.isConnected)}function So(e){return e.toLowerCase().replace(/-([a-z])/g,(t,n)=>n.toUpperCase())}function gr(e,t,n){const r=t.trim().split(/\s+/);for(let i=0,o=r.length;i<o;i++)e.classList.toggle(r[i],n)}function mr(e,t,n,r,i,o,s){let l,c,a,d,u;if(t==="style")return Gr(e,n,r);if(t==="classList")return Eo(e,n,r);if(n===r)return r;if(t==="ref")o||n(e);else if(t.slice(0,3)==="on:"){const f=t.slice(3);r&&e.removeEventListener(f,r,typeof r!="function"&&r),n&&e.addEventListener(f,n,typeof n!="function"&&n)}else if(t.slice(0,10)==="oncapture:"){const f=t.slice(10);r&&e.removeEventListener(f,r,!0),n&&e.addEventListener(f,n,!0)}else if(t.slice(0,2)==="on"){const f=t.slice(2).toLowerCase(),h=vo.has(f);if(!h&&r){const w=Array.isArray(r)?r[0]:r;e.removeEventListener(f,w)}(h||n)&&(qe(e,f,n,h),h&&Pe([f]))}else if(t.slice(0,5)==="attr:")ht(e,t.slice(5),n);else if(t.slice(0,5)==="bool:")Co(e,t.slice(5),n);else if((u=t.slice(0,5)==="prop:")||(a=mo.has(t))||(d=yo(t,e.tagName))||(c=go.has(t))||(l=e.nodeName.includes("-")||"is"in s)){if(u)t=t.slice(5),c=!0;else if(Ct(e))return n;t==="class"||t==="className"?Po(e,n):l&&!c&&!a?e[So(t)]=n:e[d||t]=n}else ht(e,wo[t]||t,n);return n}function Ao(e){if(L.registry&&L.events&&L.events.find(([c,a])=>a===e))return;let t=e.target;const n=`$$${e.type}`,r=e.target,i=e.currentTarget,o=c=>Object.defineProperty(e,"target",{configurable:!0,value:c}),s=()=>{const c=t[n];if(c&&!t.disabled){const a=t[`${n}Data`];if(a!==void 0?c.call(t,a,e):c.call(t,e),e.cancelBubble)return}return t.host&&typeof t.host!="string"&&!t.host._$host&&t.contains(e.target)&&o(t.host),!0},l=()=>{for(;s()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}}),L.registry&&!L.done&&(L.done=_$HY.done=!0),e.composedPath){const c=e.composedPath();o(c[0]);for(let a=0;a<c.length-2&&(t=c[a],!!s());a++){if(t._$host){t=t._$host,l();break}if(t.parentNode===i)break}}else l();o(r)}function pt(e,t,n,r,i){const o=Ct(e);if(o){!n&&(n=[...e.childNodes]);let c=[];for(let a=0;a<n.length;a++){const d=n[a];d.nodeType===8&&d.data.slice(0,2)==="!$"?d.remove():c.push(d)}n=c}for(;typeof n=="function";)n=n();if(t===n)return n;const s=typeof t,l=r!==void 0;if(e=l&&n[0]&&n[0].parentNode||e,s==="string"||s==="number"){if(o||s==="number"&&(t=t.toString(),t===n))return n;if(l){let c=n[0];c&&c.nodeType===3?c.data!==t&&(c.data=t):c=document.createTextNode(t),n=Ve(e,n,r,c)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||s==="boolean"){if(o)return n;n=Ve(e,n,r)}else{if(s==="function")return Y(()=>{let c=t();for(;typeof c=="function";)c=c();n=pt(e,c,n,r)}),()=>n;if(Array.isArray(t)){const c=[],a=n&&Array.isArray(n);if(_n(c,t,n,i))return Y(()=>n=pt(e,c,n,r,!0)),()=>n;if(o){if(!c.length)return n;if(r===void 0)return n=[...e.childNodes];let d=c[0];if(d.parentNode!==e)return n;const u=[d];for(;(d=d.nextSibling)!==r;)u.push(d);return n=u}if(c.length===0){if(n=Ve(e,n,r),l)return n}else a?n.length===0?wr(e,c,r):ko(e,n,c):(n&&Ve(e),wr(e,c));n=c}else if(t.nodeType){if(o&&t.parentNode)return n=l?[t]:t;if(Array.isArray(n)){if(l)return n=Ve(e,n,r,t);Ve(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function _n(e,t,n,r){let i=!1;for(let o=0,s=t.length;o<s;o++){let l=t[o],c=n&&n[e.length],a;if(!(l==null||l===!0||l===!1))if((a=typeof l)=="object"&&l.nodeType)e.push(l);else if(Array.isArray(l))i=_n(e,l,c)||i;else if(a==="function")if(r){for(;typeof l=="function";)l=l();i=_n(e,Array.isArray(l)?l:[l],Array.isArray(c)?c:[c])||i}else e.push(l),i=!0;else{const d=String(l);c&&c.nodeType===3&&c.data===d?e.push(c):e.push(document.createTextNode(d))}}return i}function wr(e,t,n=null){for(let r=0,i=t.length;r<i;r++)e.insertBefore(t[r],n)}function Ve(e,t,n,r){if(n===void 0)return e.textContent="";const i=r||document.createTextNode("");if(t.length){let o=!1;for(let s=t.length-1;s>=0;s--){const l=t[s];if(i!==l){const c=l.parentNode===e;!o&&!s?c?e.replaceChild(i,l):e.insertBefore(i,n):c&&l.remove()}else o=!0}}else e.insertBefore(i,n);return[i]}const Mo=!1,Ro="http://www.w3.org/2000/svg";function Oo(e,t=!1,n=void 0){return t?document.createElementNS(Ro,e):document.createElement(e,{is:n})}function zn(e){const{useShadow:t}=e,n=document.createTextNode(""),r=()=>e.mount||document.body,i=xt();let o,s=!!L.context;return we(()=>{s&&(xt().user=s=!1),o||(o=Vt(i,()=>S(()=>e.children)));const l=r();if(l instanceof HTMLHeadElement){const[c,a]=F(!1),d=()=>a(!0);Ze(u=>k(l,()=>c()?u():o(),null)),Ce(d)}else{const c=Oo(e.isSVG?"g":"div",e.isSVG),a=t&&c.attachShadow?c.attachShadow({mode:"open"}):c;Object.defineProperty(c,"_$host",{get(){return n.parentNode},configurable:!0}),k(a,o),l.appendChild(c),e.ref&&e.ref(c),Ce(()=>l.removeChild(c))}},void 0,{render:!s}),n}const Lo="modulepreload",xo=function(e){return"/"+e},br={},Yt=function(t,n,r){let i=Promise.resolve();if(n&&n.length>0){let c=function(a){return Promise.all(a.map(d=>Promise.resolve(d).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),l=s?.nonce||s?.getAttribute("nonce");i=c(n.map(a=>{if(a=xo(a),a in br)return;br[a]=!0;const d=a.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${u}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":Lo,d||(f.as="script"),f.crossOrigin="",f.href=a,l&&f.setAttribute("nonce",l),document.head.appendChild(f),d)return new Promise((h,w)=>{f.addEventListener("load",h),f.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${a}`)))})}))}function o(s){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s}return i.then(s=>{for(const l of s||[])l.status==="rejected"&&o(l.reason);return t().catch(o)})};function Vr(){let e=new Set;function t(i){return e.add(i),()=>e.delete(i)}let n=!1;function r(i,o){if(n)return!(n=!1);const s={to:i,options:o,defaultPrevented:!1,preventDefault:()=>s.defaultPrevented=!0};for(const l of e)l.listener({...s,from:l.location,retry:c=>{c&&(n=!0),l.navigate(i,{...o,resolve:!1})}});return!s.defaultPrevented}return{subscribe:t,confirm:r}}let Cn;function Hn(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Cn=window.history.state._depth}Hn();function No(e){return{...e,_depth:window.history.state&&window.history.state._depth}}function To(e,t){let n=!1;return()=>{const r=Cn;Hn();const i=r==null?null:Cn-r;if(n){n=!1;return}i&&t(i)?(n=!0,window.history.go(-i)):e()}}const Do=/^(?:[a-z0-9]+:)?\/\//i,Io=/^\/+|(\/)\/+$/g,Qr="http://sr";function Ke(e,t=!1){const n=e.replace(Io,"$1");return n?t||/^[?#]/.test(n)?n:"/"+n:""}function Mt(e,t,n){if(Do.test(t))return;const r=Ke(e),i=n&&Ke(n);let o="";return!i||t.startsWith("/")?o=r:i.toLowerCase().indexOf(r.toLowerCase())!==0?o=r+i:o=i,(o||"/")+Ke(t,!o)}function Bo(e,t){if(e==null)throw new Error(t);return e}function Fo(e,t){return Ke(e).replace(/\/*(\*.*)?$/g,"")+Ke(t)}function Xr(e){const t={};return e.searchParams.forEach((n,r)=>{r in t?Array.isArray(t[r])?t[r].push(n):t[r]=[t[r],n]:t[r]=n}),t}function qo(e,t,n){const[r,i]=e.split("/*",2),o=r.split("/").filter(Boolean),s=o.length;return l=>{const c=l.split("/").filter(Boolean),a=c.length-s;if(a<0||a>0&&i===void 0&&!t)return null;const d={path:s?"":"/",params:{}},u=f=>n===void 0?void 0:n[f];for(let f=0;f<s;f++){const h=o[f],w=h[0]===":",g=w?c[f]:c[f].toLowerCase(),y=w?h.slice(1):h.toLowerCase();if(w&&hn(g,u(y)))d.params[y]=g;else if(w||!hn(g,y))return null;d.path+=`/${g}`}if(i){const f=a?c.slice(-a).join("/"):"";if(hn(f,u(i)))d.params[i]=f;else return null}return d}}function hn(e,t){const n=r=>r===e;return t===void 0?!0:typeof t=="string"?n(t):typeof t=="function"?t(e):Array.isArray(t)?t.some(n):t instanceof RegExp?t.test(e):!1}function Ko(e){const[t,n]=e.pattern.split("/*",2),r=t.split("/").filter(Boolean);return r.reduce((i,o)=>i+(o.startsWith(":")?2:3),r.length-(n===void 0?0:1))}function Yr(e){const t=new Map,n=xt();return new Proxy({},{get(r,i){return t.has(i)||Vt(n,()=>t.set(i,S(()=>e()[i]))),t.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(e())},has(r,i){return i in e()}})}function Zr(e){let t=/(\/?\:[^\/]+)\?/.exec(e);if(!t)return[e];let n=e.slice(0,t.index),r=e.slice(t.index+t[0].length);const i=[n,n+=t[1]];for(;t=/^(\/\:[^\/]+)\?/.exec(r);)i.push(n+=t[1]),r=r.slice(t[0].length);return Zr(r).reduce((o,s)=>[...o,...i.map(l=>l+s)],[])}const jo=100,Jr=Kr(),Un=Kr(),Wn=()=>Bo(qn(Jr),"<A> and 'use' router primitives can be only used inside a Route."),zo=()=>qn(Un)||Wn().base,Ho=e=>{const t=zo();return S(()=>t.resolvePath(e()))},Uo=e=>{const t=Wn();return S(()=>{const n=e();return n!==void 0?t.renderPath(n):n})},Wo=()=>Wn().location;function Go(e,t=""){const{component:n,preload:r,load:i,children:o,info:s}=e,l=!o||Array.isArray(o)&&!o.length,c={key:e,component:n,preload:r||i,info:s};return ei(e.path).reduce((a,d)=>{for(const u of Zr(d)){const f=Fo(t,u);let h=l?f:f.split("/*",1)[0];h=h.split("/").map(w=>w.startsWith(":")||w.startsWith("*")?w:encodeURIComponent(w)).join("/"),a.push({...c,originalPath:d,pattern:h,matcher:qo(h,!l,e.matchFilters)})}return a},[])}function Vo(e,t=0){return{routes:e,score:Ko(e[e.length-1])*1e4-t,matcher(n){const r=[];for(let i=e.length-1;i>=0;i--){const o=e[i],s=o.matcher(n);if(!s)return null;r.unshift({...s,route:o})}return r}}}function ei(e){return Array.isArray(e)?e:[e]}function ti(e,t="",n=[],r=[]){const i=ei(e);for(let o=0,s=i.length;o<s;o++){const l=i[o];if(l&&typeof l=="object"){l.hasOwnProperty("path")||(l.path="");const c=Go(l,t);for(const a of c){n.push(a);const d=Array.isArray(l.children)&&l.children.length===0;if(l.children&&!d)ti(l.children,a.pattern,n,r);else{const u=Vo([...n],r.length);r.push(u)}n.pop()}}}return n.length?r:r.sort((o,s)=>s.score-o.score)}function pn(e,t){for(let n=0,r=e.length;n<r;n++){const i=e[n].matcher(t);if(i)return i}return[]}function Qo(e,t,n){const r=new URL(Qr),i=S(d=>{const u=e();try{return new URL(u,r)}catch{return console.error(`Invalid path ${u}`),d}},r,{equals:(d,u)=>d.href===u.href}),o=S(()=>i().pathname),s=S(()=>i().search,!0),l=S(()=>i().hash),c=()=>"",a=Bn(s,()=>Xr(i()));return{get pathname(){return o()},get search(){return s()},get hash(){return l()},get state(){return t()},get key(){return c()},query:n?n(a):Yr(a)}}let Ie;function Xo(){return Ie}function Yo(e,t,n,r={}){const{signal:[i,o],utils:s={}}=e,l=s.parsePath||($=>$),c=s.renderPath||($=>$),a=s.beforeLeave||Vr(),d=Mt("",r.base||"");if(d===void 0)throw new Error(`${d} is not a valid base path`);d&&!i().value&&o({value:d,replace:!0,scroll:!1});const[u,f]=F(!1);let h;const w=($,x)=>{x.value===g()&&x.state===_()||(h===void 0&&f(!0),Ie=$,h=x,ro(()=>{h===x&&(y(h.value),v(h.state),P[1](z=>z.filter(te=>te.pending)))}).finally(()=>{h===x&&qr(()=>{Ie=void 0,$==="navigate"&&E(h),f(!1),h=void 0})}))},[g,y]=F(i().value),[_,v]=F(i().state),D=Qo(g,_,s.queryWrapper),A=[],P=F([]),U=S(()=>typeof r.transformUrl=="function"?pn(t(),r.transformUrl(D.pathname)):pn(t(),D.pathname)),K=()=>{const $=U(),x={};for(let z=0;z<$.length;z++)Object.assign(x,$[z].params);return x},O=s.paramsWrapper?s.paramsWrapper(K,t):Yr(K),ee={pattern:d,path:()=>d,outlet:()=>null,resolvePath($){return Mt(d,$)}};return Y(Bn(i,$=>w("native",$),{defer:!0})),{base:ee,location:D,params:O,isRouting:u,renderPath:c,parsePath:l,navigatorFactory:b,matches:U,beforeLeave:a,preloadRoute:C,singleFlight:r.singleFlight===void 0?!0:r.singleFlight,submissions:P};function T($,x,z){J(()=>{if(typeof x=="number"){x&&(s.go?s.go(x):console.warn("Router integration does not support relative routing"));return}const te=!x||x[0]==="?",{replace:G,resolve:j,scroll:ne,state:ie}={replace:!1,resolve:!te,scroll:!0,...z},Ee=j?$.resolvePath(x):Mt(te&&D.pathname||"",x);if(Ee===void 0)throw new Error(`Path '${x}' is not a routable path`);if(A.length>=jo)throw new Error("Too many redirects");const it=g();(Ee!==it||ie!==_())&&(Mo||a.confirm(Ee,z)&&(A.push({value:it,replace:G,scroll:ne,state:_()}),w("navigate",{value:Ee,state:ie})))})}function b($){return $=$||qn(Un)||ee,(x,z)=>T($,x,z)}function E($){const x=A[0];x&&(o({...$,replace:x.replace,scroll:x.scroll}),A.length=0)}function C($,x){const z=pn(t(),$.pathname),te=Ie;Ie="preload";for(let G in z){const{route:j,params:ne}=z[G];j.component&&j.component.preload&&j.component.preload();const{preload:ie}=j;x&&ie&&Vt(n(),()=>ie({params:ne,location:{pathname:$.pathname,search:$.search,hash:$.hash,query:Xr($),state:null,key:""},intent:"preload"}))}Ie=te}}function Zo(e,t,n,r){const{base:i,location:o,params:s}=e,{pattern:l,component:c,preload:a}=r().route,d=S(()=>r().path);c&&c.preload&&c.preload();const u=a?a({params:s,location:o,intent:Ie||"initial"}):void 0;return{parent:t,pattern:l,path:d,outlet:()=>c?m(c,{params:s,location:o,data:u,get children(){return n()}}):n(),resolvePath(h){return Mt(i.path(),h,d())}}}const Jo=e=>t=>{const{base:n}=t,r=Qt(()=>t.children),i=S(()=>ti(r(),t.base||""));let o;const s=Yo(e,i,()=>o,{base:n,singleFlight:t.singleFlight,transformUrl:t.transformUrl});return e.create&&e.create(s),m(Jr.Provider,{value:s,get children(){return m(es,{routerState:s,get root(){return t.root},get preload(){return t.rootPreload||t.rootLoad},get children(){return[tt(()=>(o=xt())&&null),m(ts,{routerState:s,get branches(){return i()}})]}})}})};function es(e){const t=e.routerState.location,n=e.routerState.params,r=S(()=>e.preload&&J(()=>{e.preload({params:n,location:t,intent:Xo()||"initial"})}));return m(et,{get when(){return e.root},keyed:!0,get fallback(){return e.children},children:i=>m(i,{params:n,location:t,get data(){return r()},get children(){return e.children}})})}function ts(e){const t=[];let n;const r=S(Bn(e.routerState.matches,(i,o,s)=>{let l=o&&i.length===o.length;const c=[];for(let a=0,d=i.length;a<d;a++){const u=o&&o[a],f=i[a];s&&u&&f.route.key===u.route.key?c[a]=s[a]:(l=!1,t[a]&&t[a](),Ze(h=>{t[a]=h,c[a]=Zo(e.routerState,c[a-1]||e.routerState.base,yr(()=>r()[a+1]),()=>{const w=e.routerState.matches();return w[a]??w[0]})}))}return t.splice(i.length).forEach(a=>a()),s&&l?s:(n=c[0],c)}));return yr(()=>r()&&n)()}const yr=e=>()=>m(et,{get when(){return e()},keyed:!0,children:t=>m(Un.Provider,{value:t,get children(){return t.outlet()}})}),ot=e=>{const t=Qt(()=>e.children);return Ae(e,{get children(){return t()}})};function ns([e,t],n,r){return[e,r?i=>t(r(i)):t]}function rs(e){let t=!1;const n=i=>typeof i=="string"?{value:i}:i,r=ns(F(n(e.get()),{equals:(i,o)=>i.value===o.value&&i.state===o.state}),void 0,i=>(!t&&e.set(i),L.registry&&!L.done&&(L.done=!0),i));return e.init&&Ce(e.init((i=e.get())=>{t=!0,r[1](n(i)),t=!1})),Jo({signal:r,create:e.create,utils:e.utils})}function is(e,t,n){return e.addEventListener(t,n),()=>e.removeEventListener(t,n)}function os(e,t){const n=e&&document.getElementById(e);n?n.scrollIntoView():t&&window.scrollTo(0,0)}const ss=new Map;function ls(e=!0,t=!1,n="/_server",r){return i=>{const o=i.base.path(),s=i.navigatorFactory(i.base);let l,c;function a(g){return g.namespaceURI==="http://www.w3.org/2000/svg"}function d(g){if(g.defaultPrevented||g.button!==0||g.metaKey||g.altKey||g.ctrlKey||g.shiftKey)return;const y=g.composedPath().find(U=>U instanceof Node&&U.nodeName.toUpperCase()==="A");if(!y||t&&!y.hasAttribute("link"))return;const _=a(y),v=_?y.href.baseVal:y.href;if((_?y.target.baseVal:y.target)||!v&&!y.hasAttribute("state"))return;const A=(y.getAttribute("rel")||"").split(/\s+/);if(y.hasAttribute("download")||A&&A.includes("external"))return;const P=_?new URL(v,document.baseURI):new URL(v);if(!(P.origin!==window.location.origin||o&&P.pathname&&!P.pathname.toLowerCase().startsWith(o.toLowerCase())))return[y,P]}function u(g){const y=d(g);if(!y)return;const[_,v]=y,D=i.parsePath(v.pathname+v.search+v.hash),A=_.getAttribute("state");g.preventDefault(),s(D,{resolve:!1,replace:_.hasAttribute("replace"),scroll:!_.hasAttribute("noscroll"),state:A?JSON.parse(A):void 0})}function f(g){const y=d(g);if(!y)return;const[_,v]=y;r&&(v.pathname=r(v.pathname)),i.preloadRoute(v,_.getAttribute("preload")!=="false")}function h(g){clearTimeout(l);const y=d(g);if(!y)return c=null;const[_,v]=y;c!==_&&(r&&(v.pathname=r(v.pathname)),l=setTimeout(()=>{i.preloadRoute(v,_.getAttribute("preload")!=="false"),c=_},20))}function w(g){if(g.defaultPrevented)return;let y=g.submitter&&g.submitter.hasAttribute("formaction")?g.submitter.getAttribute("formaction"):g.target.getAttribute("action");if(!y)return;if(!y.startsWith("https://action/")){const v=new URL(y,Qr);if(y=i.parsePath(v.pathname+v.search),!y.startsWith(n))return}if(g.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const _=ss.get(y);if(_){g.preventDefault();const v=new FormData(g.target,g.submitter);_.call({r:i,f:g.target},g.target.enctype==="multipart/form-data"?v:new URLSearchParams(v))}}Pe(["click","submit"]),document.addEventListener("click",u),e&&(document.addEventListener("mousemove",h,{passive:!0}),document.addEventListener("focusin",f,{passive:!0}),document.addEventListener("touchstart",f,{passive:!0})),document.addEventListener("submit",w),Ce(()=>{document.removeEventListener("click",u),e&&(document.removeEventListener("mousemove",h),document.removeEventListener("focusin",f),document.removeEventListener("touchstart",f)),document.removeEventListener("submit",w)})}}function cs(e){const t=()=>{const r=window.location.pathname.replace(/^\/+/,"/")+window.location.search,i=window.history.state&&window.history.state._depth&&Object.keys(window.history.state).length===1?void 0:window.history.state;return{value:r+window.location.hash,state:i}},n=Vr();return rs({get:t,set({value:r,replace:i,scroll:o,state:s}){i?window.history.replaceState(No(s),"",r):window.history.pushState(s,"",r),os(decodeURIComponent(window.location.hash.slice(1)),o),Hn()},init:r=>is(window,"popstate",To(r,i=>{if(i)return!n.confirm(i);{const o=t();return!n.confirm(o.value,{state:o.state})}})),create:ls(e.preload,e.explicitLinks,e.actionBase,e.transformUrl),utils:{go:r=>window.history.go(r),beforeLeave:n}})(e)}var as=N("<a>");function Qe(e){e=Ae({inactiveClass:"inactive",activeClass:"active"},e);const[,t]=Wr(e,["href","state","class","activeClass","inactiveClass","end"]),n=Ho(()=>e.href),r=Uo(n),i=Wo(),o=S(()=>{const s=n();if(s===void 0)return[!1,!1];const l=Ke(s.split(/[?#]/,1)[0]).toLowerCase(),c=decodeURI(Ke(i.pathname).toLowerCase());return[e.end?l===c:c.startsWith(l+"/")||c===l,l===c]});return(()=>{var s=as();return nt(s,Ae(t,{get href(){return r()||e.href},get state(){return JSON.stringify(e.state)},get classList(){return{...e.class&&{[e.class]:!0},[e.inactiveClass]:!o()[0],[e.activeClass]:o()[0],...t.classList}},link:"",get"aria-current"(){return o()[1]?"page":void 0}}),!1),s})()}const us=["white","black"],Dt=["a","b","c","d","e","f","g","h"],It=["1","2","3","4","5","6","7","8"],ds=[...It].reverse(),Zt=Dt.flatMap(e=>It.map(t=>e+t)),ye=e=>e.every(t=>t>=0&&t<=7)?Zt[8*e[0]+e[1]]:void 0,Te=e=>ye(e),B=e=>[e.charCodeAt(0)-97,e.charCodeAt(1)-49],ni=Zt.map(B),fs=Zt.map((e,t)=>({key:e,pos:ni[t]}));function ri(e){let t;const n=()=>(t===void 0&&(t=e()),t);return n.clear=()=>{t=void 0},n}const hs=()=>{let e;return{start(){e=performance.now()},cancel(){e=void 0},stop(){if(!e)return 0;const t=performance.now()-e;return e=void 0,t}}},Jt=e=>e==="white"?"black":"white",gt=(e,t)=>(e[0]-t[0])**2+(e[1]-t[1])**2,Bt=(e,t)=>e.role===t.role&&e.color===t.color,ps=(e,t)=>e[0]===t[0]&&e[1]===t[1],Pt=e=>(t,n)=>[(n?t[0]:7-t[0])*e.width/8,(n?7-t[1]:t[1])*e.height/8],de=(e,t)=>{e.style.transform=`translate(${t[0]}px,${t[1]}px)`},ii=(e,t,n=1)=>{e.style.transform=`translate(${t[0]}px,${t[1]}px) scale(${n})`},Gn=(e,t)=>{e.style.visibility=t?"visible":"hidden"},We=e=>{if(e.clientX||e.clientX===0)return[e.clientX,e.clientY];if(e.targetTouches?.[0])return[e.targetTouches[0].clientX,e.targetTouches[0].clientY]},gs=ri(()=>!("ontouchstart"in window)&&["macintosh","firefox"].every(e=>navigator.userAgent.toLowerCase().includes(e))),oi=e=>e.button===2&&!(e.ctrlKey&&gs()),_e=(e,t)=>{const n=document.createElement(e);return t&&(n.className=t),n};function si(e,t,n){const r=B(e);return t||(r[0]=7-r[0],r[1]=7-r[1]),[n.left+n.width*r[0]/8+n.width/16,n.top+n.height*(7-r[1])/8+n.height/16]}const ve=(e,t)=>Math.abs(e-t),Vn=(e,t,n,r)=>ve(e,n)*ve(t,r)===2,Qn=(e,t,n,r)=>e===n!=(t===r),Xn=(e,t,n,r)=>ve(e,n)===ve(t,r)&&e!==n,li=(e,t,n,r)=>Qn(e,t,n,r)||Xn(e,t,n,r),ci=(e,t,n,r)=>Math.max(ve(e,n),ve(t,r))===1,ai=(e,t,n,r,i)=>ve(e,n)===1&&r===t+(i?1:-1),ui=(e,t,n,r,i)=>{const o=i?1:-1;return e===n&&(r===t+o||r===t+2*o&&(i?t<=1:t>=6))},en=(e,t,n,r)=>{const i=n-e,o=r-t;if(i&&o&&Math.abs(i)!==Math.abs(o))return[];const s=Math.sign(i),l=Math.sign(o),c=[];let a=e+s,d=t+l;for(;a!==n||d!==r;)c.push([a,d]),a+=s,d+=l;return c.map(ye).filter(u=>u!==void 0)},ms=e=>{const t=B(e),n=[];return t[0]>0&&n.push([t[0]-1,t[1]]),t[0]<7&&n.push([t[0]+1,t[1]]),n.map(ye).filter(r=>r!==void 0)},Ft=(e,t)=>{const n=B(e);return n[1]+=t,ye(n)},rt=e=>e.friendlies.has(e.dest.key),ws=e=>e.enemies.has(e.dest.key),di=(e,t,n)=>en(...e,...t).some(r=>n.has(r)),fi=(e,t,n)=>{const r=n.enemies.get(e);if(r?.role!=="pawn")return!1;const i=r.color==="white"?1:-1,o=B(e),s=B(t);return ui(...o,...s,r.color==="white")&&!di(o,[s[0],s[1]+i],n.allPieces)},bs=(e,t,n)=>{const r=n.enemies.get(e);return r?.role==="pawn"&&ai(...B(e),...B(t),r.color==="white")&&(n.friendlies.has(t)||nn(Ft(t,r.color==="white"?-1:1),n.friendlies,n.enemies,n.lastMove))},ys=e=>[...e.enemies.keys()].some(t=>fi(t,e.dest.key,e)),Pn=(e,t)=>{const n=e.dest.pos;return[...e.enemies].some(([r,i])=>{const o=B(r);return!t?.includes(i.role)&&(i.role==="pawn"&&ai(...o,...n,i.color==="white")||i.role==="knight"&&Vn(...o,...n)||i.role==="bishop"&&Xn(...o,...n)||i.role==="rook"&&Qn(...o,...n)||i.role==="queen"&&li(...o,...n)||i.role==="king"&&ci(...o,...n))&&(!["bishop","rook","queen"].includes(i.role)||!di(o,n,e.allPieces))})},tn=e=>rt(e)&&(nn(e.dest.key,e.friendlies,e.enemies,e.lastMove)||Pn(e)),nn=(e,t,n,r)=>{if(!e||r&&e!==r[1])return!1;const i=B(e),o=t.get(e);return o?.role==="pawn"&&i[1]===(o.color==="white"?3:4)&&(!r||ve(B(r[0])[1],i[1])===2)&&[1,-1].some(s=>{const l=ye([i[0]+s,i[1]]);return!!l&&n.get(l)?.role==="pawn"})},vs=(e,t)=>{if(e.unrestrictedPremoves)return!0;const n=en(...e.orig.pos,...e.dest.pos);t&&n.push(e.dest.key);const r=n.filter(s=>e.friendlies.has(s));if(!r.length)return!0;const i=r[0],o=Ft(i,e.color==="white"?-1:1);return r.length===1&&nn(i,e.friendlies,e.enemies,e.lastMove)&&!!o&&!n.includes(o)},ks=(e,t)=>{if(e.unrestrictedPremoves)return!0;const n=en(...e.orig.pos,...e.dest.pos);t&&n.push(e.dest.key);const r=n.filter(d=>e.enemies.has(d));if(r.length>1)return!1;if(!r.length)return!0;const i=r[0],o=e.enemies.get(i);if(!o||o.role!=="pawn")return!0;const s=o.color==="white"?1:-1,l=Ft(i,s),c=l?[...ms(l).filter(d=>bs(i,d,e)),...[l,Ft(l,s)].filter(d=>!!d).filter(d=>fi(i,d,e))]:[],a=[...n,e.orig.key];return c.some(d=>!a.includes(d))},Yn=(e,t)=>vs(e,t)&&ks(e,t),_s=e=>{const t=e.color==="white"?1:-1;return ve(e.orig.pos[0],e.dest.pos[0])>1?!1:ve(e.orig.pos[0],e.dest.pos[0])?e.dest.pos[1]!==e.orig.pos[1]+t?!1:e.unrestrictedPremoves||ws(e)?!0:rt(e)?Pn(e):ys(e)||nn(ye([e.dest.pos[0],e.dest.pos[1]+t]),e.friendlies,e.enemies,e.lastMove)||Pn(e,["pawn"]):ui(...e.orig.pos,...e.dest.pos,e.color==="white")&&Yn(e,!0)},Cs=e=>Vn(...e.orig.pos,...e.dest.pos)&&(e.unrestrictedPremoves||!rt(e)||tn(e)),hi=e=>Xn(...e.orig.pos,...e.dest.pos)&&Yn(e,!1)&&(e.unrestrictedPremoves||!rt(e)||tn(e)),pi=e=>Qn(...e.orig.pos,...e.dest.pos)&&Yn(e,!1)&&(e.unrestrictedPremoves||!rt(e)||tn(e)),Ps=e=>hi(e)||pi(e),Es=e=>ci(...e.orig.pos,...e.dest.pos)&&(e.unrestrictedPremoves||!rt(e)||tn(e))||e.canCastle&&e.orig.pos[1]===e.dest.pos[1]&&e.orig.pos[1]===(e.color==="white"?0:7)&&(e.orig.pos[0]===4&&(e.dest.pos[0]===2&&e.rookFilesFriendlies.includes(0)||e.dest.pos[0]===6&&e.rookFilesFriendlies.includes(7))||e.rookFilesFriendlies.includes(e.dest.pos[0]))&&(e.unrestrictedPremoves||en(...e.orig.pos,e.dest.pos[0]>e.orig.pos[0]?7:1,e.dest.pos[1]).map(t=>e.allPieces.get(t)).every(t=>!t||Bt(t,{role:"rook",color:e.color}))),$s={pawn:_s,knight:Cs,bishop:hi,rook:pi,queen:Ps,king:Es};function gi(e,t){const n=e.pieces,r=e.premovable.castle,i=!!e.premovable.unrestrictedPremoves,o=n.get(t);if(!o||o.color===e.turnColor)return[];const s=o.color,l=new Map([...n].filter(([f,h])=>h.color===s)),c=new Map([...n].filter(([f,h])=>h.color===Jt(s))),a={key:t,pos:B(t)},d=f=>$s[o.role](f)&&e.premovable.additionalPremoveRequirements(f),u={orig:a,role:o.role,allPieces:n,friendlies:l,enemies:c,unrestrictedPremoves:i,color:s,canCastle:r,rookFilesFriendlies:Array.from(n).filter(([f,h])=>f[1]===(s==="white"?"1":"8")&&h.color===s&&h.role==="rook").map(([f])=>B(f)[0]),lastMove:e.lastMove};return fs.filter(f=>d({...u,dest:f})).map(f=>f.key)}function oe(e,...t){e&&setTimeout(()=>e(...t),1)}function Ss(e){e.orientation=Jt(e.orientation),e.animation.current=e.draggable.current=e.selected=void 0}function As(e,t){for(const[n,r]of t)r?e.pieces.set(n,r):e.pieces.delete(n)}function Ms(e,t){if(e.check=void 0,t===!0&&(t=e.turnColor),t)for(const[n,r]of e.pieces)r.role==="king"&&r.color===t&&(e.check=n)}function Rs(e,t,n,r){Le(e),e.premovable.current=[t,n],oe(e.premovable.events.set,t,n,r)}function Oe(e){e.premovable.current&&(e.premovable.current=void 0,oe(e.premovable.events.unset))}function Os(e,t,n){Oe(e),e.predroppable.current={role:t,key:n},oe(e.predroppable.events.set,t,n)}function Le(e){const t=e.predroppable;t.current&&(t.current=void 0,oe(t.events.unset))}function Ls(e,t,n){if(!e.autoCastle)return!1;const r=e.pieces.get(t);if(!r||r.role!=="king")return!1;const i=B(t),o=B(n);if(i[1]!==0&&i[1]!==7||i[1]!==o[1])return!1;i[0]===4&&!e.pieces.has(n)&&(o[0]===6?n=Te([7,o[1]]):o[0]===2&&(n=Te([0,o[1]])));const s=e.pieces.get(n);return!s||s.color!==r.color||s.role!=="rook"?!1:(e.pieces.delete(t),e.pieces.delete(n),i[0]<o[0]?(e.pieces.set(Te([6,o[1]]),r),e.pieces.set(Te([5,o[1]]),s)):(e.pieces.set(Te([2,o[1]]),r),e.pieces.set(Te([3,o[1]]),s)),!0)}function mi(e,t,n){const r=e.pieces.get(t),i=e.pieces.get(n);if(t===n||!r)return!1;const o=i&&i.color!==r.color?i:void 0;return n===e.selected&&ce(e),oe(e.events.move,t,n,o),Ls(e,t,n)||(e.pieces.set(n,r),e.pieces.delete(t)),e.lastMove=[t,n],e.check=void 0,oe(e.events.change),o||!0}function Zn(e,t,n,r){if(e.pieces.has(n))if(r)e.pieces.delete(n);else return!1;return oe(e.events.dropNewPiece,t,n),e.pieces.set(n,t),e.lastMove=[n],e.check=void 0,oe(e.events.change),e.movable.dests=void 0,e.turnColor=Jt(e.turnColor),!0}function wi(e,t,n){const r=mi(e,t,n);return r&&(e.movable.dests=void 0,e.turnColor=Jt(e.turnColor),e.animation.current=void 0),r}function bi(e,t,n){if(Jn(e,t,n)){const r=wi(e,t,n);if(r){const i=e.hold.stop();ce(e);const o={premove:!1,ctrlKey:e.stats.ctrlKey,holdTime:i};return r!==!0&&(o.captured=r),oe(e.movable.events.after,t,n,o),!0}}else if(Ns(e,t,n))return Rs(e,t,n,{ctrlKey:e.stats.ctrlKey}),ce(e),!0;return ce(e),!1}function yi(e,t,n,r){const i=e.pieces.get(t);i&&(xs(e,t,n)||r)?(e.pieces.delete(t),Zn(e,i,n,r),oe(e.movable.events.afterNewPiece,i.role,n,{premove:!1,predrop:!1})):i&&Ts(e,t,n)?Os(e,i.role,n):(Oe(e),Le(e)),e.pieces.delete(t),ce(e)}function En(e,t,n){if(oe(e.events.select,t),e.selected){if(e.selected===t&&!e.draggable.enabled){ce(e),e.hold.cancel();return}else if((e.selectable.enabled||n)&&e.selected!==t&&bi(e,e.selected,t)){e.stats.dragged=!1;return}}(e.selectable.enabled||e.draggable.enabled)&&(ki(e,t)||er(e,t))&&(vi(e,t),e.hold.start())}function vi(e,t){e.selected=t,er(e,t)?e.premovable.customDests||(e.premovable.dests=gi(e,t)):e.premovable.dests=void 0}function ce(e){e.selected=void 0,e.premovable.dests=void 0,e.hold.cancel()}function ki(e,t){const n=e.pieces.get(t);return!!n&&(e.movable.color==="both"||e.movable.color===n.color&&e.turnColor===n.color)}const Jn=(e,t,n)=>t!==n&&ki(e,t)&&(e.movable.free||!!e.movable.dests?.get(t)?.includes(n));function xs(e,t,n){const r=e.pieces.get(t);return!!r&&(t===n||!e.pieces.has(n))&&(e.movable.color==="both"||e.movable.color===r.color&&e.turnColor===r.color)}function er(e,t){const n=e.pieces.get(t);return!!n&&e.premovable.enabled&&e.movable.color===n.color&&e.turnColor!==n.color}const Ns=(e,t,n)=>t!==n&&er(e,t)&&(e.premovable.customDests?.get(t)??gi(e,t)).includes(n);function Ts(e,t,n){const r=e.pieces.get(t),i=e.pieces.get(n);return!!r&&(!i||i.color!==e.movable.color)&&e.predroppable.enabled&&(r.role!=="pawn"||n[1]!=="1"&&n[1]!=="8")&&e.movable.color===r.color&&e.turnColor!==r.color}function Ds(e,t){const n=e.pieces.get(t);return!!n&&e.draggable.enabled&&(e.movable.color==="both"||e.movable.color===n.color&&(e.turnColor===n.color||e.premovable.enabled))}function Is(e){const t=e.premovable.current;if(!t)return!1;const n=t[0],r=t[1];let i=!1;if(Jn(e,n,r)){const o=wi(e,n,r);if(o){const s={premove:!0};o!==!0&&(s.captured=o),oe(e.movable.events.after,n,r,s),i=!0}}return Oe(e),i}function Bs(e,t){const n=e.predroppable.current;let r=!1;if(!n)return!1;if(t(n)){const i={role:n.role,color:e.movable.color};Zn(e,i,n.key)&&(oe(e.movable.events.afterNewPiece,n.role,n.key,{premove:!1,predrop:!0}),r=!0)}return Le(e),r}function tr(e){Oe(e),Le(e),ce(e)}function vr(e){e.movable.color=e.movable.dests=e.animation.current=void 0,tr(e)}function Ge(e,t,n){let r=Math.floor(8*(e[0]-n.left)/n.width);t||(r=7-r);let i=7-Math.floor(8*(e[1]-n.top)/n.height);return t||(i=7-i),r>=0&&r<8&&i>=0&&i<8?ye([r,i]):void 0}function Fs(e,t,n,r){const i=B(e),o=ni.filter(a=>ps(i,a)||li(i[0],i[1],a[0],a[1])||Vn(i[0],i[1],a[0],a[1])),l=o.map(a=>si(Te(a),n,r)).map(a=>gt(t,a)),[,c]=l.reduce((a,d,u)=>a[0]<d?a:[d,u],[l[0],0]);return ye(o[c])}const se=e=>e.orientation==="white",_i="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",qs={p:"pawn",r:"rook",n:"knight",b:"bishop",q:"queen",k:"king"},Ks={pawn:"p",rook:"r",knight:"n",bishop:"b",queen:"q",king:"k"};function Ci(e){e==="start"&&(e=_i);const t=new Map;let n=7,r=0;for(const i of e)switch(i){case" ":case"[":return t;case"/":if(--n,n<0)return t;r=0;break;case"~":{const o=ye([r-1,n]),s=o&&t.get(o);s&&(s.promoted=!0);break}default:{const o=i.charCodeAt(0);if(o<57)r+=o-48;else{const s=i.toLowerCase(),l=ye([r,n]);l&&t.set(l,{role:qs[s],color:i===s?"black":"white"}),++r}}}return t}function js(e){return ds.map(t=>Dt.map(n=>{const r=e.get(n+t);if(r){let i=Ks[r.role];return r.color==="white"&&(i=i.toUpperCase()),r.promoted&&(i+="~"),i}else return"1"}).join("")).join("/").replace(/1{2,}/g,t=>t.length.toString())}function Pi(e,t){t.animation&&(nr(e.animation,t.animation),(e.animation.duration||0)<70&&(e.animation.enabled=!1))}function Ei(e,t){if(t.movable?.dests&&(e.movable.dests=void 0),t.drawable?.autoShapes&&(e.drawable.autoShapes=[]),nr(e,t),t.fen&&(e.pieces=Ci(t.fen),e.drawable.shapes=t.drawable?.shapes||[]),"check"in t&&Ms(e,t.check||!1),"lastMove"in t&&!t.lastMove?e.lastMove=void 0:t.lastMove&&(e.lastMove=t.lastMove),e.selected&&vi(e,e.selected),Pi(e,t),!e.movable.rookCastle&&e.movable.dests){const n=e.movable.color==="white"?"1":"8",r="e"+n,i=e.movable.dests.get(r),o=e.pieces.get(r);if(!i||!o||o.role!=="king")return;e.movable.dests.set(r,i.filter(s=>!(s==="a"+n&&i.includes("c"+n))&&!(s==="h"+n&&i.includes("g"+n))))}}function nr(e,t){for(const n in t)n==="__proto__"||n==="constructor"||!Object.prototype.hasOwnProperty.call(t,n)||(Object.prototype.hasOwnProperty.call(e,n)&&kr(e[n])&&kr(t[n])?nr(e[n],t[n]):e[n]=t[n])}function kr(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return t===Object.prototype||t===null}const De=(e,t)=>t.animation.enabled?Us(e,t):$e(e,t);function $e(e,t){const n=e(t);return t.dom.redraw(),n}const gn=(e,t)=>({key:e,pos:B(e),piece:t}),zs=(e,t)=>t.sort((n,r)=>gt(e.pos,n.pos)-gt(e.pos,r.pos))[0];function Hs(e,t){const n=new Map,r=[],i=new Map,o=[],s=[],l=new Map;let c,a,d;for(const[u,f]of e)l.set(u,gn(u,f));for(const u of Zt)c=t.pieces.get(u),a=l.get(u),c?a?Bt(c,a.piece)||(o.push(a),s.push(gn(u,c))):s.push(gn(u,c)):a&&o.push(a);for(const u of s)a=zs(u,o.filter(f=>Bt(u.piece,f.piece))),a&&(d=[a.pos[0]-u.pos[0],a.pos[1]-u.pos[1]],n.set(u.key,d.concat(d)),r.push(a.key));for(const u of o)r.includes(u.key)||i.set(u.key,u.piece);return{anims:n,fadings:i}}function $i(e,t){const n=e.animation.current;if(n===void 0){e.dom.destroyed||e.dom.redrawNow();return}const r=1-(t-n.start)*n.frequency;if(r<=0)e.animation.current=void 0,e.dom.redrawNow();else{const i=Ws(r);for(const o of n.plan.anims.values())o[2]=o[0]*i,o[3]=o[1]*i;e.dom.redrawNow(!0),requestAnimationFrame((o=performance.now())=>$i(e,o))}}function Us(e,t){const n=new Map(t.pieces),r=e(t),i=Hs(n,t);if(i.anims.size||i.fadings.size){const o=t.animation.current&&t.animation.current.start;t.animation.current={start:performance.now(),frequency:1/t.animation.duration,plan:i},o||$i(t,performance.now())}else t.dom.redraw();return r}const Ws=e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1,Gs=["green","red","blue","yellow"];function Vs(e,t){if(t.touches&&t.touches.length>1)return;t.stopPropagation(),t.preventDefault(),t.ctrlKey?ce(e):tr(e);const n=We(t),r=Ge(n,se(e),e.dom.bounds());r&&(e.drawable.current={orig:r,pos:n,brush:Zs(t),snapToValidMove:e.drawable.defaultSnapToValidMove},Si(e))}function Si(e){requestAnimationFrame(()=>{const t=e.drawable.current;if(t){const n=Ge(t.pos,se(e),e.dom.bounds());n||(t.snapToValidMove=!1);const r=t.snapToValidMove?Fs(t.orig,t.pos,se(e),e.dom.bounds()):n;r!==t.mouseSq&&(t.mouseSq=r,t.dest=r!==t.orig?r:void 0,e.dom.redrawNow()),Si(e)}})}function Qs(e,t){e.drawable.current&&(e.drawable.current.pos=We(t))}function Xs(e){const t=e.drawable.current;t&&(t.mouseSq&&Js(e.drawable,t),Ai(e))}function Ai(e){e.drawable.current&&(e.drawable.current=void 0,e.dom.redraw())}function Ys(e){e.drawable.shapes.length&&(e.drawable.shapes=[],e.dom.redraw(),Ri(e.drawable))}const $n=(e,t)=>e.orig===t.orig&&e.dest===t.dest,Mi=(e,t)=>e.brush===t.brush;function Zs(e){const t=(e.shiftKey||e.ctrlKey)&&oi(e),n=e.altKey||e.metaKey||e.getModifierState?.("AltGraph");return Gs[(t?1:0)+(n?2:0)]}function Js(e,t){const n=e.shapes.find(r=>$n(r,t));n&&(e.shapes=e.shapes.filter(r=>!$n(r,t))),(!n||!Mi(n,t))&&e.shapes.push({orig:t.orig,dest:t.dest,brush:t.brush}),Ri(e)}function Ri(e){e.onChange&&e.onChange(e.shapes)}function el(e,t){if(!(e.trustAllEvents||t.isTrusted)||t.buttons!==void 0&&t.buttons>1||t.touches&&t.touches.length>1)return;const n=e.dom.bounds(),r=We(t),i=Ge(r,se(e),n);if(!i)return;const o=e.pieces.get(i),s=e.selected;if(!s&&e.drawable.enabled&&(e.drawable.eraseOnMovablePieceClick||!o||o.color!==e.turnColor)&&Ys(e),t.cancelable!==!1&&(!t.touches||e.blockTouchScroll||o||s||tl(e,r)))t.preventDefault();else if(t.touches)return;const l=!!e.premovable.current,c=!!e.predroppable.current;e.stats.ctrlKey=t.ctrlKey,e.selected&&Jn(e,e.selected,i)?De(u=>En(u,i),e):En(e,i);const a=e.selected===i,d=Li(e,i);if(o&&d&&a&&Ds(e,i)){e.draggable.current={orig:i,piece:o,origPos:r,pos:r,started:e.draggable.autoDistance&&e.stats.dragged,element:d,previouslySelected:s,originTarget:t.target,keyHasChanged:!1},d.cgDragging=!0,d.classList.add("dragging");const u=e.dom.elements.ghost;u&&(u.className=`ghost ${o.color} ${o.role}`,de(u,Pt(n)(B(i),se(e))),Gn(u,!0)),rr(e)}else l&&Oe(e),c&&Le(e);e.dom.redraw()}function tl(e,t){const n=se(e),r=e.dom.bounds(),i=Math.pow(e.touchIgnoreRadius*r.width/16,2)*2;for(const o of e.pieces.keys()){const s=si(o,n,r);if(gt(s,t)<=i)return!0}return!1}function nl(e,t,n,r){e.pieces.set("a0",t),e.dom.redraw();const o=We(n);e.draggable.current={orig:"a0",piece:t,origPos:o,pos:o,started:!0,element:()=>Li(e,"a0"),originTarget:n.target,newPiece:!0,force:!!r,keyHasChanged:!1},rr(e)}function rr(e){requestAnimationFrame(()=>{const t=e.draggable.current;if(!t)return;e.animation.current?.plan.anims.has(t.orig)&&(e.animation.current=void 0);const n=e.pieces.get(t.orig);if(!n||!Bt(n,t.piece))qt(e);else if(!t.started&&gt(t.pos,t.origPos)>=Math.pow(e.draggable.distance,2)&&(t.started=!0),t.started){if(typeof t.element=="function"){const i=t.element();if(!i)return;i.cgDragging=!0,i.classList.add("dragging"),t.element=i}const r=e.dom.bounds();de(t.element,[t.pos[0]-r.left-r.width/16,t.pos[1]-r.top-r.height/16]),t.keyHasChanged||(t.keyHasChanged=t.orig!==Ge(t.pos,se(e),r))}rr(e)})}function rl(e,t){e.draggable.current&&(!t.touches||t.touches.length<2)&&(e.draggable.current.pos=We(t))}function il(e,t){const n=e.draggable.current;if(!n)return;if(t.type==="touchend"&&t.cancelable!==!1&&t.preventDefault(),t.type==="touchend"&&n.originTarget!==t.target&&!n.newPiece){e.draggable.current=void 0;return}Oe(e),Le(e);const r=We(t)||n.pos,i=Ge(r,se(e),e.dom.bounds());i&&n.started&&n.orig!==i?n.newPiece?yi(e,n.orig,i,n.force):(e.stats.ctrlKey=t.ctrlKey,bi(e,n.orig,i)&&(e.stats.dragged=!0)):n.newPiece?e.pieces.delete(n.orig):e.draggable.deleteOnDropOff&&!i&&(e.pieces.delete(n.orig),oe(e.events.change)),(n.orig===n.previouslySelected||n.keyHasChanged)&&(n.orig===i||!i)?ce(e):e.selectable.enabled||ce(e),Oi(e),e.draggable.current=void 0,e.dom.redraw()}function qt(e){const t=e.draggable.current;t&&(t.newPiece&&e.pieces.delete(t.orig),e.draggable.current=void 0,ce(e),Oi(e),e.dom.redraw())}function Oi(e){const t=e.dom.elements;t.ghost&&Gn(t.ghost,!1)}function Li(e,t){let n=e.dom.elements.board.firstChild;for(;n;){if(n.cgKey===t&&n.tagName==="PIECE")return n;n=n.nextSibling}}function ol(e,t){e.exploding={stage:1,keys:t},e.dom.redraw(),setTimeout(()=>{_r(e,2),setTimeout(()=>_r(e,void 0),120)},120)}function _r(e,t){e.exploding&&(t?e.exploding.stage=t:e.exploding=void 0,e.dom.redraw())}function sl(e,t){function n(){Ss(e),t()}return{set(r){r.orientation&&r.orientation!==e.orientation&&n(),Pi(e,r),(r.fen?De:$e)(i=>Ei(i,r),e)},state:e,getFen:()=>js(e.pieces),toggleOrientation:n,setPieces(r){De(i=>As(i,r),e)},selectSquare(r,i){r?De(o=>En(o,r,i),e):e.selected&&(ce(e),e.dom.redraw())},move(r,i){De(o=>mi(o,r,i),e)},newPiece(r,i){De(o=>Zn(o,r,i),e)},playPremove(){if(e.premovable.current){if(De(Is,e))return!0;e.dom.redraw()}return!1},playPredrop(r){if(e.predroppable.current){const i=Bs(e,r);return e.dom.redraw(),i}return!1},cancelPremove(){$e(Oe,e)},cancelPredrop(){$e(Le,e)},cancelMove(){$e(r=>{tr(r),qt(r)},e)},stop(){$e(r=>{vr(r),qt(r)},e)},explode(r){ol(e,r)},setAutoShapes(r){$e(i=>i.drawable.autoShapes=r,e)},setShapes(r){$e(i=>i.drawable.shapes=r.slice(),e)},getKeyAtDomPos(r){return Ge(r,se(e),e.dom.bounds())},redrawAll:t,dragNewPiece(r,i,o){nl(e,r,i,o)},destroy(){vr(e),e.dom.unbind&&e.dom.unbind(),e.dom.destroyed=!0}}}function ll(){return{pieces:Ci(_i),orientation:"white",turnColor:"white",coordinates:!0,coordinatesOnSquares:!1,ranksPosition:"right",autoCastle:!0,viewOnly:!1,disableContextMenu:!1,addPieceZIndex:!1,blockTouchScroll:!1,touchIgnoreRadius:1,pieceKey:!1,trustAllEvents:!1,highlight:{lastMove:!0,check:!0},animation:{enabled:!0,duration:200},movable:{free:!0,color:"both",showDests:!0,events:{},rookCastle:!0},premovable:{enabled:!0,showDests:!0,castle:!0,additionalPremoveRequirements:e=>!0,events:{}},predroppable:{enabled:!1,events:{}},draggable:{enabled:!0,distance:3,autoDistance:!0,showGhost:!0,deleteOnDropOff:!1},dropmode:{active:!1},selectable:{enabled:!0},stats:{dragged:!("ontouchstart"in window)},events:{},drawable:{enabled:!0,visible:!0,defaultSnapToValidMove:!0,eraseOnMovablePieceClick:!0,shapes:[],autoShapes:[],brushes:{green:{key:"g",color:"#15781B",opacity:1,lineWidth:10},red:{key:"r",color:"#882020",opacity:1,lineWidth:10},blue:{key:"b",color:"#003088",opacity:1,lineWidth:10},yellow:{key:"y",color:"#e68f00",opacity:1,lineWidth:10},paleBlue:{key:"pb",color:"#003088",opacity:.4,lineWidth:15},paleGreen:{key:"pg",color:"#15781B",opacity:.4,lineWidth:15},paleRed:{key:"pr",color:"#882020",opacity:.4,lineWidth:15},paleGrey:{key:"pgr",color:"#4a4a4a",opacity:.35,lineWidth:15},purple:{key:"purple",color:"#68217a",opacity:.65,lineWidth:10},pink:{key:"pink",color:"#ee2080",opacity:.5,lineWidth:10},white:{key:"white",color:"white",opacity:1,lineWidth:10},paleWhite:{key:"pwhite",color:"white",opacity:.6,lineWidth:10}},prevSvgHash:""},hold:hs()}}function cl(){const e=Z("defs"),t=re(Z("filter"),{id:"cg-filter-blur"});return t.appendChild(re(Z("feGaussianBlur"),{stdDeviation:"0.013"})),e.appendChild(t),e}function al(e,t){const n=e.drawable,r=n.current,i=r&&r.mouseSq?r:void 0,o=new Map,s=e.dom.bounds(),l=n.autoShapes.filter(u=>!u.piece);for(const u of n.shapes.concat(l).concat(i?[i]:[])){if(!u.dest)continue;const f=o.get(u.dest)??new Set,h=jt(Kt(B(u.orig),e.orientation),s),w=jt(Kt(B(u.dest),e.orientation),s);f.add(An(h,w)),o.set(u.dest,f)}const c=[],a=i?n.shapes.findIndex(u=>$n(u,i)&&Mi(u,i)):-1;for(const[u,f]of n.shapes.concat(l).entries()){const h=a!==-1&&a===u;c.push({shape:f,current:!1,pendingErase:h,hash:Cr(f,Sn(f.dest,o),!1,s,h)})}i&&a===-1&&c.push({shape:i,current:!0,hash:Cr(i,Sn(i.dest,o),!0,s,!1),pendingErase:!1});const d=c.map(u=>u.hash).join(";");d!==e.drawable.prevSvgHash&&(e.drawable.prevSvgHash=d,ul(n,c,t),dl(c,t,u=>pl(e,u,n.brushes,o,s)))}function ul(e,t,n){for(const r of[n.shapes,n.shapesBelow]){const i=r.querySelector("defs"),o=t.filter(a=>r===n.shapesBelow==!!a.shape.below),s=new Map;for(const a of o.filter(d=>d.shape.dest&&d.shape.brush)){const d=xi(e.brushes[a.shape.brush],a.shape.modifiers),{key:u,color:f}=Ni(a.shape);u&&f&&s.set(u,{key:u,color:f,opacity:1,lineWidth:1}),s.set(d.key,d)}const l=new Set;let c=i.firstElementChild;for(;c;)l.add(c.getAttribute("cgKey")),c=c.nextElementSibling;for(const[a,d]of s.entries())l.has(a)||i.appendChild(wl(d))}}function dl(e,t,n){for(const[r,i]of[[t.shapes,t.custom],[t.shapesBelow,t.customBelow]]){const[o,s]=[r,i].map(a=>a.querySelector("g")),l=e.filter(a=>r===t.shapesBelow==!!a.shape.below),c=new Map;for(const a of l)c.set(a.hash,!1);for(const a of[o,s]){const d=[];let u=a.firstElementChild,f;for(;u;)f=u.getAttribute("cgHash"),c.has(f)?c.set(f,!0):d.push(u),u=u.nextElementSibling;for(const h of d)a.removeChild(h)}for(const a of l.filter(d=>!c.get(d.hash)))for(const d of n(a))d.isCustom?s.appendChild(d.el):o.appendChild(d.el)}}function Cr({orig:e,dest:t,brush:n,piece:r,modifiers:i,customSvg:o,label:s,below:l},c,a,d,u){return[d.width,d.height,a,u&&"pendingErase",e,t,n,c&&"-",r&&fl(r),i&&hl(i),o&&`custom-${Pr(o.html)},${o.center?.[0]??"o"}`,s&&`label-${Pr(s.text)}`,l&&"below"].filter(f=>f).join(",")}function fl(e){return[e.color,e.role,e.scale].filter(t=>t).join(",")}function hl(e){return[e.lineWidth,e.hilite].filter(t=>t).join(",")}function Pr(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n)>>>0;return t.toString()}function pl(e,{shape:t,current:n,pendingErase:r,hash:i},o,s,l){const c=jt(Kt(B(t.orig),e.orientation),l),a=t.dest?jt(Kt(B(t.dest),e.orientation),l):c,d=t.brush&&xi(o[t.brush],t.modifiers),u=s.get(t.dest),f=[];if(d){const h=re(Z("g"),{cgHash:i});f.push({el:h}),c[0]!==a[0]||c[1]!==a[1]?h.appendChild(ml(t,d,c,a,n,Sn(t.dest,s),r)):h.appendChild(gl(o[t.brush],c,n,l,r))}if(t.label){const h=t.label;h.fill??(h.fill=t.brush&&o[t.brush].color);const w=t.brush?void 0:"tr";f.push({el:bl(h,i,c,a,u,w),isCustom:!0})}if(t.customSvg){const h=t.customSvg.center??"orig",[w,g]=h==="label"?Di(c,a,u).map(_=>_-.5):h==="dest"?a:c,y=re(Z("g"),{transform:`translate(${w},${g})`,cgHash:i});y.innerHTML=`<svg width="1" height="1" viewBox="0 0 100 100">${t.customSvg.html}</svg>`,f.push({el:y,isCustom:!0})}return f}function gl(e,t,n,r,i){const o=yl(),s=(r.width+r.height)/(4*Math.max(r.width,r.height));return re(Z("circle"),{stroke:e.color,"stroke-width":o[n?0:1],fill:"none",opacity:Ti(e,n,i),cx:t[0],cy:t[1],r:s-o[1]/2})}function ml(e,t,n,r,i,o,s){function l(d){const u=kl(o&&!i),f=r[0]-n[0],h=r[1]-n[1],w=Math.atan2(h,f),g=Math.cos(w)*u,y=Math.sin(w)*u,_=Ni(e);return re(Z("line"),{stroke:d?_.color:t.color,"stroke-width":vl(t,i)*(d?1.14:1),"stroke-linecap":"round","marker-end":`url(#arrowhead-${d?_.key:t.key})`,opacity:e.modifiers?.hilite&&!s?1:Ti(t,i,s),x1:n[0],y1:n[1],x2:r[0]-g,y2:r[1]-y})}if(!e.modifiers?.hilite)return l(!1);const c=re(Z("g"),{opacity:t.opacity}),a=re(Z("g"),{filter:"url(#cg-filter-blur)"});return a.appendChild(_l(n,r)),a.appendChild(l(!0)),c.appendChild(a),c.appendChild(l(!1)),c}function wl(e){const t=re(Z("marker"),{id:"arrowhead-"+e.key,orient:"auto",overflow:"visible",markerWidth:4,markerHeight:4,refX:e.key.startsWith("hilite")?1.86:2.05,refY:2});return t.appendChild(re(Z("path"),{d:"M0,0 V4 L3,2 Z",fill:e.color})),t.setAttribute("cgKey",e.key),t}function bl(e,t,n,r,i,o){const l=.4*.75**e.text.length,c=Di(n,r,i),a=o==="tr"?.4:0,d=re(Z("g"),{transform:`translate(${c[0]+a},${c[1]-a})`,cgHash:t});d.appendChild(re(Z("circle"),{r:.4/2,"fill-opacity":o?1:.8,"stroke-opacity":o?1:.7,"stroke-width":.03,fill:e.fill??"#666",stroke:"white"}));const u=re(Z("text"),{"font-size":l,"font-family":"Noto Sans","text-anchor":"middle",fill:"white",y:.13*.75**e.text.length});return u.innerHTML=e.text,d.appendChild(u),d}function Kt(e,t){return t==="white"?e:[7-e[0],7-e[1]]}function Sn(e,t){return(e&&t.has(e)&&t.get(e).size>1)===!0}function Z(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function re(e,t){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.setAttribute(n,t[n]);return e}function xi(e,t){return t?{color:e.color,opacity:Math.round(e.opacity*10)/10,lineWidth:Math.round(t.lineWidth||e.lineWidth),key:[e.key,t.lineWidth].filter(n=>n).join("")}:e}function yl(){return[3/64,4/64]}function vl(e,t){return(e.lineWidth||10)*(t?.85:1)/64}function Ni(e){const t=e.modifiers?.hilite;return{key:t&&`hilite-${t.replace("#","")}`,color:t}}function Ti(e,t,n){return(e.opacity||1)*(n?.6:t?.9:1)}function kl(e){return(e?20:10)/64}function jt(e,t){const n=Math.min(1,t.width/t.height),r=Math.min(1,t.height/t.width);return[(e[0]-3.5)*n,(3.5-e[1])*r]}function _l(e,t){const n={from:[Math.floor(Math.min(e[0],t[0])),Math.floor(Math.min(e[1],t[1]))],to:[Math.ceil(Math.max(e[0],t[0])),Math.ceil(Math.max(e[1],t[1]))]};return re(Z("rect"),{x:n.from[0],y:n.from[1],width:n.to[0]-n.from[0],height:n.to[1]-n.from[1],fill:"none",stroke:"none"})}function An(e,t,n=!0){const r=Math.atan2(t[1]-e[1],t[0]-e[0])+Math.PI;return n?(Math.round(r*8/Math.PI)+16)%16:r}function Cl(e,t){return Math.sqrt([e[0]-t[0],e[1]-t[1]].reduce((n,r)=>n+r*r,0))}function Di(e,t,n){let r=Cl(e,t);const i=An(e,t,!1);if(n&&(r-=33/64,n.size>1)){r-=10/64;const o=An(e,t);(n.has((o+1)%16)||n.has((o+15)%16))&&o&1&&(r-=.4)}return[e[0]-Math.cos(i)*r,e[1]-Math.sin(i)*r].map(o=>o+.5)}function Pl(e,t){e.innerHTML="",e.classList.add("cg-wrap");for(const d of us)e.classList.toggle("orientation-"+d,t.orientation===d);e.classList.toggle("manipulable",!t.viewOnly);const n=_e("cg-container");e.appendChild(n);const r=_e("cg-board");n.appendChild(r);let i,o,s,l,c;if(t.drawable.visible&&([i,o]=["cg-shapes-below","cg-shapes"].map(d=>Er(d,!0)),[s,l]=["cg-custom-below","cg-custom-svgs"].map(d=>Er(d,!1)),c=_e("cg-auto-pieces"),n.appendChild(i),n.appendChild(s),n.appendChild(o),n.appendChild(l),n.appendChild(c)),t.coordinates){const d=t.orientation==="black"?" black":"",u=t.ranksPosition==="left"?" left":"";if(t.coordinatesOnSquares){const f=t.orientation==="white"?h=>h+1:h=>8-h;Dt.forEach((h,w)=>n.appendChild(mn(It.map(g=>h+g),"squares rank"+f(w)+d+u)))}else n.appendChild(mn(It,"ranks"+d+u)),n.appendChild(mn(Dt,"files"+d))}let a;return t.draggable.enabled&&t.draggable.showGhost&&(a=_e("piece","ghost"),Gn(a,!1),n.appendChild(a)),{board:r,container:n,wrap:e,ghost:a,shapes:o,shapesBelow:i,custom:l,customBelow:s,autoPieces:c}}function Er(e,t){const n=re(Z("svg"),{class:e,viewBox:t?"-4 -4 8 8":"-3.5 -3.5 8 8",preserveAspectRatio:"xMidYMid slice"});return t&&n.appendChild(cl()),n.appendChild(Z("g")),n}function mn(e,t){const n=_e("coords",t);let r;for(const i of e)r=_e("coord"),r.textContent=i,n.appendChild(r);return n}function El(e,t){if(!e.dropmode.active)return;Oe(e),Le(e);const n=e.dropmode.piece;if(n){e.pieces.set("a0",n);const r=We(t),i=r&&Ge(r,se(e),e.dom.bounds());i&&yi(e,"a0",i)}e.dom.redraw()}function $l(e,t){const n=e.dom.elements.board;if("ResizeObserver"in window&&new ResizeObserver(t).observe(e.dom.elements.wrap),(e.disableContextMenu||e.drawable.enabled)&&n.addEventListener("contextmenu",i=>i.preventDefault()),e.viewOnly)return;const r=Al(e);n.addEventListener("touchstart",r,{passive:!1}),n.addEventListener("mousedown",r,{passive:!1})}function Sl(e,t){const n=[];if("ResizeObserver"in window||n.push(st(document.body,"chessground.resize",t)),!e.viewOnly){const r=$r(e,rl,Qs),i=$r(e,il,Xs);for(const s of["touchmove","mousemove"])n.push(st(document,s,r));for(const s of["touchend","mouseup"])n.push(st(document,s,i));const o=()=>e.dom.bounds.clear();n.push(st(document,"scroll",o,{capture:!0,passive:!0})),n.push(st(window,"resize",o,{passive:!0}))}return()=>n.forEach(r=>r())}function st(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}const Al=e=>t=>{e.draggable.current?qt(e):e.drawable.current?Ai(e):t.shiftKey||oi(t)?e.drawable.enabled&&Vs(e,t):e.viewOnly||(e.dropmode.active?El(e,t):el(e,t))},$r=(e,t,n)=>r=>{e.drawable.current?e.drawable.enabled&&n(e,r):e.viewOnly||t(e,r)};function Ml(e){const t=se(e),n=Pt(e.dom.bounds()),r=e.dom.elements.board,i=e.pieces,o=e.animation.current,s=o?o.plan.anims:new Map,l=o?o.plan.fadings:new Map,c=e.draggable.current,a=Ol(e),d=new Set,u=new Set,f=new Map,h=new Map;let w,g,y,_,v,D,A,P,U,K;for(g=r.firstChild;g;){if(w=g.cgKey,Ii(g))if(y=i.get(w),v=s.get(w),D=l.get(w),_=g.cgPiece,g.cgDragging&&(!c||c.orig!==w)&&(g.classList.remove("dragging"),de(g,n(B(w),t)),g.cgDragging=!1),!D&&g.cgFading&&(g.cgFading=!1,g.classList.remove("fading")),y){if(v&&g.cgAnimating&&_===lt(y)){const O=B(w);O[0]+=v[2],O[1]+=v[3],g.classList.add("anim"),de(g,n(O,t))}else g.cgAnimating&&(g.cgAnimating=!1,g.classList.remove("anim"),de(g,n(B(w),t)),e.addPieceZIndex&&(g.style.zIndex=wn(B(w),t)));_===lt(y)&&(!D||!g.cgFading)?d.add(w):D&&_===lt(D)?(g.classList.add("fading"),g.cgFading=!0):bn(f,_,g)}else bn(f,_,g);else if(Bi(g)){const O=g.className;a.get(w)===O?u.add(w):bn(h,O,g)}g=g.nextSibling}for(const[O,ee]of a)if(!u.has(O)){U=h.get(ee),K=U&&U.pop();const T=n(B(O),t);if(K)K.cgKey=O,de(K,T);else{const b=_e("square",ee);b.cgKey=O,de(b,T),r.insertBefore(b,r.firstChild)}}for(const[O,ee]of i)if(v=s.get(O),!d.has(O))if(A=f.get(lt(ee)),P=A&&A.pop(),P){P.cgKey=O,P.cgFading&&(P.classList.remove("fading"),P.cgFading=!1);const T=B(O);e.addPieceZIndex&&(P.style.zIndex=wn(T,t)),v&&(P.cgAnimating=!0,P.classList.add("anim"),T[0]+=v[2],T[1]+=v[3]),de(P,n(T,t))}else{const T=lt(ee),b=_e("piece",T),E=B(O);b.cgPiece=T,b.cgKey=O,v&&(b.cgAnimating=!0,E[0]+=v[2],E[1]+=v[3]),de(b,n(E,t)),e.addPieceZIndex&&(b.style.zIndex=wn(E,t)),r.appendChild(b)}for(const O of f.values())Ar(e,O);for(const O of h.values())Ar(e,O)}function Rl(e){const t=se(e),n=Pt(e.dom.bounds());let r=e.dom.elements.board.firstChild;for(;r;)(Ii(r)&&!r.cgAnimating||Bi(r))&&de(r,n(B(r.cgKey),t)),r=r.nextSibling}function Sr(e){const t=e.dom.elements.wrap.getBoundingClientRect(),n=e.dom.elements.container,r=t.height/t.width,i=Math.floor(t.width*window.devicePixelRatio/8)*8/window.devicePixelRatio,o=i*r;n.style.width=i+"px",n.style.height=o+"px",e.dom.bounds.clear(),e.addDimensionsCssVarsTo?.style.setProperty("---cg-width",i+"px"),e.addDimensionsCssVarsTo?.style.setProperty("---cg-height",o+"px")}const Ii=e=>e.tagName==="PIECE",Bi=e=>e.tagName==="SQUARE";function Ar(e,t){for(const n of t)e.dom.elements.board.removeChild(n)}function wn(e,t){const r=e[1];return`${t?10-r:3+r}`}const lt=e=>`${e.color} ${e.role}`;function Ol(e){const t=new Map;if(e.lastMove&&e.highlight.lastMove)for(const i of e.lastMove)ke(t,i,"last-move");if(e.check&&e.highlight.check&&ke(t,e.check,"check"),e.selected&&(ke(t,e.selected,"selected"),e.movable.showDests)){const i=e.movable.dests?.get(e.selected);if(i)for(const s of i)ke(t,s,"move-dest"+(e.pieces.has(s)?" oc":""));const o=e.premovable.customDests?.get(e.selected)??e.premovable.dests;if(o)for(const s of o)ke(t,s,"premove-dest"+(e.pieces.has(s)?" oc":""))}const n=e.premovable.current;if(n)for(const i of n)ke(t,i,"current-premove");else e.predroppable.current&&ke(t,e.predroppable.current.key,"current-premove");const r=e.exploding;if(r)for(const i of r.keys)ke(t,i,"exploding"+r.stage);return e.highlight.custom&&e.highlight.custom.forEach((i,o)=>{ke(t,o,i)}),t}function ke(e,t,n){const r=e.get(t);r?e.set(t,`${r} ${n}`):e.set(t,n)}function bn(e,t,n){const r=e.get(t);r?r.push(n):e.set(t,[n])}function Ll(e,t,n){const r=new Map,i=[];for(const l of e)r.set(l.hash,!1);let o=t.firstElementChild,s;for(;o;)s=o.getAttribute("cgHash"),r.has(s)?r.set(s,!0):i.push(o),o=o.nextElementSibling;for(const l of i)t.removeChild(l);for(const l of e)r.get(l.hash)||t.appendChild(n(l))}function xl(e,t){const r=e.drawable.autoShapes.filter(i=>i.piece).map(i=>({shape:i,hash:Dl(i),current:!1,pendingErase:!1}));Ll(r,t,i=>Tl(e,i,e.dom.bounds()))}function Nl(e){const t=se(e),n=Pt(e.dom.bounds());let r=e.dom.elements.autoPieces?.firstChild;for(;r;)ii(r,n(B(r.cgKey),t),r.cgScale),r=r.nextSibling}function Tl(e,{shape:t,hash:n},r){const i=t.orig,o=t.piece?.role,s=t.piece?.color,l=t.piece?.scale,c=_e("piece",`${o} ${s}`);return c.setAttribute("cgHash",n),c.cgKey=i,c.cgScale=l,ii(c,Pt(r)(B(i),se(e)),l),c}const Dl=e=>[e.orig,e.piece?.role,e.piece?.color,e.piece?.scale].join(",");function Il(e,t){const n=ll();Ei(n,t||{});function r(){const i="dom"in n?n.dom.unbind:void 0,o=Pl(e,n),s=ri(()=>o.board.getBoundingClientRect()),l=d=>{Ml(a),o.autoPieces&&xl(a,o.autoPieces),!d&&o.shapes&&al(a,o)},c=()=>{Sr(a),Rl(a),o.autoPieces&&Nl(a)},a=n;return a.dom={elements:o,bounds:s,redraw:Bl(l),redrawNow:l,unbind:i},a.drawable.prevSvgHash="",Sr(a),l(!1),$l(a,c),i||(a.dom.unbind=Sl(a,c)),a.events.insert&&a.events.insert(o),a}return sl(r(),r)}function Bl(e){let t=!1;return()=>{t||(t=!0,requestAnimationFrame(()=>{e(),t=!1}))}}const zt=["a","b","c","d","e","f","g","h"],Fi=["1","2","3","4","5","6","7","8"],je=["white","black"],ae=["pawn","knight","bishop","rook","queen","king"],Fl=["a","h"],Ht=e=>"role"in e,M=e=>e!==void 0,V=e=>e==="white"?"black":"white",ze=e=>e>>3,le=e=>e&7,Mn=(e,t)=>0<=e&&e<8&&0<=t&&t<8?e+8*t:void 0,ut=e=>{switch(e){case"pawn":return"p";case"knight":return"n";case"bishop":return"b";case"rook":return"r";case"queen":return"q";case"king":return"k"}};function Rn(e){switch(e.toLowerCase()){case"p":return"pawn";case"n":return"knight";case"b":return"bishop";case"r":return"rook";case"q":return"queen";case"k":return"king";default:return}}function dt(e){if(e.length===2)return Mn(e.charCodeAt(0)-97,e.charCodeAt(1)-49)}const mt=e=>zt[le(e)]+Fi[ze(e)],ql=e=>{if(e[1]==="@"&&e.length===4){const t=Rn(e[0]),n=dt(e.slice(2));if(t&&M(n))return{role:t,to:n}}else if(e.length===4||e.length===5){const t=dt(e.slice(0,2)),n=dt(e.slice(2,4));let r;if(e.length===5&&(r=Rn(e[4]),!r))return;if(M(t)&&M(n))return{from:t,to:n,promotion:r}}},ir=(e,t)=>e==="white"?t==="a"?2:6:t==="a"?58:62,or=(e,t)=>e==="white"?t==="a"?3:5:t==="a"?59:61,Kl=(e,t)=>{const n=new Map,r=e.ctx();for(const[i,o]of e.allDests(r))if(o.nonEmpty()){const s=Array.from(o,mt);i===r.king&&le(i)===4&&(o.has(0)?s.push("c1"):o.has(56)&&s.push("c8"),o.has(7)?s.push("g1"):o.has(63)&&s.push("g8")),n.set(mt(i),s)}return n};function jl(e){let t=0;return n=>{t+=n.deltaY*(n.deltaMode?40:1),Math.abs(t)>=4?(e(n,!0),t=0):e(n,!1)}}const Mr=e=>(e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),Math.imul(e+(e>>>4)&252645135,16843009)>>24),On=e=>(e=e>>>8&16711935|(e&16711935)<<8,e>>>16&65535|(e&65535)<<16),Rr=e=>(e=e>>>1&1431655765|(e&1431655765)<<1,e=e>>>2&858993459|(e&858993459)<<2,e=e>>>4&252645135|(e&252645135)<<4,On(e));class p{constructor(t,n){this.lo=t|0,this.hi=n|0}static fromSquare(t){return t>=32?new p(0,1<<t-32):new p(1<<t,0)}static fromRank(t){return new p(255,0).shl64(8*t)}static fromFile(t){return new p(16843009<<t,16843009<<t)}static empty(){return new p(0,0)}static full(){return new p(4294967295,4294967295)}static corners(){return new p(129,2164260864)}static center(){return new p(402653184,24)}static backranks(){return new p(255,4278190080)}static backrank(t){return t==="white"?new p(255,0):new p(0,4278190080)}static lightSquares(){return new p(1437226410,1437226410)}static darkSquares(){return new p(2857740885,2857740885)}complement(){return new p(~this.lo,~this.hi)}xor(t){return new p(this.lo^t.lo,this.hi^t.hi)}union(t){return new p(this.lo|t.lo,this.hi|t.hi)}intersect(t){return new p(this.lo&t.lo,this.hi&t.hi)}diff(t){return new p(this.lo&~t.lo,this.hi&~t.hi)}intersects(t){return this.intersect(t).nonEmpty()}isDisjoint(t){return this.intersect(t).isEmpty()}supersetOf(t){return t.diff(this).isEmpty()}subsetOf(t){return this.diff(t).isEmpty()}shr64(t){return t>=64?p.empty():t>=32?new p(this.hi>>>t-32,0):t>0?new p(this.lo>>>t^this.hi<<32-t,this.hi>>>t):this}shl64(t){return t>=64?p.empty():t>=32?new p(0,this.lo<<t-32):t>0?new p(this.lo<<t,this.hi<<t^this.lo>>>32-t):this}bswap64(){return new p(On(this.hi),On(this.lo))}rbit64(){return new p(Rr(this.hi),Rr(this.lo))}minus64(t){const n=this.lo-t.lo,r=(n&t.lo&1)+(t.lo>>>1)+(n>>>1)>>>31;return new p(n,this.hi-(t.hi+r))}equals(t){return this.lo===t.lo&&this.hi===t.hi}size(){return Mr(this.lo)+Mr(this.hi)}isEmpty(){return this.lo===0&&this.hi===0}nonEmpty(){return this.lo!==0||this.hi!==0}has(t){return(t>=32?this.hi&1<<t-32:this.lo&1<<t)!==0}set(t,n){return n?this.with(t):this.without(t)}with(t){return t>=32?new p(this.lo,this.hi|1<<t-32):new p(this.lo|1<<t,this.hi)}without(t){return t>=32?new p(this.lo,this.hi&~(1<<t-32)):new p(this.lo&~(1<<t),this.hi)}toggle(t){return t>=32?new p(this.lo,this.hi^1<<t-32):new p(this.lo^1<<t,this.hi)}last(){if(this.hi!==0)return 63-Math.clz32(this.hi);if(this.lo!==0)return 31-Math.clz32(this.lo)}first(){if(this.lo!==0)return 31-Math.clz32(this.lo&-this.lo);if(this.hi!==0)return 63-Math.clz32(this.hi&-this.hi)}withoutFirst(){return this.lo!==0?new p(this.lo&this.lo-1,this.hi):new p(0,this.hi&this.hi-1)}moreThanOne(){return this.hi!==0&&this.lo!==0||(this.lo&this.lo-1)!==0||(this.hi&this.hi-1)!==0}singleSquare(){return this.moreThanOne()?void 0:this.last()}*[Symbol.iterator](){let t=this.lo,n=this.hi;for(;t!==0;){const r=31-Math.clz32(t&-t);t^=1<<r,yield r}for(;n!==0;){const r=31-Math.clz32(n&-n);n^=1<<r,yield 32+r}}*reversed(){let t=this.lo,n=this.hi;for(;n!==0;){const r=31-Math.clz32(n);n^=1<<r,yield 32+r}for(;t!==0;){const r=31-Math.clz32(t);t^=1<<r,yield r}}}const Ut=(e,t)=>{let n=p.empty();for(const r of t){const i=e+r;0<=i&&i<64&&Math.abs(le(e)-le(i))<=2&&(n=n.with(i))}return n},Re=e=>{const t=[];for(let n=0;n<64;n++)t[n]=e(n);return t},zl=Re(e=>Ut(e,[-9,-8,-7,-1,1,7,8,9])),Hl=Re(e=>Ut(e,[-17,-15,-10,-6,6,10,15,17])),Ul={white:Re(e=>Ut(e,[7,9])),black:Re(e=>Ut(e,[-7,-9]))},sr=e=>zl[e],lr=e=>Hl[e],rn=(e,t)=>Ul[e][t],Ln=Re(e=>p.fromFile(le(e)).without(e)),xn=Re(e=>p.fromRank(ze(e)).without(e)),Nn=Re(e=>{const t=new p(134480385,2151686160),n=8*(ze(e)-le(e));return(n>=0?t.shl64(n):t.shr64(-n)).without(e)}),Tn=Re(e=>{const t=new p(270549120,16909320),n=8*(ze(e)+le(e)-7);return(n>=0?t.shl64(n):t.shr64(-n)).without(e)}),Dn=(e,t,n)=>{let r=n.intersect(t),i=r.bswap64();return r=r.minus64(e),i=i.minus64(e.bswap64()),r.xor(i.bswap64()).intersect(t)},Wl=(e,t)=>Dn(p.fromSquare(e),Ln[e],t),Gl=(e,t)=>{const n=xn[e];let r=t.intersect(n),i=r.rbit64();return r=r.minus64(p.fromSquare(e)),i=i.minus64(p.fromSquare(63-e)),r.xor(i.rbit64()).intersect(n)},wt=(e,t)=>{const n=p.fromSquare(e);return Dn(n,Nn[e],t).xor(Dn(n,Tn[e],t))},bt=(e,t)=>Wl(e,t).xor(Gl(e,t)),qi=(e,t)=>wt(e,t).xor(bt(e,t)),Ki=(e,t)=>{const n=p.fromSquare(t);return xn[e].intersects(n)?xn[e].with(e):Tn[e].intersects(n)?Tn[e].with(e):Nn[e].intersects(n)?Nn[e].with(e):Ln[e].intersects(n)?Ln[e].with(e):p.empty()},yt=(e,t)=>Ki(e,t).intersect(p.full().shl64(e).xor(p.full().shl64(t))).withoutFirst();class Je{constructor(){}static default(){const t=new Je;return t.reset(),t}reset(){this.occupied=new p(65535,4294901760),this.promoted=p.empty(),this.white=new p(65535,0),this.black=new p(0,4294901760),this.pawn=new p(65280,16711680),this.knight=new p(66,1107296256),this.bishop=new p(36,603979776),this.rook=new p(129,2164260864),this.queen=new p(8,134217728),this.king=new p(16,268435456)}static empty(){const t=new Je;return t.clear(),t}clear(){this.occupied=p.empty(),this.promoted=p.empty();for(const t of je)this[t]=p.empty();for(const t of ae)this[t]=p.empty()}clone(){const t=new Je;t.occupied=this.occupied,t.promoted=this.promoted;for(const n of je)t[n]=this[n];for(const n of ae)t[n]=this[n];return t}getColor(t){if(this.white.has(t))return"white";if(this.black.has(t))return"black"}getRole(t){for(const n of ae)if(this[n].has(t))return n}get(t){const n=this.getColor(t);if(!n)return;const r=this.getRole(t),i=this.promoted.has(t);return{color:n,role:r,promoted:i}}take(t){const n=this.get(t);return n&&(this.occupied=this.occupied.without(t),this[n.color]=this[n.color].without(t),this[n.role]=this[n.role].without(t),n.promoted&&(this.promoted=this.promoted.without(t))),n}set(t,n){const r=this.take(t);return this.occupied=this.occupied.with(t),this[n.color]=this[n.color].with(t),this[n.role]=this[n.role].with(t),n.promoted&&(this.promoted=this.promoted.with(t)),r}has(t){return this.occupied.has(t)}*[Symbol.iterator](){for(const t of this.occupied)yield[t,this.get(t)]}pieces(t,n){return this[t].intersect(this[n])}rooksAndQueens(){return this.rook.union(this.queen)}bishopsAndQueens(){return this.bishop.union(this.queen)}steppers(){return this.knight.union(this.pawn).union(this.king)}sliders(){return this.bishop.union(this.rook).union(this.queen)}kingOf(t){return this.pieces(t,"king").singleSquare()}}class fe{constructor(){}static empty(){const t=new fe;for(const n of ae)t[n]=0;return t}static fromBoard(t,n){const r=new fe;for(const i of ae)r[i]=t.pieces(n,i).size();return r}clone(){const t=new fe;for(const n of ae)t[n]=this[n];return t}equals(t){return ae.every(n=>this[n]===t[n])}add(t){const n=new fe;for(const r of ae)n[r]=this[r]+t[r];return n}subtract(t){const n=new fe;for(const r of ae)n[r]=this[r]-t[r];return n}nonEmpty(){return ae.some(t=>this[t]>0)}isEmpty(){return!this.nonEmpty()}hasPawns(){return this.pawn>0}hasNonPawns(){return this.knight>0||this.bishop>0||this.rook>0||this.queen>0||this.king>0}size(){return this.pawn+this.knight+this.bishop+this.rook+this.queen+this.king}}class Be{constructor(t,n){this.white=t,this.black=n}static empty(){return new Be(fe.empty(),fe.empty())}static fromBoard(t){return new Be(fe.fromBoard(t,"white"),fe.fromBoard(t,"black"))}clone(){return new Be(this.white.clone(),this.black.clone())}equals(t){return this.white.equals(t.white)&&this.black.equals(t.black)}add(t){return new Be(this.white.add(t.white),this.black.add(t.black))}subtract(t){return new Be(this.white.subtract(t.white),this.black.subtract(t.black))}count(t){return this.white[t]+this.black[t]}size(){return this.white.size()+this.black.size()}isEmpty(){return this.white.isEmpty()&&this.black.isEmpty()}nonEmpty(){return!this.isEmpty()}hasPawns(){return this.white.hasPawns()||this.black.hasPawns()}hasNonPawns(){return this.white.hasNonPawns()||this.black.hasNonPawns()}}class vt{constructor(t,n){this.white=t,this.black=n}static default(){return new vt(3,3)}clone(){return new vt(this.white,this.black)}equals(t){return this.white===t.white&&this.black===t.black}}class ji{unwrap(t,n){const r=this._chain(i=>R.ok(t?t(i):i),i=>n?R.ok(n(i)):R.err(i));if(r.isErr)throw r.error;return r.value}map(t,n){return this._chain(r=>R.ok(t(r)),r=>R.err(n?n(r):r))}chain(t,n){return this._chain(t,n??(r=>R.err(r)))}}class Vl extends ji{constructor(t){super(),this.value=t,this.isOk=!0,this.isErr=!1}_chain(t,n){return t(this.value)}}class Ql extends ji{constructor(t){super(),this.error=t,this.isOk=!1,this.isErr=!0}_chain(t,n){return n(this.error)}}var R;(function(e){function t(i){return new Vl(i)}e.ok=t;function n(i){return new Ql(i||new Error)}e.err=n;function r(i){if(Array.isArray(i)){const l=[];for(let c=0;c<i.length;c++){const a=i[c];if(a.isErr)return a;l.push(a.value)}return e.ok(l)}const o={},s=Object.keys(i);for(let l=0;l<s.length;l++){const c=i[s[l]];if(c.isErr)return c;o[s[l]]=c.value}return e.ok(o)}e.all=r})(R||(R={}));var Se;(function(e){e.Empty="ERR_EMPTY",e.OppositeCheck="ERR_OPPOSITE_CHECK",e.PawnsOnBackrank="ERR_PAWNS_ON_BACKRANK",e.Kings="ERR_KINGS",e.Variant="ERR_VARIANT"})(Se||(Se={}));class Xe extends Error{}const Xl=(e,t,n,r)=>n[t].intersect(bt(e,r).intersect(n.rooksAndQueens()).union(wt(e,r).intersect(n.bishopsAndQueens())).union(lr(e).intersect(n.knight)).union(sr(e).intersect(n.king)).union(rn(V(t),e).intersect(n.pawn)));class Fe{constructor(){}static default(){const t=new Fe;return t.castlingRights=p.corners(),t.rook={white:{a:0,h:7},black:{a:56,h:63}},t.path={white:{a:new p(14,0),h:new p(96,0)},black:{a:new p(0,234881024),h:new p(0,1610612736)}},t}static empty(){const t=new Fe;return t.castlingRights=p.empty(),t.rook={white:{a:void 0,h:void 0},black:{a:void 0,h:void 0}},t.path={white:{a:p.empty(),h:p.empty()},black:{a:p.empty(),h:p.empty()}},t}clone(){const t=new Fe;return t.castlingRights=this.castlingRights,t.rook={white:{a:this.rook.white.a,h:this.rook.white.h},black:{a:this.rook.black.a,h:this.rook.black.h}},t.path={white:{a:this.path.white.a,h:this.path.white.h},black:{a:this.path.black.a,h:this.path.black.h}},t}add(t,n,r,i){const o=ir(t,n),s=or(t,n);this.castlingRights=this.castlingRights.with(i),this.rook[t][n]=i,this.path[t][n]=yt(i,s).with(s).union(yt(r,o).with(o)).without(r).without(i)}static fromSetup(t){const n=Fe.empty(),r=t.castlingRights.intersect(t.board.rook);for(const i of je){const o=p.backrank(i),s=t.board.kingOf(i);if(!M(s)||!o.has(s))continue;const l=r.intersect(t.board[i]).intersect(o),c=l.first();M(c)&&c<s&&n.add(i,"a",s,c);const a=l.last();M(a)&&s<a&&n.add(i,"h",s,a)}return n}discardRook(t){if(this.castlingRights.has(t)){this.castlingRights=this.castlingRights.without(t);for(const n of je)for(const r of Fl)this.rook[n][r]===t&&(this.rook[n][r]=void 0)}}discardColor(t){this.castlingRights=this.castlingRights.diff(p.backrank(t)),this.rook[t].a=void 0,this.rook[t].h=void 0}}class Yl{constructor(t){this.rules=t}reset(){this.board=Je.default(),this.pockets=void 0,this.turn="white",this.castles=Fe.default(),this.epSquare=void 0,this.remainingChecks=void 0,this.halfmoves=0,this.fullmoves=1}setupUnchecked(t){this.board=t.board.clone(),this.board.promoted=p.empty(),this.pockets=void 0,this.turn=t.turn,this.castles=Fe.fromSetup(t),this.epSquare=Zl(this,t.epSquare),this.remainingChecks=void 0,this.halfmoves=t.halfmoves,this.fullmoves=t.fullmoves}kingAttackers(t,n,r){return Xl(t,n,this.board,r)}playCaptureAt(t,n){this.halfmoves=0,n.role==="rook"&&this.castles.discardRook(t),this.pockets&&this.pockets[V(n.color)][n.promoted?"pawn":n.role]++}ctx(){const t=this.isVariantEnd(),n=this.board.kingOf(this.turn);if(!M(n))return{king:n,blockers:p.empty(),checkers:p.empty(),variantEnd:t,mustCapture:!1};const r=bt(n,p.empty()).intersect(this.board.rooksAndQueens()).union(wt(n,p.empty()).intersect(this.board.bishopsAndQueens())).intersect(this.board[V(this.turn)]);let i=p.empty();for(const s of r){const l=yt(n,s).intersect(this.board.occupied);l.moreThanOne()||(i=i.union(l))}const o=this.kingAttackers(n,V(this.turn),this.board.occupied);return{king:n,blockers:i,checkers:o,variantEnd:t,mustCapture:!1}}clone(){var t,n;const r=new this.constructor;return r.board=this.board.clone(),r.pockets=(t=this.pockets)===null||t===void 0?void 0:t.clone(),r.turn=this.turn,r.castles=this.castles.clone(),r.epSquare=this.epSquare,r.remainingChecks=(n=this.remainingChecks)===null||n===void 0?void 0:n.clone(),r.halfmoves=this.halfmoves,r.fullmoves=this.fullmoves,r}validate(){if(this.board.occupied.isEmpty())return R.err(new Xe(Se.Empty));if(this.board.king.size()!==2)return R.err(new Xe(Se.Kings));if(!M(this.board.kingOf(this.turn)))return R.err(new Xe(Se.Kings));const t=this.board.kingOf(V(this.turn));return M(t)?this.kingAttackers(t,this.turn,this.board.occupied).nonEmpty()?R.err(new Xe(Se.OppositeCheck)):p.backranks().intersects(this.board.pawn)?R.err(new Xe(Se.PawnsOnBackrank)):R.ok(void 0):R.err(new Xe(Se.Kings))}dropDests(t){return p.empty()}dests(t,n){if(n=n||this.ctx(),n.variantEnd)return p.empty();const r=this.board.get(t);if(!r||r.color!==this.turn)return p.empty();let i,o;if(r.role==="pawn"){i=rn(this.turn,t).intersect(this.board[V(this.turn)]);const s=this.turn==="white"?8:-8,l=t+s;if(0<=l&&l<64&&!this.board.occupied.has(l)){i=i.with(l);const c=this.turn==="white"?t<16:t>=48,a=l+s;c&&!this.board.occupied.has(a)&&(i=i.with(a))}M(this.epSquare)&&ec(this,t,n)&&(o=p.fromSquare(this.epSquare))}else r.role==="bishop"?i=wt(t,this.board.occupied):r.role==="knight"?i=lr(t):r.role==="rook"?i=bt(t,this.board.occupied):r.role==="queen"?i=qi(t,this.board.occupied):i=sr(t);if(i=i.diff(this.board[this.turn]),M(n.king)){if(r.role==="king"){const s=this.board.occupied.without(t);for(const l of i)this.kingAttackers(l,V(this.turn),s).nonEmpty()&&(i=i.without(l));return i.union(Or(this,"a",n)).union(Or(this,"h",n))}if(n.checkers.nonEmpty()){const s=n.checkers.singleSquare();if(!M(s))return p.empty();i=i.intersect(yt(s,n.king).with(s))}n.blockers.has(t)&&(i=i.intersect(Ki(t,n.king)))}return o&&(i=i.union(o)),i}isVariantEnd(){return!1}variantOutcome(t){}hasInsufficientMaterial(t){return this.board[t].intersect(this.board.pawn.union(this.board.rooksAndQueens())).nonEmpty()?!1:this.board[t].intersects(this.board.knight)?this.board[t].size()<=2&&this.board[V(t)].diff(this.board.king).diff(this.board.queen).isEmpty():this.board[t].intersects(this.board.bishop)?(!this.board.bishop.intersects(p.darkSquares())||!this.board.bishop.intersects(p.lightSquares()))&&this.board.pawn.isEmpty()&&this.board.knight.isEmpty():!0}toSetup(){var t,n;return{board:this.board.clone(),pockets:(t=this.pockets)===null||t===void 0?void 0:t.clone(),turn:this.turn,castlingRights:this.castles.castlingRights,epSquare:Jl(this),remainingChecks:(n=this.remainingChecks)===null||n===void 0?void 0:n.clone(),halfmoves:Math.min(this.halfmoves,150),fullmoves:Math.min(Math.max(this.fullmoves,1),9999)}}isInsufficientMaterial(){return je.every(t=>this.hasInsufficientMaterial(t))}hasDests(t){t=t||this.ctx();for(const n of this.board[this.turn])if(this.dests(n,t).nonEmpty())return!0;return this.dropDests(t).nonEmpty()}isLegal(t,n){if(Ht(t))return!this.pockets||this.pockets[this.turn][t.role]<=0||t.role==="pawn"&&p.backranks().has(t.to)?!1:this.dropDests(n).has(t.to);{if(t.promotion==="pawn"||t.promotion==="king"&&this.rules!=="antichess"||!!t.promotion!==(this.board.pawn.has(t.from)&&p.backranks().has(t.to)))return!1;const r=this.dests(t.from,n);return r.has(t.to)||r.has(tc(this,t).to)}}isCheck(){const t=this.board.kingOf(this.turn);return M(t)&&this.kingAttackers(t,V(this.turn),this.board.occupied).nonEmpty()}isEnd(t){return(t?t.variantEnd:this.isVariantEnd())?!0:this.isInsufficientMaterial()||!this.hasDests(t)}isCheckmate(t){return t=t||this.ctx(),!t.variantEnd&&t.checkers.nonEmpty()&&!this.hasDests(t)}isStalemate(t){return t=t||this.ctx(),!t.variantEnd&&t.checkers.isEmpty()&&!this.hasDests(t)}outcome(t){const n=this.variantOutcome(t);return n||(t=t||this.ctx(),this.isCheckmate(t)?{winner:V(this.turn)}:this.isInsufficientMaterial()||this.isStalemate(t)?{winner:void 0}:void 0)}allDests(t){t=t||this.ctx();const n=new Map;if(t.variantEnd)return n;for(const r of this.board[this.turn])n.set(r,this.dests(r,t));return n}play(t){const n=this.turn,r=this.epSquare,i=Hi(this,t);if(this.epSquare=void 0,this.halfmoves+=1,n==="black"&&(this.fullmoves+=1),this.turn=V(n),Ht(t))this.board.set(t.to,{role:t.role,color:n}),this.pockets&&this.pockets[n][t.role]--,t.role==="pawn"&&(this.halfmoves=0);else{const o=this.board.take(t.from);if(!o)return;let s;if(o.role==="pawn"){this.halfmoves=0,t.to===r&&(s=this.board.take(t.to+(n==="white"?-8:8)));const l=t.from-t.to;Math.abs(l)===16&&8<=t.from&&t.from<=55&&(this.epSquare=t.from+t.to>>1),t.promotion&&(o.role=t.promotion,o.promoted=!!this.pockets)}else if(o.role==="rook")this.castles.discardRook(t.from);else if(o.role==="king"){if(i){const l=this.castles.rook[n][i];if(M(l)){const c=this.board.take(l);this.board.set(ir(n,i),o),c&&this.board.set(or(n,i),c)}}this.castles.discardColor(n)}if(!i){const l=this.board.set(t.to,o)||s;l&&this.playCaptureAt(t.to,l)}}this.remainingChecks&&this.isCheck()&&(this.remainingChecks[n]=Math.max(this.remainingChecks[n]-1,0))}}class zi extends Yl{constructor(){super("chess")}static default(){const t=new this;return t.reset(),t}static fromSetup(t){const n=new this;return n.setupUnchecked(t),n.validate().map(r=>n)}clone(){return super.clone()}}const Zl=(e,t)=>{if(!M(t))return;const n=e.turn==="white"?5:2,r=e.turn==="white"?8:-8;if(ze(t)!==n||e.board.occupied.has(t+r))return;const i=t-r;if(!(!e.board.pawn.has(i)||!e.board[V(e.turn)].has(i)))return t},Jl=e=>{if(!M(e.epSquare))return;const t=e.ctx(),r=e.board.pieces(e.turn,"pawn").intersect(rn(V(e.turn),e.epSquare));for(const i of r)if(e.dests(i,t).has(e.epSquare))return e.epSquare},ec=(e,t,n)=>{if(!M(e.epSquare)||!rn(e.turn,t).has(e.epSquare))return!1;if(!M(n.king))return!0;const r=e.turn==="white"?8:-8,i=e.epSquare-r;return e.kingAttackers(n.king,V(e.turn),e.board.occupied.toggle(t).toggle(i).with(e.epSquare)).without(i).isEmpty()},Or=(e,t,n)=>{if(!M(n.king)||n.checkers.nonEmpty())return p.empty();const r=e.castles.rook[e.turn][t];if(!M(r)||e.castles.path[e.turn][t].intersects(e.board.occupied))return p.empty();const i=ir(e.turn,t),o=yt(n.king,i),s=e.board.occupied.without(n.king);for(const a of o)if(e.kingAttackers(a,V(e.turn),s).nonEmpty())return p.empty();const l=or(e.turn,t),c=e.board.occupied.toggle(n.king).toggle(r).toggle(l);return e.kingAttackers(i,V(e.turn),c).nonEmpty()?p.empty():p.fromSquare(r)},Hi=(e,t)=>{if(Ht(t))return;const n=t.to-t.from;if(!(Math.abs(n)!==2&&!e.board[e.turn].has(t.to))&&e.board.king.has(t.from))return n>0?"h":"a"},tc=(e,t)=>{const n=Hi(e,t);if(!n)return t;const r=e.castles.rook[e.turn][n];return{from:t.from,to:M(r)?r:t.to}},nc="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",rc=nc+" w KQkq -",cr=rc+" 0 1";var W;(function(e){e.Fen="ERR_FEN",e.Board="ERR_BOARD",e.Pockets="ERR_POCKETS",e.Turn="ERR_TURN",e.Castling="ERR_CASTLING",e.EpSquare="ERR_EP_SQUARE",e.RemainingChecks="ERR_REMAINING_CHECKS",e.Halfmoves="ERR_HALFMOVES",e.Fullmoves="ERR_FULLMOVES"})(W||(W={}));class Q extends Error{}const ic=(e,t,n)=>{let r=e.indexOf(t);for(;n-- >0&&r!==-1;)r=e.indexOf(t,r+t.length);return r},Ye=e=>/^\d{1,4}$/.test(e)?parseInt(e,10):void 0,Ui=e=>{const t=Rn(e);return t&&{role:t,color:e.toLowerCase()===e?"black":"white"}},yn=e=>{const t=Je.empty();let n=7,r=0;for(let i=0;i<e.length;i++){const o=e[i];if(o==="/"&&r===8)r=0,n--;else{const s=parseInt(o,10);if(s>0)r+=s;else{if(r>=8||n<0)return R.err(new Q(W.Board));const l=r+n*8,c=Ui(o);if(!c)return R.err(new Q(W.Board));e[i+1]==="~"&&(c.promoted=!0,i++),t.set(l,c),r++}}}return n!==0||r!==8?R.err(new Q(W.Board)):R.ok(t)},Lr=e=>{if(e.length>64)return R.err(new Q(W.Pockets));const t=Be.empty();for(const n of e){const r=Ui(n);if(!r)return R.err(new Q(W.Pockets));t[r.color][r.role]++}return R.ok(t)},oc=(e,t)=>{let n=p.empty();if(t==="-")return R.ok(n);for(const r of t){const i=r.toLowerCase(),o=r===i?"black":"white",s=o==="white"?0:7;if("a"<=i&&i<="h")n=n.with(Mn(i.charCodeAt(0)-97,s));else if(i==="k"||i==="q"){const l=e[o].intersect(p.backrank(o)).intersect(e.rook.union(e.king)),c=i==="k"?l.last():l.first();n=n.with(M(c)&&e.rook.has(c)?c:Mn(i==="k"?7:0,s))}else return R.err(new Q(W.Castling))}return je.some(r=>p.backrank(r).intersect(n).size()>2)?R.err(new Q(W.Castling)):R.ok(n)},xr=e=>{const t=e.split("+");if(t.length===3&&t[0]===""){const n=Ye(t[1]),r=Ye(t[2]);return!M(n)||n>3||!M(r)||r>3?R.err(new Q(W.RemainingChecks)):R.ok(new vt(3-n,3-r))}else if(t.length===2){const n=Ye(t[0]),r=Ye(t[1]);return!M(n)||n>3||!M(r)||r>3?R.err(new Q(W.RemainingChecks)):R.ok(new vt(n,r))}else return R.err(new Q(W.RemainingChecks))},sc=e=>{const t=e.split(/[\s_]+/),n=t.shift();let r,i=R.ok(void 0);if(n.endsWith("]")){const l=n.indexOf("[");if(l===-1)return R.err(new Q(W.Fen));r=yn(n.slice(0,l)),i=Lr(n.slice(l+1,-1))}else{const l=ic(n,"/",7);l===-1?r=yn(n):(r=yn(n.slice(0,l)),i=Lr(n.slice(l+1)))}let o;const s=t.shift();if(!M(s)||s==="w")o="white";else if(s==="b")o="black";else return R.err(new Q(W.Turn));return r.chain(l=>{const c=t.shift(),a=M(c)?oc(l,c):R.ok(p.empty()),d=t.shift();let u;if(M(d)&&d!=="-"&&(u=dt(d),!M(u)))return R.err(new Q(W.EpSquare));let f=t.shift(),h;M(f)&&f.includes("+")&&(h=xr(f),f=t.shift());const w=M(f)?Ye(f):0;if(!M(w))return R.err(new Q(W.Halfmoves));const g=t.shift(),y=M(g)?Ye(g):1;if(!M(y))return R.err(new Q(W.Fullmoves));const _=t.shift();let v=R.ok(void 0);if(M(_)){if(M(h))return R.err(new Q(W.RemainingChecks));v=xr(_)}else M(h)&&(v=h);return t.length>0?R.err(new Q(W.Fen)):i.chain(D=>a.chain(A=>v.map(P=>({board:l,pockets:D,turn:o,castlingRights:A,remainingChecks:P,epSquare:u,halfmoves:w,fullmoves:Math.max(1,y)}))))})},lc=e=>{let t=ut(e.role);return e.color==="white"&&(t=t.toUpperCase()),e.promoted&&(t+="~"),t},cc=e=>{let t="",n=0;for(let r=7;r>=0;r--)for(let i=0;i<8;i++){const o=i+r*8,s=e.get(o);s?(n>0&&(t+=n,n=0),t+=lc(s)):n++,i===7&&(n>0&&(t+=n,n=0),r!==0&&(t+="/"))}return t},Nr=e=>ae.map(t=>ut(t).repeat(e[t])).join(""),ac=e=>Nr(e.white).toUpperCase()+Nr(e.black),uc=(e,t)=>{let n="";for(const r of je){const i=p.backrank(r);let o=e.kingOf(r);M(o)&&!i.has(o)&&(o=void 0);const s=e.pieces(r,"rook").intersect(i);for(const l of t.intersect(i).reversed())if(l===s.first()&&M(o)&&l<o)n+=r==="white"?"Q":"q";else if(l===s.last()&&M(o)&&o<l)n+=r==="white"?"K":"k";else{const c=zt[le(l)];n+=r==="white"?c.toUpperCase():c}}return n||"-"},dc=e=>`${e.white}+${e.black}`,fc=(e,t)=>[cc(e.board)+(e.pockets?`[${ac(e.pockets)}]`:""),e.turn[0],uc(e.board,e.castlingRights),M(e.epSquare)?mt(e.epSquare):"-",...e.remainingChecks?[dc(e.remainingChecks)]:[],Math.max(0,Math.min(e.halfmoves,9999)),Math.max(1,Math.min(e.fullmoves,9999))].join(" "),hc=(e,t)=>{let n="";if(Ht(t))t.role!=="pawn"&&(n=ut(t.role).toUpperCase()),n+="@"+mt(t.to);else{const r=e.board.getRole(t.from);if(!r)return"--";if(r==="king"&&(e.board[e.turn].has(t.to)||Math.abs(t.to-t.from)===2))n=t.to>t.from?"O-O":"O-O-O";else{const i=e.board.occupied.has(t.to)||r==="pawn"&&le(t.from)!==le(t.to);if(r!=="pawn"){n=ut(r).toUpperCase();let o;if(r==="king"?o=sr(t.to).intersect(e.board.king):r==="queen"?o=qi(t.to,e.board.occupied).intersect(e.board.queen):r==="rook"?o=bt(t.to,e.board.occupied).intersect(e.board.rook):r==="bishop"?o=wt(t.to,e.board.occupied).intersect(e.board.bishop):o=lr(t.to).intersect(e.board.knight),o=o.intersect(e.board[e.turn]).without(t.from),o.nonEmpty()){const s=e.ctx();for(const l of o)e.dests(l,s).has(t.to)||(o=o.without(l));if(o.nonEmpty()){let l=!1,c=o.intersects(p.fromRank(ze(t.from)));o.intersects(p.fromFile(le(t.from)))?l=!0:c=!0,c&&(n+=zt[le(t.from)]),l&&(n+=Fi[ze(t.from)])}}}else i&&(n=zt[le(t.from)]);i&&(n+="x"),n+=mt(t.to),t.promotion&&(n+="="+ut(t.promotion).toUpperCase())}}return n},pc=(e,t)=>{var n;const r=hc(e,t);return e.play(t),!((n=e.outcome())===null||n===void 0)&&n.winner?r+"#":e.isCheck()?r+"+":r},gc=(e,t)=>pc(e.clone(),t),on=e=>zi.fromSetup(sc(e).unwrap()).unwrap(),mc=e=>on(e).turn,wc=(e,t)=>{let n=e[e.length-1]?.fen??cr,r=on(n),i=ql(t),o=gc(r,i);return r.play(i),{fen:fc(r.toSetup()),before_fen:n,uci:t,san:o}},bc=e=>e.map((t,n)=>`${Wi(n+1)}${t.san}`).join(" "),Wi=e=>e%2===0?"":yc(e),yc=e=>`${Math.ceil(e/2)}.`+(e%2===0?"..":"");var vc=N('<div class="is2d chessboard"> ');function kc(e){let t,n,r=S(()=>{try{return on(e.fen??cr)}catch{return zi.default()}}),i=S(()=>Kl(r())),o=S(()=>r().isCheck());return Fn(()=>{let s=r().isCheck(),l={fen:e.fen,check:s,premovable:{enabled:!1},movable:{color:e.movable_color,free:!1,dests:i(),events:{after:e.play_orig_key}}};n=Il(t,l)}),we(()=>{let s;if(e.last_move_uci){let l=e.last_move_uci;s=[l.slice(0,2),l.slice(2,4)]}n.set({lastMove:s,fen:e.fen,turnColor:e.turn_color,orientation:e.orientation??"white",check:o(),movable:{color:e.movable_color,dests:i()}})}),we(()=>{n.setAutoShapes(e.shapes??[])}),(()=>{var s=vc();return Me(l=>t=l,s),s})()}const _c=e=>jl(t=>{const n=t.target;n.tagName!=="PIECE"&&n.tagName!=="SQUARE"&&n.tagName!=="CG-BOARD"||(t.preventDefault(),e(Math.sign(t.deltaY)))});var Cc=N('<button class="meet-button draw">');function Pc(e){return(()=>{var t=Cc();return qe(t,"click",e.onClick,!0),k(t,()=>e.children),Y(n=>{var r=e.disabled,i=!!e.gray,o=!!(e.draw||e.meet),s=!!e.meet;return r!==n.e&&(t.disabled=n.e=r),i!==n.t&&t.classList.toggle("gray",n.t=i),o!==n.a&&t.classList.toggle("draw",n.a=o),s!==n.o&&t.classList.toggle("meet",n.o=s),n},{e:void 0,t:void 0,a:void 0,o:void 0}),t})()}Pe(["click"]);var Ec=N("<div class=moves-wrap><ul class=replay>"),$c=N("<li class=move><span class=index>");function Sc(e){let t;return we(()=>{let n=e.cursor,r=t.parentElement;if(!r)return;const i=t.querySelector(".cursor");if(!i){r.scrollTop=n>0?99999:0;return}let o=i.offsetTop-r.offsetHeight/2+i.offsetHeight;r.scrollTo({behavior:"smooth",top:o})}),(()=>{var n=Ec(),r=n.firstChild;return Me(i=>t=i,r),k(r,m(jn,{get fallback(){return e.fallback},get each(){return e.san_moves},children:(i,o)=>(()=>{var s=$c(),l=s.firstChild;return s.$$click=()=>e.on_set_cursor(o()),k(l,()=>Wi(o()+1)),k(s,i,null),Y(()=>s.classList.toggle("cursor",e.cursor===o())),s})()})),n})()}Pe(["click"]);const In={equals:!1},Ac=(e,t)=>e.length>0?()=>e(J(t)):e;function Mc(e,t){let n=0;const r=e.map((i,o)=>S(()=>(n=o,i()),void 0,In));return S(()=>r.map(i=>i())[n],void 0,t)}function Rc(e,t,n){let r=()=>t;const[i,o]=F(t,In),s=S(Ac(e,()=>r()),t,In);return[r=Mc([i,s],n),(l=>o(()=>typeof l=="function"?l(J(r)):l))]}function Oc(e,t){const n=16.666666666666668;let r=performance.now(),i=0,o;function s(l){o=requestAnimationFrame(s);let c=Math.min(l-r,1e3);for(r=l,i+=c;i>=n;)e(n),i-=n}return{start(){cancelAnimationFrame(o),o=requestAnimationFrame(s)},stop(){cancelAnimationFrame(o)}}}function Lc(e,t){const n=u=>{if(u.clientX||u.clientX===0)return[u.clientX,u.clientY]},r=u=>{let[f,h]=n(u)??[0,0];return[f-l.left,h-l.top]};function i(u){u.preventDefault(),e.setPointerCapture(u.pointerId);let f=r(u);t.on_down(f)}function o(u){let f=r(u);t.on_up(f)}function s(u){let f=r(u);t.on_move(f)}let l;c();function c(){l=e.getBoundingClientRect()}function a(){c()}e.addEventListener("pointerdown",i,{passive:!1}),e.addEventListener("pointermove",s,{passive:!1}),document.addEventListener("pointerup",o);let d=new ResizeObserver(c);return d.observe(e),document.addEventListener("scroll",a,{capture:!0,passive:!0}),window.addEventListener("resize",a,{passive:!0}),()=>{e.removeEventListener("pointerdown",i),e.removeEventListener("pointermove",s),document.removeEventListener("pointerup",o),document.removeEventListener("scroll",a),window.removeEventListener("resize",a),d.unobserve(e)}}function xc(e,t,n){return e<t?Math.min(e+n,t):e>t?Math.max(e-n,t):e}function ct(e,t){let[n,r,i,o]=e,[s,l,c,a]=t;return n<s+c&&n+i>s&&r<l+a&&r+o>l}function Nc(e,t){let n,r,i,o,s,l=!1,c=0,a={on_down(u){i=void 0,r=u,o=u,l=!1,t()},on_up(u){r=void 0,n=void 0,i=u},on_move(u){n=u,l=!0}},d=Lc(e,a);return{get is_hovering(){return n},get is_down(){return r},get is_up(){return i},get is_just_down(){return o},get is_double_click(){return s},get has_moved_after_last_down(){return l},update(u){s=void 0,o&&c>0&&(s=o,c=0),c=xc(c,0,u),o=void 0,i=void 0},disconnect(){d()},manual_trigger_down_hook(u){a.on_down(u)}}}const Tc=1e-4;class H{static rotate_point(t,n,r,i,o){let s=Math.cos(r),l=Math.sin(r),c=t-i,a=n-o,d=c*s-a*l,u=c*l+a*s;return d+=i,u+=o,H.make(d,u)}static from_angle=t=>new H(Math.cos(t),Math.sin(t));static make=(t,n)=>new H(t,n);static xy=t=>new H(t[0],t[1]);static get unit(){return new H(1,1)}static get zero(){return new H(0,0)}get xy(){return[this.x,this.y]}get mul_inverse(){return new H(1/this.x,1/this.y)}get inverse(){return new H(-this.x,-this.y)}get half(){return new H(this.x/2,this.y/2)}get length_squared(){return this.x*this.x+this.y*this.y}get length(){return Math.sqrt(this.length_squared)}get normalize(){if(this.length!==0)return this.scale(1/this.length)}get perpendicular(){return new H(-this.y,this.x)}get angle(){return Math.atan2(this.y,this.x)}x;y;constructor(t,n){this.x=t,this.y=n}clamp_epsilon(t=Tc){return this.length<t?H.zero:this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}project_to(t){let n=t.length_squared,r=this.dot(t);return H.make(r*t.x/n,r*t.y/n)}distance(t){return this.sub(t).length}addy(t){return H.make(this.x,this.y+t)}add_angle(t){return H.from_angle(this.angle+t)}scale(t){return H.make(this.x*t,this.y*t)}add(t){return H.make(this.x+t.x,this.y+t.y)}sub(t){return H.make(this.x-t.x,this.y-t.y)}mul(t){return H.make(this.x*t.x,this.y*t.y)}div(t){return H.make(this.x/t.x,this.y/t.y)}truncate(t){let n=this.length;return n>t?this.scale(t/n):this}}var Dc=N("<i>");const pe=e=>(()=>{var t=Dc();return Y(()=>ht(t,"data-icon",e.icon)),t})(),ge={Gear:"",CrossX:"",Gears:"",Delete:"",HeartEmpty:"",HeartFilled:"",DotEmpty:""};var Ic=N("<div class=sortable-list-wrap><ul class=sortable-list>"),Bc=N("<div class=sortable-list-dragging>"),Fc=N("<li class=draggable><div class=handle><span>.</span></div><div class=content>");function qc(e){const[t,n]=F(void 0),[r,i]=Rc(()=>e.list.map(b=>({item:b}))),o=S(()=>t()?r().indexOf(t()):-1),s=(b,E)=>{if(b===E)return;let C=r();[C[b],C[E]]=[C[E],C[b]],i(C.slice(0))};let l,c;const a=()=>(c===void 0&&(c=e.portal_selector.getBoundingClientRect()),c);let d,[u,f]=F(void 0);const h=()=>(d===void 0&&(d=K.getBoundingClientRect()),d),w=()=>{let b=a(),E=h(),C=10;return[E.left-b.left,E.bottom-b.top-C,E.width,C]},g=()=>{let b=a(),E=h();return[E.left-b.left,E.top-b.top,E.width,10]},y=()=>(u()===void 0&&f(O.getBoundingClientRect()),u()),_=b=>[b[0]-5,b[1]-5,10,10];Fn(()=>{let b,C=Oc(G=>{if(l.is_just_down&&(b=l.is_just_down),l.is_hovering){if(ct(w(),_(l.is_hovering))&&(K.scrollTop+=10),ct(g(),_(l.is_hovering))&&(K.scrollTop-=10),P(l.is_hovering),t()!==void 0){let j=te(l.is_hovering);j&&s(o(),j[0])}if(b&&H.make(...l.is_hovering).distance(H.make(...b))>4){let j=te(l.is_hovering);if(j){let[ne,ie]=j,Ee=r()[ne];n(Ee),D(ie)}b=void 0}}l.is_up&&(n(void 0),C.stop(),e.set_list(r().map(j=>j.item)),e.portal_selector.classList.remove("active")),l.update(G)});l=Nc(e.portal_selector,C.start);const $=()=>{f(void 0),d=void 0,c=void 0};K.addEventListener("scroll",$);let x=new ResizeObserver($);x.observe(K),Ce(()=>{l.disconnect(),C.stop(),K.removeEventListener("scroll",$),x.unobserve(K)});const z=S(()=>{y();let G=a();return[...O.querySelectorAll(".draggable")].map(j=>{let ne=j.getBoundingClientRect(),ie=[ne.left-G.left,ne.top-G.top];return[ie[0],ie[1],ne.width,ne.height]})}),te=G=>{let j=z().findIndex(ie=>ct(ie,_(G)));if(j===-1)return;let ne=z()[j];return[j,[G[0]-ne[0],G[1]-ne[1]]]}});const[v,D]=F([0,0]),[A,P]=F([0,0]),U=S(()=>({transform:`translate(${A()[0]-v()[0]}px, ${A()[1]-v()[1]}px)`}));let K,O;const ee=b=>{if(l===void 0)return;let E=a(),C=[b.clientX-E.left,b.clientY-E.top];ct(w(),_(C))||ct(g(),_(C))||(l.manual_trigger_down_hook(C),b.preventDefault(),e.portal_selector.classList.add("active"))},T=(b,E)=>Qt(()=>e.children(b,E));return[m(et,{get when(){return t()},children:b=>m(zn,{get mount(){return e.portal_selector},get children(){var E=Bc();return k(E,()=>e.dragging(b().item)),Y(C=>Gr(E,U(),C)),E}})}),(()=>{var b=Ic(),E=b.firstChild;return Me(C=>K=C,b),Me(C=>O=C,E),k(E,m(jn,{get each(){return r()},children:(C,$)=>(()=>{var x=Fc(),z=x.firstChild,te=z.firstChild,G=te.firstChild,j=z.nextSibling;return z.$$pointerdown=ee,k(z,m(pe,{get icon(){return ge.DotEmpty}}),te),k(te,()=>$()+1,G),k(j,()=>T(C.item,$)()),Y(()=>x.classList.toggle("dragging",o()===$())),x})()})),b})()]}Pe(["pointerdown"]);var Kc=N('<div class="dropdown-menu show">'),jc=N("<button class=dropdown-menu-toggle-button>");const Gi=e=>{let t,n;const[r,i]=F(!1);we(()=>{if(r(),n===void 0||t===void 0)return;let c=e.portal_selector.getBoundingClientRect(),a=n.getBoundingClientRect(),d=a.bottom-c.top,u=a.left-c.left;u+200>window.innerWidth&&(u-=200-a.width),t.style.top=`${d}px`,t.style.left=`${u}px`});const o=()=>{i(!1)};Ce(()=>{window.removeEventListener("resize",o),document.removeEventListener("click",s)}),Fn(()=>{window.addEventListener("resize",o),document.addEventListener("click",s)});function s(c){t===void 0||t.contains(c.target),i(!1)}function l(c){e.portal_selector.classList.contains("active")||c.stopImmediatePropagation(),i(!r())}return we(()=>{r()?e.portal_selector.classList.add("active"):e.portal_selector.classList.remove("active")}),[m(zn,{get mount(){return e.portal_selector},get children(){return m(et,{get when(){return r()},get children(){var c=Kc(),a=t;return typeof a=="function"?Me(a,c):t=c,k(c,()=>e.children),c}})}}),(()=>{var c=jc();c.$$click=l;var a=n;return typeof a=="function"?Me(a,c):n=c,k(c,()=>e.button),Y(()=>c.classList.toggle("active",!!r())),c})()]};Pe(["click"]);var zc=N("<span class=heart><span class=nb>");const Hc=e=>{const[t,n]=F(!1),[r,i]=F(e.is_heart),o=()=>{i(!r()),e.on_heart(r()),n(!0),setTimeout(()=>n(!1),200)};return(()=>{var s=zc(),l=s.firstChild;return s.$$click=o,k(s,m(et,{get when(){return r()},get fallback(){return m(pe,{get icon(){return ge.HeartEmpty}})},get children(){return m(pe,{get icon(){return ge.HeartFilled}})}}),l),k(l,()=>e.nb_heart),Y(c=>{var a=!!r(),d=!!t();return a!==c.e&&s.classList.toggle("is-heart",c.e=a),d!==c.t&&s.classList.toggle("beat",c.t=d),c},{e:void 0,t:void 0}),s})()};Pe(["click"]);var Uc=N("<button class=action-button>");const me={Ok:1,Cancel:2,Normal:3},He=e=>{const t=no(()=>e.action);return(()=>{var n=Uc();return qe(n,"click",e.onClick,!0),k(n,()=>e.children),Y(r=>{var i=!!t(me.Ok),o=!!t(me.Cancel),s=!!t(me.Normal);return i!==r.e&&n.classList.toggle("ok",r.e=i),o!==r.t&&n.classList.toggle("cancel",r.t=o),s!==r.a&&n.classList.toggle("normal",r.a=s),r},{e:void 0,t:void 0,a:void 0}),n})()};Pe(["click"]);const Wt=(e,t,n=[],r=[])=>{if(e){if(Array.isArray(e))e.forEach(i=>Wt(i,t,n,r));else if(typeof e=="function")Wt(e.apply(null,n),t,n,r);else{const i=e;(!t||(typeof t=="function"?t(i):i.nodeName===t))&&r.push(i)}return r}};var Et=N("<div>");const kt=e=>{const[t,n]=Wr(e,["open","children","portal_selector","close_on_click_outside"]),[r,i]=F(!1),[o,s]=F(t.open);we(()=>s(t.open));const l=f=>s(typeof f=="boolean"?f:h=>!h),c=S(()=>Wt(t.children,f=>f.className.indexOf("sb-modal-content")!==-1,[{open:o,toggle:l,set_hold_close_outside:i}])??[]),a=S(()=>Wt(t.children,f=>f.className.indexOf("sb-modal-content")===-1,[{open:o,toggle:l,set_hold_close_outside:i}]));let d;we(()=>o()&&d?.focus(),d?.scrollIntoView());const u=Ae(n,{role:"dialog",tabIndex:-1,class:e.class?`sb-modal ${e.class}`:"sb-modal",children:c(),onClick:S(()=>t.close_on_click_outside?f=>{if(r())return;const h=f.target;c().some(w=>w?.contains(h))||l(!1)}:void 0)()});return m(et,{get when(){return o()},get fallback(){return a()},get children(){return[tt(a),m(zn,{get mount(){return t.portal_selector},get children(){var f=Et(),h=d;return typeof h=="function"?Me(h,f):d=f,nt(f,u,!1),f}})]}})},sn=e=>(()=>{var t=Et();return nt(t,Ae(e,{get class(){return tt(()=>!!e.class)()?`sb-modal-content ${e.class}`:"sb-modal-content"}}),!1),t})(),ln=e=>(()=>{var t=Et();return nt(t,Ae(e,{get class(){return tt(()=>!!e.class)()?`sb-modal-header ${e.class}`:"sb-modal-header"}}),!1),t})(),cn=e=>(()=>{var t=Et();return nt(t,Ae(e,{get class(){return tt(()=>!!e.class)()?`sb-modal-body ${e.class}`:"sb-modal-body"}}),!1),t})(),ar=e=>(()=>{var t=Et();return nt(t,Ae(e,{get class(){return tt(()=>!!e.class)()?`sb-modal-footer ${e.class}`:"sb-modal-footer"}}),!1),t})();var Wc=N("<label class=custom-field><input name=custom-field class=highlighted-text type=text placeholder=_><span class=placeholder>");const an=e=>{const t=n=>{e.on_keyup(n.target.value,n.key==="Enter")};return(()=>{var n=Wc(),r=n.firstChild,i=r.nextSibling;return qe(r,"keyup",t),k(i,()=>e.placeholder),Y(()=>ht(r,"size",e.size??50)),n})()};var Gc=N('<div class=openings><div class=build><h3>Build</h3><div class=board-wrap><div class=board></div></div><div class=board-tools><a>Flip</a></div></div><div class=explore><h3>Explore</h3><div class=replay-wrap><div class=replay-tools><a></a><a>Clear</a><a>Delete after</a></div></div><div class=tools><div class=action></div></div></div><div class=playlist><h3>Playlist</h3><div class=filters><div class="tab active">Mine</div><div class=tab>Liked</div><div class=tab>Global</div></div><div class=lists><ul></ul></div><div class=info></div><div class=lines></div></div><div class=sortable-list-portal></div><div class=dropdown-menu-portal></div><div class=modal-portal>'),Vc=N("<span>Play an opening line to save it."),Qc=N("<a><small>+ Add to Playlist"),Xc=N("<li class=item-new><div class=icon>+</div><div class=title>Create New Playlist"),Yc=N("<li class=item><div class=title></div><div class=nb>50 lines"),Zc=N("<div class=title>1.e4 Sicilian Defense Scandinavian Defense More Alekhine Queen's G D"),Vi=N("<ul><li><div>Edit </div></li><li class=red>Delete "),Jc=N("<div class=more>"),ea=N("<div class=a-line><span class=name></span><div class=more>"),ta=N("<div class=number2> woop woop!"),na=N("<h3>Edit Line"),ra=N("<h3>Edit Playlist"),ia=N("<h3>Create New Playlist"),oa=N("<h2>Add To Playlist"),sa=N("<div class=close>"),la=N("<div class=add-to-playlist-modal-body><h3>Recent</h3><div class=recent></div><h3>All</h3><div class=all></div><div class=new-playlist-float>");const ca=()=>{let[e,t]=F(0);const[n,r]=F([]),i=S(()=>n()[e()]),o=S(()=>i()?.fen??cr),s=S(()=>mc(o())),l=S(()=>n().map(w=>w.san)),c=S(()=>i()?.uci),a=S(()=>n().slice(0,e()+1)),d=S(()=>bc(n()));let u={get cursor(){return e()},get fen(){return o()},get turn_color(){return s()},get san_moves(){return l()},get last_move_uci(){return c()},get export_PGN(){return d()}};const f=w=>{w<0?t(-1):n()[w]!==void 0&&t(w)};return[u,{add_uci_and_goto_it(w){qr(()=>{let g=a(),y=wc(g,w);r([...g,y]),t(n().length-1)})},goto_next_step(){f(e()+1)},goto_prev_step(){f(e()-1)},goto_first_step(){f(0)},goto_last_step(){f(n().length-1)},goto_set_cursor(w){f(w)},clear_steps(){r([]),t(0)},delete_after(){r(a())}}]},aa=()=>{let[e,{add_uci_and_goto_it:t,goto_next_step:n,goto_prev_step:r,goto_set_cursor:i,clear_steps:o,delete_after:s}]=ca();const l=(A,P)=>{let U=A+P;{let K=on(e.fen),O=K.turn;K.board.get(dt(A)).role==="pawn"&&(P[1]==="8"&&O==="white"||P[1]==="1"&&O==="black")&&(U+="q")}t(U)},c=A=>{A<0?r():n()};let[a,d]=F("white");const u=()=>{d(V(a()))},[f,h]=F(!1),w=S(()=>f()?"Copied!":"Copy"),g=async()=>{await navigator.clipboard.writeText(e.export_PGN),h(!0),await new Promise(A=>setTimeout(A,1e3)),h(!1)},[y,_]=F("1.e4 Sicilian Defense,1.e4 e5 French Defense,1.d4 Queen's Gambit Declined,Scandinavian ".repeat(10).trim().split(",")),[v,D]=F("e4 d4 f4 g5 ".repeat(10).trim().split(" "));return(()=>{var A=Gc(),P=A.firstChild,U=P.firstChild,K=U.nextSibling,O=K.firstChild,ee=K.nextSibling,T=ee.firstChild,b=P.nextSibling,E=b.firstChild,C=E.nextSibling,$=C.firstChild,x=$.firstChild,z=x.nextSibling,te=z.nextSibling,G=C.nextSibling,j=G.firstChild,ne=b.nextSibling,ie=ne.firstChild,Ee=ie.nextSibling,it=Ee.nextSibling,ur=it.firstChild,dr=it.nextSibling,Xi=dr.nextSibling;return qe(O,"wheel",{handleEvent:_c(c),passive:!1}),k(O,m(kc,{get fen(){return e.fen},play_orig_key:l,get turn_color(){return e.turn_color},get movable_color(){return e.turn_color},get orientation(){return a()},get last_move_uci(){return e.last_move_uci}})),T.$$click=u,k(C,m(Sc,{get fallback(){return Vc()},get san_moves(){return e.san_moves},get cursor(){return e.cursor},on_set_cursor:i}),$),x.$$click=g,k(x,w),qe(z,"click",o,!0),qe(te,"click",s,!0),k(G,m(an,{size:30,on_keyup:()=>{},placeholder:"Opening Line Name"}),j),k(j,m(Pc,{meet:!0,children:"Save"}),null),k(j,m(kt,{close_on_click_outside:!0,get portal_selector(){return document.querySelector(".modal-portal")},children:({toggle:xe,set_hold_close_outside:Ne})=>[(()=>{var $t=Qc();return $t.$$click=()=>xe(!0),$t})(),m(ga,{toggle:xe,set_hold_close_outside:Ne})]}),null),k(ur,m(kt,{close_on_click_outside:!0,get portal_selector(){return document.querySelector(".modal-portal")},children:({toggle:xe})=>[(()=>{var Ne=Xc();return Ne.$$click=()=>xe(!0),Ne})(),m(Qi,{toggle:xe})]}),null),k(ur,m(jn,{get each(){return y()},children:xe=>(()=>{var Ne=Yc(),$t=Ne.firstChild;return k($t,xe),Ne})()}),null),k(dr,m(ua,{})),k(Xi,m(qc,{children:da,dragging:fa,get portal_selector(){return document.querySelector(".sortable-list-portal")},get list(){return v()},set_list:D})),A})()},ua=()=>{const[e,t]=F(!1,{equals:!1});return[Zc(),(()=>{var n=Jc();return k(n,m(Hc,{nb_heart:900,is_heart:!1,on_heart:()=>{}}),null),k(n,m(Gi,{get portal_selector(){return document.querySelector(".dropdown-menu-portal")},get button(){return m(pe,{get icon(){return ge.Gear}})},get children(){var r=Vi(),i=r.firstChild,o=i.firstChild;o.firstChild;var s=i.nextSibling;return s.firstChild,o.$$click=()=>t(!0),k(o,m(pe,{get icon(){return ge.Gears}}),null),k(s,m(pe,{get icon(){return ge.Delete}}),null),r}}),null),k(n,m(kt,{close_on_click_outside:!0,get open(){return e()},get portal_selector(){return document.querySelector(".modal-portal")},children:({toggle:r})=>m(pa,{toggle:r})}),null),n})()]},da=e=>{const[t,n]=F(!1,{equals:!1});return(()=>{var r=ea(),i=r.firstChild,o=i.nextSibling;return k(i,e),k(o,m(Gi,{get portal_selector(){return document.querySelector(".dropdown-menu-portal")},get button(){return m(pe,{get icon(){return ge.Gear}})},get children(){var s=Vi(),l=s.firstChild,c=l.firstChild;c.firstChild;var a=l.nextSibling;return a.firstChild,c.$$click=()=>n(!0),k(c,m(pe,{get icon(){return ge.Gears}}),null),k(a,m(pe,{get icon(){return ge.Delete}}),null),s}})),k(r,m(kt,{close_on_click_outside:!0,get open(){return t()},get portal_selector(){return document.querySelector(".modal-portal")},children:({toggle:s})=>m(ha,{toggle:s})}),null),r})()},fa=e=>(()=>{var t=ta(),n=t.firstChild;return k(t,e,n),t})(),ha=e=>{const t=(n,r)=>{r&&(console.log(n),e.toggle(!1))};return m(sn,{get children(){return[m(ln,{get children(){return na()}}),m(cn,{get children(){return m(an,{placeholder:"Line Name",on_keyup:t})}}),m(ar,{get children(){return[m(He,{get action(){return me.Cancel},onClick:()=>e.toggle(!1),children:"Cancel"}),m(He,{get action(){return me.Ok},onClick:()=>e.toggle(!1),children:"Ok"})]}})]}})},pa=e=>{const t=(n,r)=>{r&&(console.log(n),e.toggle(!1))};return m(sn,{get children(){return[m(ln,{get children(){return ra()}}),m(cn,{get children(){return m(an,{placeholder:"Playlist Name",on_keyup:t})}}),m(ar,{get children(){return[m(He,{get action(){return me.Cancel},onClick:()=>e.toggle(!1),children:"Cancel"}),m(He,{get action(){return me.Ok},onClick:()=>e.toggle(!1),children:"Ok"})]}})]}})},Qi=e=>{const t=(n,r)=>{r&&(console.log(n),e.toggle(!1))};return m(sn,{get children(){return[m(ln,{get children(){return ia()}}),m(cn,{get children(){return m(an,{placeholder:"Playlist Name",on_keyup:t})}}),m(ar,{get children(){return[m(He,{get action(){return me.Cancel},onClick:()=>e.toggle(!1),children:"Cancel"}),m(He,{get action(){return me.Ok},onClick:()=>e.toggle(!1),children:"Create"})]}})]}})},ga=e=>{const t=n=>(we(()=>{e.set_hold_close_outside(n.open())}),Ce(()=>{e.set_hold_close_outside(!1)}),[m(He,{get action(){return me.Normal},onClick:()=>n.toggle(!0),children:"+ New Playlist"}),m(Qi,{get toggle(){return n.toggle}})]);return m(sn,{get children(){return[m(ln,{get children(){return[oa(),(()=>{var n=sa();return n.$$click=()=>e.toggle(!1),k(n,m(pe,{get icon(){return ge.CrossX}})),n})()]}}),m(cn,{get children(){var n=la(),r=n.firstChild,i=r.nextSibling,o=i.nextSibling,s=o.nextSibling,l=s.nextSibling;return k(l,m(kt,{close_on_click_outside:!0,get portal_selector(){return document.querySelector(".modal-portal")},children:({open:c,toggle:a})=>m(t,{toggle:a,open:c})})),n}})]}})};Pe(["click"]);var ma=N("<div class=challenges><div class=skills><h3>Skills</h3></div><div class=boards><h3>Leaderboards");const wa=()=>ma();var ba=N("<div class=main-wrap>"),ya=N("<small class=com>.com"),va=N("<main class=main><h1></h1><p> Explore, Build, and Share opening lines.</p><p> Complete Challenges on a unique Skill Tree. </p><p> Compete on the Leaderboards. </p><p> Free, Open Source, No Ads, No Trackers.</p><p>For the  of Chess</p><p><small> to make your data publicly available.</small></p><section class=section-openings><h2>Openings</h2></section><section class=section-challenges><h2>Challenges"),ka=N("<footer><!><!>");const _a=Xt(()=>Yt(()=>import("./MainLegal-DUEYKLB5.js"),__vite__mapDeps([0,1]))),Ca=Xt(()=>Yt(()=>import("./Main404-BMYWOY8U.js"),[])),Pa=Xt(()=>Yt(()=>import("./MainAbout-C_NaL66t.js"),__vite__mapDeps([2,1]))),Ea=Xt(()=>Yt(()=>import("./MainContact-DwWDH6WT.js"),__vite__mapDeps([3,4,1])));function $a(){return m(cs,{root:Sa,get children(){return[m(ot,{path:"/",component:Aa}),m(ot,{path:"/about",component:Pa}),m(ot,{path:"/legal",component:_a}),m(ot,{path:"/contact",component:Ea}),m(ot,{path:"*",component:Ca})]}})}function Sa(e){return(()=>{var t=ba();return k(t,()=>e.children),t})()}function Aa(){return[(()=>{var e=va(),t=e.firstChild,n=t.nextSibling,r=n.nextSibling,i=r.nextSibling,o=i.nextSibling,s=o.nextSibling,l=s.nextSibling,c=l.firstChild,a=c.firstChild,d=l.nextSibling;d.firstChild;var u=d.nextSibling;return u.firstChild,k(t,m(Qe,{class:"title",href:"/",get children(){return["LineChess",ya()]}})),k(c,m(Qe,{href:"/lichess",children:"Login with Lichess"}),a),k(d,m(aa,{}),null),k(u,m(wa,{}),null),e})(),(()=>{var e=ka(),t=e.firstChild,n=t.nextSibling,r=n.nextSibling,i=r.nextSibling;return i.nextSibling,k(e,m(Qe,{href:"/",children:"LineChess.com"}),t),k(e,m(Qe,{href:"/about",children:"About"}),n),k(e,m(Qe,{href:"/legal",children:"Legal"}),i),k(e,m(Qe,{href:"/contact",children:"Contact"}),null),e})()]}const Ma=document.getElementById("root");_o(()=>m($a,{}),Ma);export{Qe as A,F as a,S as b,m as c,Y as d,Pe as e,k as i,N as t};
