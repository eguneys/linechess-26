const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MainLegal-DZ2lS-pW.js","assets/MainLegal-CZOPaPYE.css","assets/MainAbout-WIqSEt7m.js","assets/MainContact-BauyCZhg.js","assets/MainContact-BM86F0VK.css"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const M={context:void 0,registry:void 0,effects:void 0,done:!1,getContextId(){return Rr(this.context.count)},getNextContextId(){return Rr(this.context.count++)}};function Rr(e){const t=String(e),n=t.length-1;return M.context.id+(n?String.fromCharCode(96+n):"")+t}function mt(e){M.context=e}const ei=!1,ti=(e,t)=>e===t,we=Symbol("solid-proxy"),ni=typeof Proxy=="function",Dn=Symbol("solid-track"),qt={equals:ti};let bt=null,ri=ci;const he=1,jt=2,ii={owned:null,cleanups:null,context:null,owner:null},$n={};var F=null;let En=null,ks=null,H=null,ne=null,fe=null,on=0;function ot(e,t){const n=H,r=F,i=e.length===0,s=t===void 0?r:t,o=i?ii:{owned:null,cleanups:null,context:s?s.context:null,owner:s},l=i?e:()=>e(()=>X(()=>kt(o)));F=o,H=null;try{return Ce(l,!0)}finally{H=n,F=r}}function T(e,t){t=t?Object.assign({},qt,t):qt;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},r=i=>(typeof i=="function"&&(i=i(n.value)),ai(n,i));return[li.bind(n),r]}function vs(e,t,n){const r=ct(e,t,!0,he);Ye(r)}function J(e,t,n){const r=ct(e,t,!1,he);Ye(r)}function be(e,t,n){ri=Os;const r=ct(e,t,!1,he);(!n||!n.render)&&(r.user=!0),fe?fe.push(r):Ye(r)}function A(e,t,n){n=n?Object.assign({},qt,n):qt;const r=ct(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,Ye(r),li.bind(r)}function Cs(e){return e&&typeof e=="object"&&"then"in e}function si(e,t,n){let r,i,s;typeof t=="function"?(r=e,i=t,s={}):(r=!0,i=e,s=t||{});let o=null,l=$n,a=null,c=!1,f="initialValue"in s,u=typeof r=="function"&&A(r);const d=new Set,[p,b]=(s.storage||T)(s.initialValue),[h,_]=T(void 0),[E,v]=T(void 0,{equals:!1}),[j,O]=T(f?"ready":"unresolved");M.context&&(a=M.getNextContextId(),s.ssrLoadFrom==="initial"?l=s.initialValue:M.load&&M.has(a)&&(l=M.load(a)));function R(q,y,k,P){return o===q&&(o=null,P!==void 0&&(f=!0),(q===l||y===l)&&s.onHydrated&&queueMicrotask(()=>s.onHydrated(P,{value:y})),l=$n,G(y,k)),y}function G(q,y){Ce(()=>{y===void 0&&b(()=>q),O(y!==void 0?"errored":f?"ready":"unresolved"),_(y);for(const k of d.keys())k.decrement();d.clear()},!1)}function U(){const q=Es,y=p(),k=h();if(k!==void 0&&!o)throw k;return H&&H.user,y}function D(q=!0){if(q!==!1&&c)return;c=!1;const y=u?u():r;if(y==null||y===!1){R(o,X(p));return}let k;const P=l!==$n?l:X(()=>{try{return i(y,{value:p(),refetching:q})}catch(x){k=x}});if(k!==void 0){R(o,void 0,Ft(k),y);return}else if(!Cs(P))return R(o,P,void 0,y),P;return o=P,"v"in P?(P.s===1?R(o,P.v,void 0,y):R(o,void 0,Ft(P.v),y),P):(c=!0,queueMicrotask(()=>c=!1),Ce(()=>{O(f?"refreshing":"pending"),v()},!1),P.then(x=>R(P,x,void 0,y),x=>R(P,void 0,Ft(x),y)))}Object.defineProperties(U,{state:{get:()=>j()},error:{get:()=>h()},loading:{get(){const q=j();return q==="pending"||q==="refreshing"}},latest:{get(){if(!f)return U();const q=h();if(q&&!o)throw q;return p()}}});let Y=F;return u?vs(()=>(Y=F,D(!1))):D(!1),[U,{refetch:q=>cn(Y,()=>D(q)),mutate:b}]}function oi(e,t=ti,n){const r=new Map,i=ct(s=>{const o=e();for(const[l,a]of r.entries())if(t(l,o)!==t(l,s))for(const c of a.values())c.state=he,c.pure?ne.push(c):fe.push(c);return o},void 0,!0,he);return Ye(i),s=>{const o=H;if(o){let l;(l=r.get(s))?l.add(o):r.set(s,l=new Set([o])),Re(()=>{l.delete(o),!l.size&&r.delete(s)})}return t(s,i.value)}}function ln(e){return Ce(e,!1)}function X(e){if(H===null)return e();const t=H;H=null;try{return e()}finally{H=t}}function an(e,t,n){const r=Array.isArray(e);let i,s=n&&n.defer;return o=>{let l;if(r){l=Array(e.length);for(let c=0;c<e.length;c++)l[c]=e[c]()}else l=e();if(s)return s=!1,o;const a=X(()=>t(l,i,o));return i=l,a}}function rr(e){be(()=>X(e))}function Re(e){return F===null||(F.cleanups===null?F.cleanups=[e]:F.cleanups.push(e)),e}function Ps(e,t){bt||(bt=Symbol("error")),F=ct(void 0,void 0,!0),F.context={...F.context,[bt]:[t]};try{return e()}catch(n){Mt(n)}finally{F=F.owner}}function In(){return H}function Kt(){return F}function cn(e,t){const n=F,r=H;F=e,H=null;try{return Ce(t,!0)}catch(i){Mt(i)}finally{F=n,H=r}}function $s(e){const t=H,n=F;return Promise.resolve().then(()=>{H=t,F=n;let r;return Ce(e,!1),H=F=null,r?r.done:void 0})}const[Su,Au]=T(!1);function ir(e,t){const n=Symbol("context");return{id:n,Provider:Rs(n),defaultValue:e}}function un(e){let t;return F&&F.context&&(t=F.context[e.id])!==void 0?t:e.defaultValue}function fn(e){const t=A(e),n=A(()=>Fn(t()));return n.toArray=()=>{const r=n();return Array.isArray(r)?r:r!=null?[r]:[]},n}let Es;function li(){if(this.sources&&this.state)if(this.state===he)Ye(this);else{const e=ne;ne=null,Ce(()=>Ht(this),!1),ne=e}if(H){const e=this.observers?this.observers.length:0;H.sources?(H.sources.push(this),H.sourceSlots.push(e)):(H.sources=[this],H.sourceSlots=[e]),this.observers?(this.observers.push(H),this.observerSlots.push(H.sources.length-1)):(this.observers=[H],this.observerSlots=[H.sources.length-1])}return this.value}function ai(e,t,n){let r=e.value;return(!e.comparator||!e.comparator(r,t))&&(e.value=t,e.observers&&e.observers.length&&Ce(()=>{for(let i=0;i<e.observers.length;i+=1){const s=e.observers[i],o=En&&En.running;o&&En.disposed.has(s),(o?!s.tState:!s.state)&&(s.pure?ne.push(s):fe.push(s),s.observers&&ui(s)),o||(s.state=he)}if(ne.length>1e6)throw ne=[],new Error},!1)),t}function Ye(e){if(!e.fn)return;kt(e);const t=on;Ss(e,e.value,t)}function Ss(e,t,n){let r;const i=F,s=H;H=F=e;try{r=e.fn(t)}catch(o){return e.pure&&(e.state=he,e.owned&&e.owned.forEach(kt),e.owned=null),e.updatedAt=n+1,Mt(o)}finally{H=s,F=i}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?ai(e,r):e.value=r,e.updatedAt=n)}function ct(e,t,n,r=he,i){const s={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:F,context:F?F.context:null,pure:n};return F===null||F!==ii&&(F.owned?F.owned.push(s):F.owned=[s]),s}function zt(e){if(e.state===0)return;if(e.state===jt)return Ht(e);if(e.suspense&&X(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<on);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===he)Ye(e);else if(e.state===jt){const r=ne;ne=null,Ce(()=>Ht(e,t[0]),!1),ne=r}}function Ce(e,t){if(ne)return e();let n=!1;t||(ne=[]),fe?n=!0:fe=[],on++;try{const r=e();return As(n),r}catch(r){n||(fe=null),ne=null,Mt(r)}}function As(e){if(ne&&(ci(ne),ne=null),e)return;const t=fe;fe=null,t.length&&Ce(()=>ri(t),!1)}function ci(e){for(let t=0;t<e.length;t++)zt(e[t])}function Os(e){let t,n=0;for(t=0;t<e.length;t++){const r=e[t];r.user?e[n++]=r:zt(r)}if(M.context){if(M.count){M.effects||(M.effects=[]),M.effects.push(...e.slice(0,n));return}mt()}for(M.effects&&(M.done||!M.count)&&(e=[...M.effects,...e],n+=M.effects.length,delete M.effects),t=0;t<n;t++)zt(e[t])}function Ht(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const r=e.sources[n];if(r.sources){const i=r.state;i===he?r!==t&&(!r.updatedAt||r.updatedAt<on)&&zt(r):i===jt&&Ht(r,t)}}}function ui(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=jt,n.pure?ne.push(n):fe.push(n),n.observers&&ui(n))}}function kt(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),i=n.observers;if(i&&i.length){const s=i.pop(),o=n.observerSlots.pop();r<i.length&&(s.sourceSlots[o]=r,i[r]=s,n.observerSlots[r]=o)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)kt(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)kt(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function Ft(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function xr(e,t,n){try{for(const r of t)r(e)}catch(r){Mt(r,n&&n.owner||null)}}function Mt(e,t=F){const n=bt&&t&&t.context&&t.context[bt],r=Ft(e);if(!n)throw r;fe?fe.push({fn(){xr(r,n,t)},state:he}):xr(r,n,t)}function Fn(e){if(typeof e=="function"&&!e.length)return Fn(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const r=Fn(e[n]);Array.isArray(r)?t.push.apply(t,r):t.push(r)}return t}return e}function Rs(e,t){return function(r){let i;return J(()=>i=X(()=>(F.context={...F.context,[e]:r.value},fn(()=>r.children))),void 0),i}}const xs=Symbol("fallback");function Mr(e){for(let t=0;t<e.length;t++)e[t]()}function Ms(e,t,n={}){let r=[],i=[],s=[],o=0,l=t.length>1?[]:null;return Re(()=>Mr(s)),()=>{let a=e()||[],c=a.length,f,u;return a[Dn],X(()=>{let p,b,h,_,E,v,j,O,R;if(c===0)o!==0&&(Mr(s),s=[],r=[],i=[],o=0,l&&(l=[])),n.fallback&&(r=[xs],i[0]=ot(G=>(s[0]=G,n.fallback())),o=1);else if(o===0){for(i=new Array(c),u=0;u<c;u++)r[u]=a[u],i[u]=ot(d);o=c}else{for(h=new Array(c),_=new Array(c),l&&(E=new Array(c)),v=0,j=Math.min(o,c);v<j&&r[v]===a[v];v++);for(j=o-1,O=c-1;j>=v&&O>=v&&r[j]===a[O];j--,O--)h[O]=i[j],_[O]=s[j],l&&(E[O]=l[j]);for(p=new Map,b=new Array(O+1),u=O;u>=v;u--)R=a[u],f=p.get(R),b[u]=f===void 0?-1:f,p.set(R,u);for(f=v;f<=j;f++)R=r[f],u=p.get(R),u!==void 0&&u!==-1?(h[u]=i[f],_[u]=s[f],l&&(E[u]=l[f]),u=b[u],p.set(R,u)):s[f]();for(u=v;u<c;u++)u in h?(i[u]=h[u],s[u]=_[u],l&&(l[u]=E[u],l[u](u))):i[u]=ot(d);i=i.slice(0,o=c),r=a.slice(0)}return i});function d(p){if(s[u]=p,l){const[b,h]=T(u);return l[u]=h,t(a[u],b)}return t(a[u])}}}function m(e,t){return X(()=>e(t||{}))}function It(){return!0}const Bn={get(e,t,n){return t===we?n:e.get(t)},has(e,t){return t===we?!0:e.has(t)},set:It,deleteProperty:It,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:It,deleteProperty:It}},ownKeys(e){return e.keys()}};function Sn(e){return(e=typeof e=="function"?e():e)?e:{}}function Ls(){for(let e=0,t=this.length;e<t;++e){const n=this[e]();if(n!==void 0)return n}}function Te(...e){let t=!1;for(let o=0;o<e.length;o++){const l=e[o];t=t||!!l&&we in l,e[o]=typeof l=="function"?(t=!0,A(l)):l}if(ni&&t)return new Proxy({get(o){for(let l=e.length-1;l>=0;l--){const a=Sn(e[l])[o];if(a!==void 0)return a}},has(o){for(let l=e.length-1;l>=0;l--)if(o in Sn(e[l]))return!0;return!1},keys(){const o=[];for(let l=0;l<e.length;l++)o.push(...Object.keys(Sn(e[l])));return[...new Set(o)]}},Bn);const n={},r=Object.create(null);for(let o=e.length-1;o>=0;o--){const l=e[o];if(!l)continue;const a=Object.getOwnPropertyNames(l);for(let c=a.length-1;c>=0;c--){const f=a[c];if(f==="__proto__"||f==="constructor")continue;const u=Object.getOwnPropertyDescriptor(l,f);if(!r[f])r[f]=u.get?{enumerable:!0,configurable:!0,get:Ls.bind(n[f]=[u.get.bind(l)])}:u.value!==void 0?u:void 0;else{const d=n[f];d&&(u.get?d.push(u.get.bind(l)):u.value!==void 0&&d.push(()=>u.value))}}}const i={},s=Object.keys(r);for(let o=s.length-1;o>=0;o--){const l=s[o],a=r[l];a&&a.get?Object.defineProperty(i,l,a):i[l]=a?a.value:void 0}return i}function sr(e,...t){const n=t.length;if(ni&&we in e){const i=n>1?t.flat():t[0],s=t.map(o=>new Proxy({get(l){return o.includes(l)?e[l]:void 0},has(l){return o.includes(l)&&l in e},keys(){return o.filter(l=>l in e)}},Bn));return s.push(new Proxy({get(o){return i.includes(o)?void 0:e[o]},has(o){return i.includes(o)?!1:o in e},keys(){return Object.keys(e).filter(o=>!i.includes(o))}},Bn)),s}const r=[];for(let i=0;i<=n;i++)r[i]={};for(const i of Object.getOwnPropertyNames(e)){let s=n;for(let a=0;a<t.length;a++)if(t[a].includes(i)){s=a;break}const o=Object.getOwnPropertyDescriptor(e,i);!o.get&&!o.set&&o.enumerable&&o.writable&&o.configurable?r[s][i]=o.value:Object.defineProperty(r[s],i,o)}return r}function dn(e){let t,n;const r=i=>{const s=M.context;if(s){const[l,a]=T();M.count||(M.count=0),M.count++,(n||(n=e())).then(c=>{!M.done&&mt(s),M.count--,a(()=>c.default),mt()}),t=l}else if(!t){const[l]=si(()=>(n||(n=e())).then(a=>a.default));t=l}let o;return A(()=>(o=t())?X(()=>{if(!s||M.done)return o(i);const l=M.context;mt(s);const a=o(i);return mt(l),a}):"")};return r.preload=()=>n||((n=e()).then(i=>t=()=>i.default),n),r}const Ns=e=>`Stale read from <${e}>.`;function or(e){const t="fallback"in e&&{fallback:()=>e.fallback};return A(Ms(()=>e.each,e.children,t||void 0))}function ye(e){const t=e.keyed,n=A(()=>e.when,void 0,void 0),r=t?n:A(n,void 0,{equals:(i,s)=>!i==!s});return A(()=>{const i=r();if(i){const s=e.children;return typeof s=="function"&&s.length>0?X(()=>s(t?i:()=>{if(!X(r))throw Ns("Show");return n()})):s}return e.fallback},void 0,void 0)}const Ts=["allowfullscreen","async","alpha","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected","adauctionheaders","browsingtopics","credentialless","defaultchecked","defaultmuted","defaultselected","defer","disablepictureinpicture","disableremoteplayback","preservespitch","shadowrootclonable","shadowrootcustomelementregistry","shadowrootdelegatesfocus","shadowrootserializable","sharedstoragewritable"],Ds=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline","adAuctionHeaders","allowFullscreen","browsingTopics","defaultChecked","defaultMuted","defaultSelected","disablePictureInPicture","disableRemotePlayback","preservesPitch","shadowRootClonable","shadowRootCustomElementRegistry","shadowRootDelegatesFocus","shadowRootSerializable","sharedStorageWritable",...Ts]),Is=new Set(["innerHTML","textContent","innerText","children"]),Fs=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),Bs=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1},adauctionheaders:{$:"adAuctionHeaders",IFRAME:1},allowfullscreen:{$:"allowFullscreen",IFRAME:1},browsingtopics:{$:"browsingTopics",IMG:1},defaultchecked:{$:"defaultChecked",INPUT:1},defaultmuted:{$:"defaultMuted",AUDIO:1,VIDEO:1},defaultselected:{$:"defaultSelected",OPTION:1},disablepictureinpicture:{$:"disablePictureInPicture",VIDEO:1},disableremoteplayback:{$:"disableRemotePlayback",AUDIO:1,VIDEO:1},preservespitch:{$:"preservesPitch",AUDIO:1,VIDEO:1},shadowrootclonable:{$:"shadowRootClonable",TEMPLATE:1},shadowrootdelegatesfocus:{$:"shadowRootDelegatesFocus",TEMPLATE:1},shadowrootserializable:{$:"shadowRootSerializable",TEMPLATE:1},sharedstoragewritable:{$:"sharedStorageWritable",IFRAME:1,IMG:1}});function qs(e,t){const n=Bs[e];return typeof n=="object"?n[t]?n.$:void 0:n}const js=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),Ks=new Set(["altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","stop","svg","switch","symbol","text","textPath","tref","tspan","use","view","vkern"]),zs={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},ut=e=>A(()=>e());function Hs(e,t,n){let r=n.length,i=t.length,s=r,o=0,l=0,a=t[i-1].nextSibling,c=null;for(;o<i||l<s;){if(t[o]===n[l]){o++,l++;continue}for(;t[i-1]===n[s-1];)i--,s--;if(i===o){const f=s<r?l?n[l-1].nextSibling:n[s-l]:a;for(;l<s;)e.insertBefore(n[l++],f)}else if(s===l)for(;o<i;)(!c||!c.has(t[o]))&&t[o].remove(),o++;else if(t[o]===n[s-1]&&n[l]===t[i-1]){const f=t[--i].nextSibling;e.insertBefore(n[l++],t[o++].nextSibling),e.insertBefore(n[--s],f),t[i]=n[s]}else{if(!c){c=new Map;let u=l;for(;u<s;)c.set(n[u],u++)}const f=c.get(t[o]);if(f!=null)if(l<f&&f<s){let u=o,d=1,p;for(;++u<i&&u<s&&!((p=c.get(t[u]))==null||p!==f+d);)d++;if(d>f-l){const b=t[o];for(;l<f;)e.insertBefore(n[l++],b)}else e.replaceChild(n[l++],t[o++])}else o++;else t[o++].remove()}}}const Lr="_$DX_DELEGATE";function Us(e,t,n,r={}){let i;return ot(s=>{i=s,t===document?e():$(t,e(),t.firstChild?null:void 0,n)},r.owner),()=>{i(),t.textContent=""}}function L(e,t,n,r){let i;const s=()=>{const l=document.createElement("template");return l.innerHTML=e,l.content.firstChild},o=()=>(i||(i=s())).cloneNode(!0);return o.cloneNode=o,o}function xe(e,t=window.document){const n=t[Lr]||(t[Lr]=new Set);for(let r=0,i=e.length;r<i;r++){const s=e[r];n.has(s)||(n.add(s),t.addEventListener(s,Js))}}function vt(e,t,n){Je(e)||(n==null?e.removeAttribute(t):e.setAttribute(t,n))}function Ws(e,t,n,r){Je(e)||(r==null?e.removeAttributeNS(t,n):e.setAttributeNS(t,n,r))}function Gs(e,t,n){Je(e)||(n?e.setAttribute(t,""):e.removeAttribute(t))}function Vs(e,t){Je(e)||(t==null?e.removeAttribute("class"):e.className=t)}function We(e,t,n,r){if(r)Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n;else if(Array.isArray(n)){const i=n[0];e.addEventListener(t,n[0]=s=>i.call(e,n[1],s))}else e.addEventListener(t,n,typeof n!="function"&&n)}function Xs(e,t,n={}){const r=Object.keys(t||{}),i=Object.keys(n);let s,o;for(s=0,o=i.length;s<o;s++){const l=i[s];!l||l==="undefined"||t[l]||(Nr(e,l,!1),delete n[l])}for(s=0,o=r.length;s<o;s++){const l=r[s],a=!!t[l];!l||l==="undefined"||n[l]===a||!a||(Nr(e,l,!0),n[l]=a)}return n}function fi(e,t,n){if(!t)return n?vt(e,"style"):t;const r=e.style;if(typeof t=="string")return r.cssText=t;typeof n=="string"&&(r.cssText=n=void 0),n||(n={}),t||(t={});let i,s;for(s in n)t[s]==null&&r.removeProperty(s),delete n[s];for(s in t)i=t[s],i!==n[s]&&(r.setProperty(s,i),n[s]=i);return n}function Ze(e,t={},n,r){const i={};return r||J(()=>i.children=Ct(e,t.children,i.children)),J(()=>typeof t.ref=="function"&&De(t.ref,e)),J(()=>Qs(e,t,n,!0,i,!0)),i}function De(e,t,n){return X(()=>e(t,n))}function $(e,t,n,r){if(n!==void 0&&!r&&(r=[]),typeof t!="function")return Ct(e,t,r,n);J(i=>Ct(e,t(),i,n),r)}function Qs(e,t,n,r,i={},s=!1){t||(t={});for(const o in i)if(!(o in t)){if(o==="children")continue;i[o]=Tr(e,o,null,i[o],n,s,t)}for(const o in t){if(o==="children")continue;const l=t[o];i[o]=Tr(e,o,l,i[o],n,s,t)}}function Ys(e){let t,n;return!Je()||!(t=M.registry.get(n=eo()))?e():(M.completed&&M.completed.add(t),M.registry.delete(n),t)}function Je(e){return!!M.context&&!M.done&&(!e||e.isConnected)}function Zs(e){return e.toLowerCase().replace(/-([a-z])/g,(t,n)=>n.toUpperCase())}function Nr(e,t,n){const r=t.trim().split(/\s+/);for(let i=0,s=r.length;i<s;i++)e.classList.toggle(r[i],n)}function Tr(e,t,n,r,i,s,o){let l,a,c,f,u;if(t==="style")return fi(e,n,r);if(t==="classList")return Xs(e,n,r);if(n===r)return r;if(t==="ref")s||n(e);else if(t.slice(0,3)==="on:"){const d=t.slice(3);r&&e.removeEventListener(d,r,typeof r!="function"&&r),n&&e.addEventListener(d,n,typeof n!="function"&&n)}else if(t.slice(0,10)==="oncapture:"){const d=t.slice(10);r&&e.removeEventListener(d,r,!0),n&&e.addEventListener(d,n,!0)}else if(t.slice(0,2)==="on"){const d=t.slice(2).toLowerCase(),p=js.has(d);if(!p&&r){const b=Array.isArray(r)?r[0]:r;e.removeEventListener(d,b)}(p||n)&&(We(e,d,n,p),p&&xe([d]))}else if(t.slice(0,5)==="attr:")vt(e,t.slice(5),n);else if(t.slice(0,5)==="bool:")Gs(e,t.slice(5),n);else if((u=t.slice(0,5)==="prop:")||(c=Is.has(t))||!i&&((f=qs(t,e.tagName))||(a=Ds.has(t)))||(l=e.nodeName.includes("-")||"is"in o)){if(u)t=t.slice(5),a=!0;else if(Je(e))return n;t==="class"||t==="className"?Vs(e,n):l&&!a&&!c?e[Zs(t)]=n:e[f||t]=n}else{const d=i&&t.indexOf(":")>-1&&zs[t.split(":")[0]];d?Ws(e,d,t,n):vt(e,Fs[t]||t,n)}return n}function Js(e){if(M.registry&&M.events&&M.events.find(([a,c])=>c===e))return;let t=e.target;const n=`$$${e.type}`,r=e.target,i=e.currentTarget,s=a=>Object.defineProperty(e,"target",{configurable:!0,value:a}),o=()=>{const a=t[n];if(a&&!t.disabled){const c=t[`${n}Data`];if(c!==void 0?a.call(t,c,e):a.call(t,e),e.cancelBubble)return}return t.host&&typeof t.host!="string"&&!t.host._$host&&t.contains(e.target)&&s(t.host),!0},l=()=>{for(;o()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}}),M.registry&&!M.done&&(M.done=_$HY.done=!0),e.composedPath){const a=e.composedPath();s(a[0]);for(let c=0;c<a.length-2&&(t=a[c],!!o());c++){if(t._$host){t=t._$host,l();break}if(t.parentNode===i)break}}else l();s(r)}function Ct(e,t,n,r,i){const s=Je(e);if(s){!n&&(n=[...e.childNodes]);let a=[];for(let c=0;c<n.length;c++){const f=n[c];f.nodeType===8&&f.data.slice(0,2)==="!$"?f.remove():a.push(f)}n=a}for(;typeof n=="function";)n=n();if(t===n)return n;const o=typeof t,l=r!==void 0;if(e=l&&n[0]&&n[0].parentNode||e,o==="string"||o==="number"){if(s||o==="number"&&(t=t.toString(),t===n))return n;if(l){let a=n[0];a&&a.nodeType===3?a.data!==t&&(a.data=t):a=document.createTextNode(t),n=nt(e,n,r,a)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||o==="boolean"){if(s)return n;n=nt(e,n,r)}else{if(o==="function")return J(()=>{let a=t();for(;typeof a=="function";)a=a();n=Ct(e,a,n,r)}),()=>n;if(Array.isArray(t)){const a=[],c=n&&Array.isArray(n);if(qn(a,t,n,i))return J(()=>n=Ct(e,a,n,r,!0)),()=>n;if(s){if(!a.length)return n;if(r===void 0)return n=[...e.childNodes];let f=a[0];if(f.parentNode!==e)return n;const u=[f];for(;(f=f.nextSibling)!==r;)u.push(f);return n=u}if(a.length===0){if(n=nt(e,n,r),l)return n}else c?n.length===0?Dr(e,a,r):Hs(e,n,a):(n&&nt(e),Dr(e,a));n=a}else if(t.nodeType){if(s&&t.parentNode)return n=l?[t]:t;if(Array.isArray(n)){if(l)return n=nt(e,n,r,t);nt(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function qn(e,t,n,r){let i=!1;for(let s=0,o=t.length;s<o;s++){let l=t[s],a=n&&n[e.length],c;if(!(l==null||l===!0||l===!1))if((c=typeof l)=="object"&&l.nodeType)e.push(l);else if(Array.isArray(l))i=qn(e,l,a)||i;else if(c==="function")if(r){for(;typeof l=="function";)l=l();i=qn(e,Array.isArray(l)?l:[l],Array.isArray(a)?a:[a])||i}else e.push(l),i=!0;else{const f=String(l);a&&a.nodeType===3&&a.data===f?e.push(a):e.push(document.createTextNode(f))}}return i}function Dr(e,t,n=null){for(let r=0,i=t.length;r<i;r++)e.insertBefore(t[r],n)}function nt(e,t,n,r){if(n===void 0)return e.textContent="";const i=r||document.createTextNode("");if(t.length){let s=!1;for(let o=t.length-1;o>=0;o--){const l=t[o];if(i!==l){const a=l.parentNode===e;!s&&!o?a?e.replaceChild(i,l):e.insertBefore(i,n):a&&l.remove()}else s=!0}}else e.insertBefore(i,n);return[i]}function eo(){return M.getNextContextId()}const to=!1,no="http://www.w3.org/2000/svg";function di(e,t=!1,n=void 0){return t?document.createElementNS(no,e):document.createElement(e,{is:n})}function lr(e){const{useShadow:t}=e,n=document.createTextNode(""),r=()=>e.mount||document.body,i=Kt();let s,o=!!M.context;return be(()=>{o&&(Kt().user=o=!1),s||(s=cn(i,()=>A(()=>e.children)));const l=r();if(l instanceof HTMLHeadElement){const[a,c]=T(!1),f=()=>c(!0);ot(u=>$(l,()=>a()?u():s(),null)),Re(f)}else{const a=di(e.isSVG?"g":"div",e.isSVG),c=t&&a.attachShadow?a.attachShadow({mode:"open"}):a;Object.defineProperty(a,"_$host",{get(){return n.parentNode},configurable:!0}),$(c,s),l.appendChild(a),e.ref&&e.ref(a),Re(()=>l.removeChild(a))}},void 0,{render:!o}),n}function ro(e,t){const n=A(e);return A(()=>{const r=n();switch(typeof r){case"function":return X(()=>r(t));case"string":const i=Ks.has(r),s=M.context?Ys():di(r,i,X(()=>t.is));return Ze(s,t,i),s}})}function io(e){const[,t]=sr(e,["component"]);return ro(()=>e.component,t)}const so="modulepreload",oo=function(e){return"/"+e},Ir={},hn=function(t,n,r){let i=Promise.resolve();if(n&&n.length>0){let a=function(c){return Promise.all(c.map(f=>Promise.resolve(f).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");i=a(n.map(c=>{if(c=oo(c),c in Ir)return;Ir[c]=!0;const f=c.endsWith(".css"),u=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const d=document.createElement("link");if(d.rel=f?"stylesheet":so,f||(d.as="script"),d.crossOrigin="",d.href=c,l&&d.setAttribute("nonce",l),document.head.appendChild(d),f)return new Promise((p,b)=>{d.addEventListener("load",p),d.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return t().catch(s)})};function hi(){let e=new Set;function t(i){return e.add(i),()=>e.delete(i)}let n=!1;function r(i,s){if(n)return!(n=!1);const o={to:i,options:s,defaultPrevented:!1,preventDefault:()=>o.defaultPrevented=!0};for(const l of e)l.listener({...o,from:l.location,retry:a=>{a&&(n=!0),l.navigate(i,{...s,resolve:!1})}});return!o.defaultPrevented}return{subscribe:t,confirm:r}}let jn;function ar(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),jn=window.history.state._depth}ar();function lo(e){return{...e,_depth:window.history.state&&window.history.state._depth}}function ao(e,t){let n=!1;return()=>{const r=jn;ar();const i=r==null?null:jn-r;if(n){n=!1;return}i&&t(i)?(n=!0,window.history.go(-i)):e()}}const co=/^(?:[a-z0-9]+:)?\/\//i,uo=/^\/+|(\/)\/+$/g,pi="http://sr";function Ge(e,t=!1){const n=e.replace(uo,"$1");return n?t||/^[?#]/.test(n)?n:"/"+n:""}function Bt(e,t,n){if(co.test(t))return;const r=Ge(e),i=n&&Ge(n);let s="";return!i||t.startsWith("/")?s=r:i.toLowerCase().indexOf(r.toLowerCase())!==0?s=r+i:s=i,(s||"/")+Ge(t,!s)}function fo(e,t){if(e==null)throw new Error(t);return e}function ho(e,t){return Ge(e).replace(/\/*(\*.*)?$/g,"")+Ge(t)}function gi(e){const t={};return e.searchParams.forEach((n,r)=>{r in t?Array.isArray(t[r])?t[r].push(n):t[r]=[t[r],n]:t[r]=n}),t}function po(e,t,n){const[r,i]=e.split("/*",2),s=r.split("/").filter(Boolean),o=s.length;return l=>{const a=l.split("/").filter(Boolean),c=a.length-o;if(c<0||c>0&&i===void 0&&!t)return null;const f={path:o?"":"/",params:{}},u=d=>n===void 0?void 0:n[d];for(let d=0;d<o;d++){const p=s[d],b=p[0]===":",h=b?a[d]:a[d].toLowerCase(),_=b?p.slice(1):p.toLowerCase();if(b&&An(h,u(_)))f.params[_]=h;else if(b||!An(h,_))return null;f.path+=`/${h}`}if(i){const d=c?a.slice(-c).join("/"):"";if(An(d,u(i)))f.params[i]=d;else return null}return f}}function An(e,t){const n=r=>r===e;return t===void 0?!0:typeof t=="string"?n(t):typeof t=="function"?t(e):Array.isArray(t)?t.some(n):t instanceof RegExp?t.test(e):!1}function go(e){const[t,n]=e.pattern.split("/*",2),r=t.split("/").filter(Boolean);return r.reduce((i,s)=>i+(s.startsWith(":")?2:3),r.length-(n===void 0?0:1))}function mi(e){const t=new Map,n=Kt();return new Proxy({},{get(r,i){return t.has(i)||cn(n,()=>t.set(i,A(()=>e()[i]))),t.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(e())},has(r,i){return i in e()}})}function wi(e){let t=/(\/?\:[^\/]+)\?/.exec(e);if(!t)return[e];let n=e.slice(0,t.index),r=e.slice(t.index+t[0].length);const i=[n,n+=t[1]];for(;t=/^(\/\:[^\/]+)\?/.exec(r);)i.push(n+=t[1]),r=r.slice(t[0].length);return wi(r).reduce((s,o)=>[...s,...i.map(l=>l+o)],[])}const mo=100,bi=ir(),cr=ir(),ur=()=>fo(un(bi),"<A> and 'use' router primitives can be only used inside a Route."),wo=()=>un(cr)||ur().base,bo=e=>{const t=wo();return A(()=>t.resolvePath(e()))},yo=e=>{const t=ur();return A(()=>{const n=e();return n!==void 0?t.renderPath(n):n})},_o=()=>ur().location;function ko(e,t=""){const{component:n,preload:r,load:i,children:s,info:o}=e,l=!s||Array.isArray(s)&&!s.length,a={key:e,component:n,preload:r||i,info:o};return yi(e.path).reduce((c,f)=>{for(const u of wi(f)){const d=ho(t,u);let p=l?d:d.split("/*",1)[0];p=p.split("/").map(b=>b.startsWith(":")||b.startsWith("*")?b:encodeURIComponent(b)).join("/"),c.push({...a,originalPath:f,pattern:p,matcher:po(p,!l,e.matchFilters)})}return c},[])}function vo(e,t=0){return{routes:e,score:go(e[e.length-1])*1e4-t,matcher(n){const r=[];for(let i=e.length-1;i>=0;i--){const s=e[i],o=s.matcher(n);if(!o)return null;r.unshift({...o,route:s})}return r}}}function yi(e){return Array.isArray(e)?e:[e]}function _i(e,t="",n=[],r=[]){const i=yi(e);for(let s=0,o=i.length;s<o;s++){const l=i[s];if(l&&typeof l=="object"){l.hasOwnProperty("path")||(l.path="");const a=ko(l,t);for(const c of a){n.push(c);const f=Array.isArray(l.children)&&l.children.length===0;if(l.children&&!f)_i(l.children,c.pattern,n,r);else{const u=vo([...n],r.length);r.push(u)}n.pop()}}}return n.length?r:r.sort((s,o)=>o.score-s.score)}function On(e,t){for(let n=0,r=e.length;n<r;n++){const i=e[n].matcher(t);if(i)return i}return[]}function Co(e,t,n){const r=new URL(pi),i=A(f=>{const u=e();try{return new URL(u,r)}catch{return console.error(`Invalid path ${u}`),f}},r,{equals:(f,u)=>f.href===u.href}),s=A(()=>i().pathname),o=A(()=>i().search,!0),l=A(()=>i().hash),a=()=>"",c=an(o,()=>gi(i()));return{get pathname(){return s()},get search(){return o()},get hash(){return l()},get state(){return t()},get key(){return a()},query:n?n(c):mi(c)}}let ze;function Po(){return ze}function $o(e,t,n,r={}){const{signal:[i,s],utils:o={}}=e,l=o.parsePath||(x=>x),a=o.renderPath||(x=>x),c=o.beforeLeave||hi(),f=Bt("",r.base||"");if(f===void 0)throw new Error(`${f} is not a valid base path`);f&&!i().value&&s({value:f,replace:!0,scroll:!1});const[u,d]=T(!1);let p;const b=(x,w)=>{w.value===h()&&w.state===E()||(p===void 0&&d(!0),ze=x,p=w,$s(()=>{p===w&&(_(p.value),v(p.state),R[1](C=>C.filter(B=>B.pending)))}).finally(()=>{p===w&&ln(()=>{ze=void 0,x==="navigate"&&k(p),d(!1),p=void 0})}))},[h,_]=T(i().value),[E,v]=T(i().state),j=Co(h,E,o.queryWrapper),O=[],R=T([]),G=A(()=>typeof r.transformUrl=="function"?On(t(),r.transformUrl(j.pathname)):On(t(),j.pathname)),U=()=>{const x=G(),w={};for(let C=0;C<x.length;C++)Object.assign(w,x[C].params);return w},D=o.paramsWrapper?o.paramsWrapper(U,t):mi(U),Y={pattern:f,path:()=>f,outlet:()=>null,resolvePath(x){return Bt(f,x)}};return J(an(i,x=>b("native",x),{defer:!0})),{base:Y,location:j,params:D,isRouting:u,renderPath:a,parsePath:l,navigatorFactory:y,matches:G,beforeLeave:c,preloadRoute:P,singleFlight:r.singleFlight===void 0?!0:r.singleFlight,submissions:R};function q(x,w,C){X(()=>{if(typeof w=="number"){w&&(o.go?o.go(w):console.warn("Router integration does not support relative routing"));return}const B=!w||w[0]==="?",{replace:I,resolve:K,scroll:W,state:ie}={replace:!1,resolve:!B,scroll:!0,...C},Ee=K?x.resolvePath(w):Bt(B&&j.pathname||"",w);if(Ee===void 0)throw new Error(`Path '${w}' is not a routable path`);if(O.length>=mo)throw new Error("Too many redirects");const Or=h();(Ee!==Or||ie!==E())&&(to||c.confirm(Ee,C)&&(O.push({value:Or,replace:I,scroll:W,state:E()}),b("navigate",{value:Ee,state:ie})))})}function y(x){return x=x||un(cr)||Y,(w,C)=>q(x,w,C)}function k(x){const w=O[0];w&&(s({...x,replace:w.replace,scroll:w.scroll}),O.length=0)}function P(x,w){const C=On(t(),x.pathname),B=ze;ze="preload";for(let I in C){const{route:K,params:W}=C[I];K.component&&K.component.preload&&K.component.preload();const{preload:ie}=K;w&&ie&&cn(n(),()=>ie({params:W,location:{pathname:x.pathname,search:x.search,hash:x.hash,query:gi(x),state:null,key:""},intent:"preload"}))}ze=B}}function Eo(e,t,n,r){const{base:i,location:s,params:o}=e,{pattern:l,component:a,preload:c}=r().route,f=A(()=>r().path);a&&a.preload&&a.preload();const u=c?c({params:o,location:s,intent:ze||"initial"}):void 0;return{parent:t,pattern:l,path:f,outlet:()=>a?m(a,{params:o,location:s,data:u,get children(){return n()}}):n(),resolvePath(p){return Bt(i.path(),p,f())}}}const So=e=>t=>{const{base:n}=t,r=fn(()=>t.children),i=A(()=>_i(r(),t.base||""));let s;const o=$o(e,i,()=>s,{base:n,singleFlight:t.singleFlight,transformUrl:t.transformUrl});return e.create&&e.create(o),m(bi.Provider,{value:o,get children(){return m(Ao,{routerState:o,get root(){return t.root},get preload(){return t.rootPreload||t.rootLoad},get children(){return[ut(()=>(s=Kt())&&null),m(Oo,{routerState:o,get branches(){return i()}})]}})}})};function Ao(e){const t=e.routerState.location,n=e.routerState.params,r=A(()=>e.preload&&X(()=>{e.preload({params:n,location:t,intent:Po()||"initial"})}));return m(ye,{get when(){return e.root},keyed:!0,get fallback(){return e.children},children:i=>m(i,{params:n,location:t,get data(){return r()},get children(){return e.children}})})}function Oo(e){const t=[];let n;const r=A(an(e.routerState.matches,(i,s,o)=>{let l=s&&i.length===s.length;const a=[];for(let c=0,f=i.length;c<f;c++){const u=s&&s[c],d=i[c];o&&u&&d.route.key===u.route.key?a[c]=o[c]:(l=!1,t[c]&&t[c](),ot(p=>{t[c]=p,a[c]=Eo(e.routerState,a[c-1]||e.routerState.base,Fr(()=>r()[c+1]),()=>{const b=e.routerState.matches();return b[c]??b[0]})}))}return t.splice(i.length).forEach(c=>c()),o&&l?o:(n=a[0],a)}));return Fr(()=>r()&&n)()}const Fr=e=>()=>m(ye,{get when(){return e()},keyed:!0,children:t=>m(cr.Provider,{value:t,get children(){return t.outlet()}})}),dt=e=>{const t=fn(()=>e.children);return Te(e,{get children(){return t()}})};function Ro([e,t],n,r){return[e,r?i=>t(r(i)):t]}function xo(e){let t=!1;const n=i=>typeof i=="string"?{value:i}:i,r=Ro(T(n(e.get()),{equals:(i,s)=>i.value===s.value&&i.state===s.state}),void 0,i=>(!t&&e.set(i),M.registry&&!M.done&&(M.done=!0),i));return e.init&&Re(e.init((i=e.get())=>{t=!0,r[1](n(i)),t=!1})),So({signal:r,create:e.create,utils:e.utils})}function Mo(e,t,n){return e.addEventListener(t,n),()=>e.removeEventListener(t,n)}function Lo(e,t){const n=e&&document.getElementById(e);n?n.scrollIntoView():t&&window.scrollTo(0,0)}const No=new Map;function To(e=!0,t=!1,n="/_server",r){return i=>{const s=i.base.path(),o=i.navigatorFactory(i.base);let l,a;function c(h){return h.namespaceURI==="http://www.w3.org/2000/svg"}function f(h){if(h.defaultPrevented||h.button!==0||h.metaKey||h.altKey||h.ctrlKey||h.shiftKey)return;const _=h.composedPath().find(G=>G instanceof Node&&G.nodeName.toUpperCase()==="A");if(!_||t&&!_.hasAttribute("link"))return;const E=c(_),v=E?_.href.baseVal:_.href;if((E?_.target.baseVal:_.target)||!v&&!_.hasAttribute("state"))return;const O=(_.getAttribute("rel")||"").split(/\s+/);if(_.hasAttribute("download")||O&&O.includes("external"))return;const R=E?new URL(v,document.baseURI):new URL(v);if(!(R.origin!==window.location.origin||s&&R.pathname&&!R.pathname.toLowerCase().startsWith(s.toLowerCase())))return[_,R]}function u(h){const _=f(h);if(!_)return;const[E,v]=_,j=i.parsePath(v.pathname+v.search+v.hash),O=E.getAttribute("state");h.preventDefault(),o(j,{resolve:!1,replace:E.hasAttribute("replace"),scroll:!E.hasAttribute("noscroll"),state:O?JSON.parse(O):void 0})}function d(h){const _=f(h);if(!_)return;const[E,v]=_;r&&(v.pathname=r(v.pathname)),i.preloadRoute(v,E.getAttribute("preload")!=="false")}function p(h){clearTimeout(l);const _=f(h);if(!_)return a=null;const[E,v]=_;a!==E&&(r&&(v.pathname=r(v.pathname)),l=setTimeout(()=>{i.preloadRoute(v,E.getAttribute("preload")!=="false"),a=E},20))}function b(h){if(h.defaultPrevented)return;let _=h.submitter&&h.submitter.hasAttribute("formaction")?h.submitter.getAttribute("formaction"):h.target.getAttribute("action");if(!_)return;if(!_.startsWith("https://action/")){const v=new URL(_,pi);if(_=i.parsePath(v.pathname+v.search),!_.startsWith(n))return}if(h.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const E=No.get(_);if(E){h.preventDefault();const v=new FormData(h.target,h.submitter);E.call({r:i,f:h.target},h.target.enctype==="multipart/form-data"?v:new URLSearchParams(v))}}xe(["click","submit"]),document.addEventListener("click",u),e&&(document.addEventListener("mousemove",p,{passive:!0}),document.addEventListener("focusin",d,{passive:!0}),document.addEventListener("touchstart",d,{passive:!0})),document.addEventListener("submit",b),Re(()=>{document.removeEventListener("click",u),e&&(document.removeEventListener("mousemove",p),document.removeEventListener("focusin",d),document.removeEventListener("touchstart",d)),document.removeEventListener("submit",b)})}}function Do(e){const t=()=>{const r=window.location.pathname.replace(/^\/+/,"/")+window.location.search,i=window.history.state&&window.history.state._depth&&Object.keys(window.history.state).length===1?void 0:window.history.state;return{value:r+window.location.hash,state:i}},n=hi();return xo({get:t,set({value:r,replace:i,scroll:s,state:o}){i?window.history.replaceState(lo(o),"",r):window.history.pushState(o,"",r),Lo(decodeURIComponent(window.location.hash.slice(1)),s),ar()},init:r=>Mo(window,"popstate",ao(r,i=>{if(i)return!n.confirm(i);{const s=t();return!n.confirm(s.value,{state:s.state})}})),create:To(e.preload,e.explicitLinks,e.actionBase,e.transformUrl),utils:{go:r=>window.history.go(r),beforeLeave:n}})(e)}var Io=L("<a>");function rt(e){e=Te({inactiveClass:"inactive",activeClass:"active"},e);const[,t]=sr(e,["href","state","class","activeClass","inactiveClass","end"]),n=bo(()=>e.href),r=yo(n),i=_o(),s=A(()=>{const o=n();if(o===void 0)return[!1,!1];const l=Ge(o.split(/[?#]/,1)[0]).toLowerCase(),a=decodeURI(Ge(i.pathname).toLowerCase());return[e.end?l===a:a.startsWith(l+"/")||a===l,l===a]});return(()=>{var o=Io();return Ze(o,Te(t,{get href(){return r()||e.href},get state(){return JSON.stringify(e.state)},get classList(){return{...e.class&&{[e.class]:!0},[e.inactiveClass]:!s()[0],[e.activeClass]:s()[0],...t.classList}},link:"",get"aria-current"(){return s()[1]?"page":void 0}}),!1,!1),o})()}const Kn=Symbol("store-raw"),lt=Symbol("store-node"),Ae=Symbol("store-has"),ki=Symbol("store-self");function vi(e){let t=e[we];if(!t&&(Object.defineProperty(e,we,{value:t=new Proxy(e,qo)}),!Array.isArray(e))){const n=Object.keys(e),r=Object.getOwnPropertyDescriptors(e);for(let i=0,s=n.length;i<s;i++){const o=n[i];r[o].get&&Object.defineProperty(e,o,{enumerable:r[o].enumerable,get:r[o].get.bind(t)})}}return t}function Ut(e){let t;return e!=null&&typeof e=="object"&&(e[we]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function Pt(e,t=new Set){let n,r,i,s;if(n=e!=null&&e[Kn])return n;if(!Ut(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let o=0,l=e.length;o<l;o++)i=e[o],(r=Pt(i,t))!==i&&(e[o]=r)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const o=Object.keys(e),l=Object.getOwnPropertyDescriptors(e);for(let a=0,c=o.length;a<c;a++)s=o[a],!l[s].get&&(i=e[s],(r=Pt(i,t))!==i&&(e[s]=r))}return e}function Wt(e,t){let n=e[t];return n||Object.defineProperty(e,t,{value:n=Object.create(null)}),n}function $t(e,t,n){if(e[t])return e[t];const[r,i]=T(n,{equals:!1,internal:!0});return r.$=i,e[t]=r}function Fo(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||!n.configurable||t===we||t===lt||(delete n.value,delete n.writable,n.get=()=>e[we][t]),n}function Ci(e){In()&&$t(Wt(e,lt),ki)()}function Bo(e){return Ci(e),Reflect.ownKeys(e)}const qo={get(e,t,n){if(t===Kn)return e;if(t===we)return n;if(t===Dn)return Ci(e),n;const r=Wt(e,lt),i=r[t];let s=i?i():e[t];if(t===lt||t===Ae||t==="__proto__")return s;if(!i){const o=Object.getOwnPropertyDescriptor(e,t);In()&&(typeof s!="function"||e.hasOwnProperty(t))&&!(o&&o.get)&&(s=$t(r,t,s)())}return Ut(s)?vi(s):s},has(e,t){return t===Kn||t===we||t===Dn||t===lt||t===Ae||t==="__proto__"?!0:(In()&&$t(Wt(e,Ae),t)(),t in e)},set(){return!0},deleteProperty(){return!0},ownKeys:Bo,getOwnPropertyDescriptor:Fo};function Gt(e,t,n,r=!1){if(!r&&e[t]===n)return;const i=e[t],s=e.length;n===void 0?(delete e[t],e[Ae]&&e[Ae][t]&&i!==void 0&&e[Ae][t].$()):(e[t]=n,e[Ae]&&e[Ae][t]&&i===void 0&&e[Ae][t].$());let o=Wt(e,lt),l;if((l=$t(o,t,i))&&l.$(()=>n),Array.isArray(e)&&e.length!==s){for(let a=e.length;a<s;a++)(l=o[a])&&l.$();(l=$t(o,"length",s))&&l.$(e.length)}(l=o[ki])&&l.$()}function Pi(e,t){const n=Object.keys(t);for(let r=0;r<n.length;r+=1){const i=n[r];Gt(e,i,t[i])}}function jo(e,t){if(typeof t=="function"&&(t=t(e)),t=Pt(t),Array.isArray(t)){if(e===t)return;let n=0,r=t.length;for(;n<r;n++){const i=t[n];e[n]!==i&&Gt(e,n,i)}Gt(e,"length",r)}else Pi(e,t)}function wt(e,t,n=[]){let r,i=e;if(t.length>1){r=t.shift();const o=typeof r,l=Array.isArray(e);if(Array.isArray(r)){for(let a=0;a<r.length;a++)wt(e,[r[a]].concat(t),n);return}else if(l&&o==="function"){for(let a=0;a<e.length;a++)r(e[a],a)&&wt(e,[a].concat(t),n);return}else if(l&&o==="object"){const{from:a=0,to:c=e.length-1,by:f=1}=r;for(let u=a;u<=c;u+=f)wt(e,[u].concat(t),n);return}else if(t.length>1){wt(e[r],t,[r].concat(n));return}i=e[r],n=[r].concat(n)}let s=t[0];typeof s=="function"&&(s=s(i,n),s===i)||r===void 0&&s==null||(s=Pt(s),r===void 0||Ut(i)&&Ut(s)&&!Array.isArray(s)?Pi(i,s):Gt(e,r,s))}function Ko(...[e,t]){const n=Pt(e||{}),r=Array.isArray(n),i=vi(n);function s(...o){ln(()=>{r&&o.length===1?jo(n,o[0]):wt(n,o)})}return[i,s]}function qe(e,t){let n,r=()=>!n||n.state==="unresolved"?void 0:n.latest;[n]=si(()=>zo(e,Ps(()=>X(r),()=>{})),s=>s);const i=(()=>n());return Object.defineProperty(i,"latest",{get(){return n.latest}}),i}class ue{static all(){return new ue}static allSettled(){return new ue}static any(){return new ue}static race(){return new ue}static reject(){return new ue}static resolve(){return new ue}catch(){return new ue}then(){return new ue}finally(){return new ue}}function zo(e,t){if(!M.context)return e(t);const n=fetch,r=Promise;try{return window.fetch=()=>new ue,Promise=ue,e(t)}finally{window.fetch=n,Promise=r}}const Ho=["white","black"],Vt=["a","b","c","d","e","f","g","h"],Xt=["1","2","3","4","5","6","7","8"],Uo=[...Xt].reverse(),pn=Vt.flatMap(e=>Xt.map(t=>e+t)),Pe=e=>e.every(t=>t>=0&&t<=7)?pn[8*e[0]+e[1]]:void 0,je=e=>Pe(e),z=e=>[e.charCodeAt(0)-97,e.charCodeAt(1)-49],$i=pn.map(z),Wo=pn.map((e,t)=>({key:e,pos:$i[t]}));function Ei(e){let t;const n=()=>(t===void 0&&(t=e()),t);return n.clear=()=>{t=void 0},n}const Go=()=>{let e;return{start(){e=performance.now()},cancel(){e=void 0},stop(){if(!e)return 0;const t=performance.now()-e;return e=void 0,t}}},gn=e=>e==="white"?"black":"white",Et=(e,t)=>(e[0]-t[0])**2+(e[1]-t[1])**2,Qt=(e,t)=>e.role===t.role&&e.color===t.color,Vo=(e,t)=>e[0]===t[0]&&e[1]===t[1],Lt=e=>(t,n)=>[(n?t[0]:7-t[0])*e.width/8,(n?7-t[1]:t[1])*e.height/8],_e=(e,t)=>{e.style.transform=`translate(${t[0]}px,${t[1]}px)`},Si=(e,t,n=1)=>{e.style.transform=`translate(${t[0]}px,${t[1]}px) scale(${n})`},fr=(e,t)=>{e.style.visibility=t?"visible":"hidden"},et=e=>{if(e.clientX||e.clientX===0)return[e.clientX,e.clientY];if(e.targetTouches?.[0])return[e.targetTouches[0].clientX,e.targetTouches[0].clientY]},Xo=Ei(()=>!("ontouchstart"in window)&&["macintosh","firefox"].every(e=>navigator.userAgent.toLowerCase().includes(e))),Ai=e=>e.button===2&&!(e.ctrlKey&&Xo()),Oe=(e,t)=>{const n=document.createElement(e);return t&&(n.className=t),n};function Oi(e,t,n){const r=z(e);return t||(r[0]=7-r[0],r[1]=7-r[1]),[n.left+n.width*r[0]/8+n.width/16,n.top+n.height*(7-r[1])/8+n.height/16]}const $e=(e,t)=>Math.abs(e-t),dr=(e,t,n,r)=>$e(e,n)*$e(t,r)===2,hr=(e,t,n,r)=>e===n!=(t===r),pr=(e,t,n,r)=>$e(e,n)===$e(t,r)&&e!==n,Ri=(e,t,n,r)=>hr(e,t,n,r)||pr(e,t,n,r),xi=(e,t,n,r)=>Math.max($e(e,n),$e(t,r))===1,Mi=(e,t,n,r,i)=>$e(e,n)===1&&r===t+(i?1:-1),Li=(e,t,n,r,i)=>{const s=i?1:-1;return e===n&&(r===t+s||r===t+2*s&&(i?t<=1:t>=6))},mn=(e,t,n,r)=>{const i=n-e,s=r-t;if(i&&s&&Math.abs(i)!==Math.abs(s))return[];const o=Math.sign(i),l=Math.sign(s),a=[];let c=e+o,f=t+l;for(;c!==n||f!==r;)a.push([c,f]),c+=o,f+=l;return a.map(Pe).filter(u=>u!==void 0)},Qo=e=>{const t=z(e),n=[];return t[0]>0&&n.push([t[0]-1,t[1]]),t[0]<7&&n.push([t[0]+1,t[1]]),n.map(Pe).filter(r=>r!==void 0)},Yt=(e,t)=>{const n=z(e);return n[1]+=t,Pe(n)},ft=e=>e.friendlies.has(e.dest.key),Yo=e=>e.enemies.has(e.dest.key),Ni=(e,t,n)=>mn(...e,...t).some(r=>n.has(r)),Ti=(e,t,n)=>{const r=n.enemies.get(e);if(r?.role!=="pawn")return!1;const i=r.color==="white"?1:-1,s=z(e),o=z(t);return Li(...s,...o,r.color==="white")&&!Ni(s,[o[0],o[1]+i],n.allPieces)},Zo=(e,t,n)=>{const r=n.enemies.get(e);return r?.role==="pawn"&&Mi(...z(e),...z(t),r.color==="white")&&(n.friendlies.has(t)||bn(Yt(t,r.color==="white"?-1:1),n.friendlies,n.enemies,n.lastMove))},Jo=e=>[...e.enemies.keys()].some(t=>Ti(t,e.dest.key,e)),zn=(e,t)=>{const n=e.dest.pos;return[...e.enemies].some(([r,i])=>{const s=z(r);return!t?.includes(i.role)&&(i.role==="pawn"&&Mi(...s,...n,i.color==="white")||i.role==="knight"&&dr(...s,...n)||i.role==="bishop"&&pr(...s,...n)||i.role==="rook"&&hr(...s,...n)||i.role==="queen"&&Ri(...s,...n)||i.role==="king"&&xi(...s,...n))&&(!["bishop","rook","queen"].includes(i.role)||!Ni(s,n,e.allPieces))})},wn=e=>ft(e)&&(bn(e.dest.key,e.friendlies,e.enemies,e.lastMove)||zn(e)),bn=(e,t,n,r)=>{if(!e||r&&e!==r[1])return!1;const i=z(e),s=t.get(e);return s?.role==="pawn"&&i[1]===(s.color==="white"?3:4)&&(!r||$e(z(r[0])[1],i[1])===2)&&[1,-1].some(o=>{const l=Pe([i[0]+o,i[1]]);return!!l&&n.get(l)?.role==="pawn"})},el=(e,t)=>{if(e.unrestrictedPremoves)return!0;const n=mn(...e.orig.pos,...e.dest.pos);t&&n.push(e.dest.key);const r=n.filter(o=>e.friendlies.has(o));if(!r.length)return!0;const i=r[0],s=Yt(i,e.color==="white"?-1:1);return r.length===1&&bn(i,e.friendlies,e.enemies,e.lastMove)&&!!s&&!n.includes(s)},tl=(e,t)=>{if(e.unrestrictedPremoves)return!0;const n=mn(...e.orig.pos,...e.dest.pos);t&&n.push(e.dest.key);const r=n.filter(f=>e.enemies.has(f));if(r.length>1)return!1;if(!r.length)return!0;const i=r[0],s=e.enemies.get(i);if(!s||s.role!=="pawn")return!0;const o=s.color==="white"?1:-1,l=Yt(i,o),a=l?[...Qo(l).filter(f=>Zo(i,f,e)),...[l,Yt(l,o)].filter(f=>!!f).filter(f=>Ti(i,f,e))]:[],c=[...n,e.orig.key];return a.some(f=>!c.includes(f))},gr=(e,t)=>el(e,t)&&tl(e,t),nl=e=>{const t=e.color==="white"?1:-1;return $e(e.orig.pos[0],e.dest.pos[0])>1?!1:$e(e.orig.pos[0],e.dest.pos[0])?e.dest.pos[1]!==e.orig.pos[1]+t?!1:e.unrestrictedPremoves||Yo(e)?!0:ft(e)?zn(e):Jo(e)||bn(Pe([e.dest.pos[0],e.dest.pos[1]+t]),e.friendlies,e.enemies,e.lastMove)||zn(e,["pawn"]):Li(...e.orig.pos,...e.dest.pos,e.color==="white")&&gr(e,!0)},rl=e=>dr(...e.orig.pos,...e.dest.pos)&&(e.unrestrictedPremoves||!ft(e)||wn(e)),Di=e=>pr(...e.orig.pos,...e.dest.pos)&&gr(e,!1)&&(e.unrestrictedPremoves||!ft(e)||wn(e)),Ii=e=>hr(...e.orig.pos,...e.dest.pos)&&gr(e,!1)&&(e.unrestrictedPremoves||!ft(e)||wn(e)),il=e=>Di(e)||Ii(e),sl=e=>xi(...e.orig.pos,...e.dest.pos)&&(e.unrestrictedPremoves||!ft(e)||wn(e))||e.canCastle&&e.orig.pos[1]===e.dest.pos[1]&&e.orig.pos[1]===(e.color==="white"?0:7)&&(e.orig.pos[0]===4&&(e.dest.pos[0]===2&&e.rookFilesFriendlies.includes(0)||e.dest.pos[0]===6&&e.rookFilesFriendlies.includes(7))||e.rookFilesFriendlies.includes(e.dest.pos[0]))&&(e.unrestrictedPremoves||mn(...e.orig.pos,e.dest.pos[0]>e.orig.pos[0]?7:1,e.dest.pos[1]).map(t=>e.allPieces.get(t)).every(t=>!t||Qt(t,{role:"rook",color:e.color}))),ol={pawn:nl,knight:rl,bishop:Di,rook:Ii,queen:il,king:sl};function Fi(e,t){const n=e.pieces,r=e.premovable.castle,i=!!e.premovable.unrestrictedPremoves,s=n.get(t);if(!s||s.color===e.turnColor)return[];const o=s.color,l=new Map([...n].filter(([d,p])=>p.color===o)),a=new Map([...n].filter(([d,p])=>p.color===gn(o))),c={key:t,pos:z(t)},f=d=>ol[s.role](d)&&e.premovable.additionalPremoveRequirements(d),u={orig:c,role:s.role,allPieces:n,friendlies:l,enemies:a,unrestrictedPremoves:i,color:o,canCastle:r,rookFilesFriendlies:Array.from(n).filter(([d,p])=>d[1]===(o==="white"?"1":"8")&&p.color===o&&p.role==="rook").map(([d])=>z(d)[0]),lastMove:e.lastMove};return Wo.filter(d=>f({...u,dest:d})).map(d=>d.key)}function le(e,...t){e&&setTimeout(()=>e(...t),1)}function ll(e){e.orientation=gn(e.orientation),e.animation.current=e.draggable.current=e.selected=void 0}function al(e,t){for(const[n,r]of t)r?e.pieces.set(n,r):e.pieces.delete(n)}function cl(e,t){if(e.check=void 0,t===!0&&(t=e.turnColor),t)for(const[n,r]of e.pieces)r.role==="king"&&r.color===t&&(e.check=n)}function ul(e,t,n,r){Be(e),e.premovable.current=[t,n],le(e.premovable.events.set,t,n,r)}function Fe(e){e.premovable.current&&(e.premovable.current=void 0,le(e.premovable.events.unset))}function fl(e,t,n){Fe(e),e.predroppable.current={role:t,key:n},le(e.predroppable.events.set,t,n)}function Be(e){const t=e.predroppable;t.current&&(t.current=void 0,le(t.events.unset))}function dl(e,t,n){if(!e.autoCastle)return!1;const r=e.pieces.get(t);if(!r||r.role!=="king")return!1;const i=z(t),s=z(n);if(i[1]!==0&&i[1]!==7||i[1]!==s[1])return!1;i[0]===4&&!e.pieces.has(n)&&(s[0]===6?n=je([7,s[1]]):s[0]===2&&(n=je([0,s[1]])));const o=e.pieces.get(n);return!o||o.color!==r.color||o.role!=="rook"?!1:(e.pieces.delete(t),e.pieces.delete(n),i[0]<s[0]?(e.pieces.set(je([6,s[1]]),r),e.pieces.set(je([5,s[1]]),o)):(e.pieces.set(je([2,s[1]]),r),e.pieces.set(je([3,s[1]]),o)),!0)}function Bi(e,t,n){const r=e.pieces.get(t),i=e.pieces.get(n);if(t===n||!r)return!1;const s=i&&i.color!==r.color?i:void 0;return n===e.selected&&de(e),le(e.events.move,t,n,s),dl(e,t,n)||(e.pieces.set(n,r),e.pieces.delete(t)),e.lastMove=[t,n],e.check=void 0,le(e.events.change),s||!0}function mr(e,t,n,r){if(e.pieces.has(n))if(r)e.pieces.delete(n);else return!1;return le(e.events.dropNewPiece,t,n),e.pieces.set(n,t),e.lastMove=[n],e.check=void 0,le(e.events.change),e.movable.dests=void 0,e.turnColor=gn(e.turnColor),!0}function qi(e,t,n){const r=Bi(e,t,n);return r&&(e.movable.dests=void 0,e.turnColor=gn(e.turnColor),e.animation.current=void 0),r}function ji(e,t,n){if(wr(e,t,n)){const r=qi(e,t,n);if(r){const i=e.hold.stop();de(e);const s={premove:!1,ctrlKey:e.stats.ctrlKey,holdTime:i};return r!==!0&&(s.captured=r),le(e.movable.events.after,t,n,s),!0}}else if(pl(e,t,n))return ul(e,t,n,{ctrlKey:e.stats.ctrlKey}),de(e),!0;return de(e),!1}function Ki(e,t,n,r){const i=e.pieces.get(t);i&&(hl(e,t,n)||r)?(e.pieces.delete(t),mr(e,i,n,r),le(e.movable.events.afterNewPiece,i.role,n,{premove:!1,predrop:!1})):i&&gl(e,t,n)?fl(e,i.role,n):(Fe(e),Be(e)),e.pieces.delete(t),de(e)}function Hn(e,t,n){if(le(e.events.select,t),e.selected){if(e.selected===t&&!e.draggable.enabled){de(e),e.hold.cancel();return}else if((e.selectable.enabled||n)&&e.selected!==t&&ji(e,e.selected,t)){e.stats.dragged=!1;return}}(e.selectable.enabled||e.draggable.enabled)&&(Hi(e,t)||br(e,t))&&(zi(e,t),e.hold.start())}function zi(e,t){e.selected=t,br(e,t)?e.premovable.customDests||(e.premovable.dests=Fi(e,t)):e.premovable.dests=void 0}function de(e){e.selected=void 0,e.premovable.dests=void 0,e.hold.cancel()}function Hi(e,t){const n=e.pieces.get(t);return!!n&&(e.movable.color==="both"||e.movable.color===n.color&&e.turnColor===n.color)}const wr=(e,t,n)=>t!==n&&Hi(e,t)&&(e.movable.free||!!e.movable.dests?.get(t)?.includes(n));function hl(e,t,n){const r=e.pieces.get(t);return!!r&&(t===n||!e.pieces.has(n))&&(e.movable.color==="both"||e.movable.color===r.color&&e.turnColor===r.color)}function br(e,t){const n=e.pieces.get(t);return!!n&&e.premovable.enabled&&e.movable.color===n.color&&e.turnColor!==n.color}const pl=(e,t,n)=>t!==n&&br(e,t)&&(e.premovable.customDests?.get(t)??Fi(e,t)).includes(n);function gl(e,t,n){const r=e.pieces.get(t),i=e.pieces.get(n);return!!r&&(!i||i.color!==e.movable.color)&&e.predroppable.enabled&&(r.role!=="pawn"||n[1]!=="1"&&n[1]!=="8")&&e.movable.color===r.color&&e.turnColor!==r.color}function ml(e,t){const n=e.pieces.get(t);return!!n&&e.draggable.enabled&&(e.movable.color==="both"||e.movable.color===n.color&&(e.turnColor===n.color||e.premovable.enabled))}function wl(e){const t=e.premovable.current;if(!t)return!1;const n=t[0],r=t[1];let i=!1;if(wr(e,n,r)){const s=qi(e,n,r);if(s){const o={premove:!0};s!==!0&&(o.captured=s),le(e.movable.events.after,n,r,o),i=!0}}return Fe(e),i}function bl(e,t){const n=e.predroppable.current;let r=!1;if(!n)return!1;if(t(n)){const i={role:n.role,color:e.movable.color};mr(e,i,n.key)&&(le(e.movable.events.afterNewPiece,n.role,n.key,{premove:!1,predrop:!0}),r=!0)}return Be(e),r}function yr(e){Fe(e),Be(e),de(e)}function Br(e){e.movable.color=e.movable.dests=e.animation.current=void 0,yr(e)}function tt(e,t,n){let r=Math.floor(8*(e[0]-n.left)/n.width);t||(r=7-r);let i=7-Math.floor(8*(e[1]-n.top)/n.height);return t||(i=7-i),r>=0&&r<8&&i>=0&&i<8?Pe([r,i]):void 0}function yl(e,t,n,r){const i=z(e),s=$i.filter(c=>Vo(i,c)||Ri(i[0],i[1],c[0],c[1])||dr(i[0],i[1],c[0],c[1])),l=s.map(c=>Oi(je(c),n,r)).map(c=>Et(t,c)),[,a]=l.reduce((c,f,u)=>c[0]<f?c:[f,u],[l[0],0]);return Pe(s[a])}const ae=e=>e.orientation==="white",Ui="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",_l={p:"pawn",r:"rook",n:"knight",b:"bishop",q:"queen",k:"king"},kl={pawn:"p",rook:"r",knight:"n",bishop:"b",queen:"q",king:"k"};function Wi(e){e==="start"&&(e=Ui);const t=new Map;let n=7,r=0;for(const i of e)switch(i){case" ":case"[":return t;case"/":if(--n,n<0)return t;r=0;break;case"~":{const s=Pe([r-1,n]),o=s&&t.get(s);o&&(o.promoted=!0);break}default:{const s=i.charCodeAt(0);if(s<57)r+=s-48;else{const o=i.toLowerCase(),l=Pe([r,n]);l&&t.set(l,{role:_l[o],color:i===o?"black":"white"}),++r}}}return t}function vl(e){return Uo.map(t=>Vt.map(n=>{const r=e.get(n+t);if(r){let i=kl[r.role];return r.color==="white"&&(i=i.toUpperCase()),r.promoted&&(i+="~"),i}else return"1"}).join("")).join("/").replace(/1{2,}/g,t=>t.length.toString())}function Gi(e,t){t.animation&&(_r(e.animation,t.animation),(e.animation.duration||0)<70&&(e.animation.enabled=!1))}function Vi(e,t){if(t.movable?.dests&&(e.movable.dests=void 0),t.drawable?.autoShapes&&(e.drawable.autoShapes=[]),_r(e,t),t.fen&&(e.pieces=Wi(t.fen),e.drawable.shapes=t.drawable?.shapes||[]),"check"in t&&cl(e,t.check||!1),"lastMove"in t&&!t.lastMove?e.lastMove=void 0:t.lastMove&&(e.lastMove=t.lastMove),e.selected&&zi(e,e.selected),Gi(e,t),!e.movable.rookCastle&&e.movable.dests){const n=e.movable.color==="white"?"1":"8",r="e"+n,i=e.movable.dests.get(r),s=e.pieces.get(r);if(!i||!s||s.role!=="king")return;e.movable.dests.set(r,i.filter(o=>!(o==="a"+n&&i.includes("c"+n))&&!(o==="h"+n&&i.includes("g"+n))))}}function _r(e,t){for(const n in t)n==="__proto__"||n==="constructor"||!Object.prototype.hasOwnProperty.call(t,n)||(Object.prototype.hasOwnProperty.call(e,n)&&qr(e[n])&&qr(t[n])?_r(e[n],t[n]):e[n]=t[n])}function qr(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return t===Object.prototype||t===null}const Ke=(e,t)=>t.animation.enabled?$l(e,t):Le(e,t);function Le(e,t){const n=e(t);return t.dom.redraw(),n}const Rn=(e,t)=>({key:e,pos:z(e),piece:t}),Cl=(e,t)=>t.sort((n,r)=>Et(e.pos,n.pos)-Et(e.pos,r.pos))[0];function Pl(e,t){const n=new Map,r=[],i=new Map,s=[],o=[],l=new Map;let a,c,f;for(const[u,d]of e)l.set(u,Rn(u,d));for(const u of pn)a=t.pieces.get(u),c=l.get(u),a?c?Qt(a,c.piece)||(s.push(c),o.push(Rn(u,a))):o.push(Rn(u,a)):c&&s.push(c);for(const u of o)c=Cl(u,s.filter(d=>Qt(u.piece,d.piece))),c&&(f=[c.pos[0]-u.pos[0],c.pos[1]-u.pos[1]],n.set(u.key,f.concat(f)),r.push(c.key));for(const u of s)r.includes(u.key)||i.set(u.key,u.piece);return{anims:n,fadings:i}}function Xi(e,t){const n=e.animation.current;if(n===void 0){e.dom.destroyed||e.dom.redrawNow();return}const r=1-(t-n.start)*n.frequency;if(r<=0)e.animation.current=void 0,e.dom.redrawNow();else{const i=El(r);for(const s of n.plan.anims.values())s[2]=s[0]*i,s[3]=s[1]*i;e.dom.redrawNow(!0),requestAnimationFrame((s=performance.now())=>Xi(e,s))}}function $l(e,t){const n=new Map(t.pieces),r=e(t),i=Pl(n,t);if(i.anims.size||i.fadings.size){const s=t.animation.current&&t.animation.current.start;t.animation.current={start:performance.now(),frequency:1/t.animation.duration,plan:i},s||Xi(t,performance.now())}else t.dom.redraw();return r}const El=e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1,Sl=["green","red","blue","yellow"];function Al(e,t){if(t.touches&&t.touches.length>1)return;t.stopPropagation(),t.preventDefault(),t.ctrlKey?de(e):yr(e);const n=et(t),r=tt(n,ae(e),e.dom.bounds());r&&(e.drawable.current={orig:r,pos:n,brush:Ml(t),snapToValidMove:e.drawable.defaultSnapToValidMove},Qi(e))}function Qi(e){requestAnimationFrame(()=>{const t=e.drawable.current;if(t){const n=tt(t.pos,ae(e),e.dom.bounds());n||(t.snapToValidMove=!1);const r=t.snapToValidMove?yl(t.orig,t.pos,ae(e),e.dom.bounds()):n;r!==t.mouseSq&&(t.mouseSq=r,t.dest=r!==t.orig?r:void 0,e.dom.redrawNow()),Qi(e)}})}function Ol(e,t){e.drawable.current&&(e.drawable.current.pos=et(t))}function Rl(e){const t=e.drawable.current;t&&(t.mouseSq&&Ll(e.drawable,t),Yi(e))}function Yi(e){e.drawable.current&&(e.drawable.current=void 0,e.dom.redraw())}function xl(e){e.drawable.shapes.length&&(e.drawable.shapes=[],e.dom.redraw(),Ji(e.drawable))}const Un=(e,t)=>e.orig===t.orig&&e.dest===t.dest,Zi=(e,t)=>e.brush===t.brush;function Ml(e){const t=(e.shiftKey||e.ctrlKey)&&Ai(e),n=e.altKey||e.metaKey||e.getModifierState?.("AltGraph");return Sl[(t?1:0)+(n?2:0)]}function Ll(e,t){const n=e.shapes.find(r=>Un(r,t));n&&(e.shapes=e.shapes.filter(r=>!Un(r,t))),(!n||!Zi(n,t))&&e.shapes.push({orig:t.orig,dest:t.dest,brush:t.brush}),Ji(e)}function Ji(e){e.onChange&&e.onChange(e.shapes)}function Nl(e,t){if(!(e.trustAllEvents||t.isTrusted)||t.buttons!==void 0&&t.buttons>1||t.touches&&t.touches.length>1)return;const n=e.dom.bounds(),r=et(t),i=tt(r,ae(e),n);if(!i)return;const s=e.pieces.get(i),o=e.selected;if(!o&&e.drawable.enabled&&(e.drawable.eraseOnMovablePieceClick||!s||s.color!==e.turnColor)&&xl(e),t.cancelable!==!1&&(!t.touches||e.blockTouchScroll||s||o||Tl(e,r)))t.preventDefault();else if(t.touches)return;const l=!!e.premovable.current,a=!!e.predroppable.current;e.stats.ctrlKey=t.ctrlKey,e.selected&&wr(e,e.selected,i)?Ke(u=>Hn(u,i),e):Hn(e,i);const c=e.selected===i,f=ts(e,i);if(s&&f&&c&&ml(e,i)){e.draggable.current={orig:i,piece:s,origPos:r,pos:r,started:e.draggable.autoDistance&&e.stats.dragged,element:f,previouslySelected:o,originTarget:t.target,keyHasChanged:!1},f.cgDragging=!0,f.classList.add("dragging");const u=e.dom.elements.ghost;u&&(u.className=`ghost ${s.color} ${s.role}`,_e(u,Lt(n)(z(i),ae(e))),fr(u,!0)),kr(e)}else l&&Fe(e),a&&Be(e);e.dom.redraw()}function Tl(e,t){const n=ae(e),r=e.dom.bounds(),i=Math.pow(e.touchIgnoreRadius*r.width/16,2)*2;for(const s of e.pieces.keys()){const o=Oi(s,n,r);if(Et(o,t)<=i)return!0}return!1}function Dl(e,t,n,r){e.pieces.set("a0",t),e.dom.redraw();const s=et(n);e.draggable.current={orig:"a0",piece:t,origPos:s,pos:s,started:!0,element:()=>ts(e,"a0"),originTarget:n.target,newPiece:!0,force:!!r,keyHasChanged:!1},kr(e)}function kr(e){requestAnimationFrame(()=>{const t=e.draggable.current;if(!t)return;e.animation.current?.plan.anims.has(t.orig)&&(e.animation.current=void 0);const n=e.pieces.get(t.orig);if(!n||!Qt(n,t.piece))Zt(e);else if(!t.started&&Et(t.pos,t.origPos)>=Math.pow(e.draggable.distance,2)&&(t.started=!0),t.started){if(typeof t.element=="function"){const i=t.element();if(!i)return;i.cgDragging=!0,i.classList.add("dragging"),t.element=i}const r=e.dom.bounds();_e(t.element,[t.pos[0]-r.left-r.width/16,t.pos[1]-r.top-r.height/16]),t.keyHasChanged||(t.keyHasChanged=t.orig!==tt(t.pos,ae(e),r))}kr(e)})}function Il(e,t){e.draggable.current&&(!t.touches||t.touches.length<2)&&(e.draggable.current.pos=et(t))}function Fl(e,t){const n=e.draggable.current;if(!n)return;if(t.type==="touchend"&&t.cancelable!==!1&&t.preventDefault(),t.type==="touchend"&&n.originTarget!==t.target&&!n.newPiece){e.draggable.current=void 0;return}Fe(e),Be(e);const r=et(t)||n.pos,i=tt(r,ae(e),e.dom.bounds());i&&n.started&&n.orig!==i?n.newPiece?Ki(e,n.orig,i,n.force):(e.stats.ctrlKey=t.ctrlKey,ji(e,n.orig,i)&&(e.stats.dragged=!0)):n.newPiece?e.pieces.delete(n.orig):e.draggable.deleteOnDropOff&&!i&&(e.pieces.delete(n.orig),le(e.events.change)),(n.orig===n.previouslySelected||n.keyHasChanged)&&(n.orig===i||!i)?de(e):e.selectable.enabled||de(e),es(e),e.draggable.current=void 0,e.dom.redraw()}function Zt(e){const t=e.draggable.current;t&&(t.newPiece&&e.pieces.delete(t.orig),e.draggable.current=void 0,de(e),es(e),e.dom.redraw())}function es(e){const t=e.dom.elements;t.ghost&&fr(t.ghost,!1)}function ts(e,t){let n=e.dom.elements.board.firstChild;for(;n;){if(n.cgKey===t&&n.tagName==="PIECE")return n;n=n.nextSibling}}function Bl(e,t){e.exploding={stage:1,keys:t},e.dom.redraw(),setTimeout(()=>{jr(e,2),setTimeout(()=>jr(e,void 0),120)},120)}function jr(e,t){e.exploding&&(t?e.exploding.stage=t:e.exploding=void 0,e.dom.redraw())}function ql(e,t){function n(){ll(e),t()}return{set(r){r.orientation&&r.orientation!==e.orientation&&n(),Gi(e,r),(r.fen?Ke:Le)(i=>Vi(i,r),e)},state:e,getFen:()=>vl(e.pieces),toggleOrientation:n,setPieces(r){Ke(i=>al(i,r),e)},selectSquare(r,i){r?Ke(s=>Hn(s,r,i),e):e.selected&&(de(e),e.dom.redraw())},move(r,i){Ke(s=>Bi(s,r,i),e)},newPiece(r,i){Ke(s=>mr(s,r,i),e)},playPremove(){if(e.premovable.current){if(Ke(wl,e))return!0;e.dom.redraw()}return!1},playPredrop(r){if(e.predroppable.current){const i=bl(e,r);return e.dom.redraw(),i}return!1},cancelPremove(){Le(Fe,e)},cancelPredrop(){Le(Be,e)},cancelMove(){Le(r=>{yr(r),Zt(r)},e)},stop(){Le(r=>{Br(r),Zt(r)},e)},explode(r){Bl(e,r)},setAutoShapes(r){Le(i=>i.drawable.autoShapes=r,e)},setShapes(r){Le(i=>i.drawable.shapes=r.slice(),e)},getKeyAtDomPos(r){return tt(r,ae(e),e.dom.bounds())},redrawAll:t,dragNewPiece(r,i,s){Dl(e,r,i,s)},destroy(){Br(e),e.dom.unbind&&e.dom.unbind(),e.dom.destroyed=!0}}}function jl(){return{pieces:Wi(Ui),orientation:"white",turnColor:"white",coordinates:!0,coordinatesOnSquares:!1,ranksPosition:"right",autoCastle:!0,viewOnly:!1,disableContextMenu:!1,addPieceZIndex:!1,blockTouchScroll:!1,touchIgnoreRadius:1,pieceKey:!1,trustAllEvents:!1,highlight:{lastMove:!0,check:!0},animation:{enabled:!0,duration:200},movable:{free:!0,color:"both",showDests:!0,events:{},rookCastle:!0},premovable:{enabled:!0,showDests:!0,castle:!0,additionalPremoveRequirements:e=>!0,events:{}},predroppable:{enabled:!1,events:{}},draggable:{enabled:!0,distance:3,autoDistance:!0,showGhost:!0,deleteOnDropOff:!1},dropmode:{active:!1},selectable:{enabled:!0},stats:{dragged:!("ontouchstart"in window)},events:{},drawable:{enabled:!0,visible:!0,defaultSnapToValidMove:!0,eraseOnMovablePieceClick:!0,shapes:[],autoShapes:[],brushes:{green:{key:"g",color:"#15781B",opacity:1,lineWidth:10},red:{key:"r",color:"#882020",opacity:1,lineWidth:10},blue:{key:"b",color:"#003088",opacity:1,lineWidth:10},yellow:{key:"y",color:"#e68f00",opacity:1,lineWidth:10},paleBlue:{key:"pb",color:"#003088",opacity:.4,lineWidth:15},paleGreen:{key:"pg",color:"#15781B",opacity:.4,lineWidth:15},paleRed:{key:"pr",color:"#882020",opacity:.4,lineWidth:15},paleGrey:{key:"pgr",color:"#4a4a4a",opacity:.35,lineWidth:15},purple:{key:"purple",color:"#68217a",opacity:.65,lineWidth:10},pink:{key:"pink",color:"#ee2080",opacity:.5,lineWidth:10},white:{key:"white",color:"white",opacity:1,lineWidth:10},paleWhite:{key:"pwhite",color:"white",opacity:.6,lineWidth:10}},prevSvgHash:""},hold:Go()}}function Kl(){const e=re("defs"),t=se(re("filter"),{id:"cg-filter-blur"});return t.appendChild(se(re("feGaussianBlur"),{stdDeviation:"0.013"})),e.appendChild(t),e}function zl(e,t){const n=e.drawable,r=n.current,i=r&&r.mouseSq?r:void 0,s=new Map,o=e.dom.bounds(),l=n.autoShapes.filter(u=>!u.piece);for(const u of n.shapes.concat(l).concat(i?[i]:[])){if(!u.dest)continue;const d=s.get(u.dest)??new Set,p=en(Jt(z(u.orig),e.orientation),o),b=en(Jt(z(u.dest),e.orientation),o);d.add(Gn(p,b)),s.set(u.dest,d)}const a=[],c=i?n.shapes.findIndex(u=>Un(u,i)&&Zi(u,i)):-1;for(const[u,d]of n.shapes.concat(l).entries()){const p=c!==-1&&c===u;a.push({shape:d,current:!1,pendingErase:p,hash:Kr(d,Wn(d.dest,s),!1,o,p)})}i&&c===-1&&a.push({shape:i,current:!0,hash:Kr(i,Wn(i.dest,s),!0,o,!1),pendingErase:!1});const f=a.map(u=>u.hash).join(";");f!==e.drawable.prevSvgHash&&(e.drawable.prevSvgHash=f,Hl(n,a,t),Ul(a,t,u=>Vl(e,u,n.brushes,s,o)))}function Hl(e,t,n){for(const r of[n.shapes,n.shapesBelow]){const i=r.querySelector("defs"),s=t.filter(c=>r===n.shapesBelow==!!c.shape.below),o=new Map;for(const c of s.filter(f=>f.shape.dest&&f.shape.brush)){const f=ns(e.brushes[c.shape.brush],c.shape.modifiers),{key:u,color:d}=rs(c.shape);u&&d&&o.set(u,{key:u,color:d,opacity:1,lineWidth:1}),o.set(f.key,f)}const l=new Set;let a=i.firstElementChild;for(;a;)l.add(a.getAttribute("cgKey")),a=a.nextElementSibling;for(const[c,f]of o.entries())l.has(c)||i.appendChild(Yl(f))}}function Ul(e,t,n){for(const[r,i]of[[t.shapes,t.custom],[t.shapesBelow,t.customBelow]]){const[s,o]=[r,i].map(c=>c.querySelector("g")),l=e.filter(c=>r===t.shapesBelow==!!c.shape.below),a=new Map;for(const c of l)a.set(c.hash,!1);for(const c of[s,o]){const f=[];let u=c.firstElementChild,d;for(;u;)d=u.getAttribute("cgHash"),a.has(d)?a.set(d,!0):f.push(u),u=u.nextElementSibling;for(const p of f)c.removeChild(p)}for(const c of l.filter(f=>!a.get(f.hash)))for(const f of n(c))f.isCustom?o.appendChild(f.el):s.appendChild(f.el)}}function Kr({orig:e,dest:t,brush:n,piece:r,modifiers:i,customSvg:s,label:o,below:l},a,c,f,u){return[f.width,f.height,c,u&&"pendingErase",e,t,n,a&&"-",r&&Wl(r),i&&Gl(i),s&&`custom-${zr(s.html)},${s.center?.[0]??"o"}`,o&&`label-${zr(o.text)}`,l&&"below"].filter(d=>d).join(",")}function Wl(e){return[e.color,e.role,e.scale].filter(t=>t).join(",")}function Gl(e){return[e.lineWidth,e.hilite].filter(t=>t).join(",")}function zr(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n)>>>0;return t.toString()}function Vl(e,{shape:t,current:n,pendingErase:r,hash:i},s,o,l){const a=en(Jt(z(t.orig),e.orientation),l),c=t.dest?en(Jt(z(t.dest),e.orientation),l):a,f=t.brush&&ns(s[t.brush],t.modifiers),u=o.get(t.dest),d=[];if(f){const p=se(re("g"),{cgHash:i});d.push({el:p}),a[0]!==c[0]||a[1]!==c[1]?p.appendChild(Ql(t,f,a,c,n,Wn(t.dest,o),r)):p.appendChild(Xl(s[t.brush],a,n,l,r))}if(t.label){const p=t.label;p.fill??(p.fill=t.brush&&s[t.brush].color);const b=t.brush?void 0:"tr";d.push({el:Zl(p,i,a,c,u,b),isCustom:!0})}if(t.customSvg){const p=t.customSvg.center??"orig",[b,h]=p==="label"?ss(a,c,u).map(E=>E-.5):p==="dest"?c:a,_=se(re("g"),{transform:`translate(${b},${h})`,cgHash:i});_.innerHTML=`<svg width="1" height="1" viewBox="0 0 100 100">${t.customSvg.html}</svg>`,d.push({el:_,isCustom:!0})}return d}function Xl(e,t,n,r,i){const s=Jl(),o=(r.width+r.height)/(4*Math.max(r.width,r.height));return se(re("circle"),{stroke:e.color,"stroke-width":s[n?0:1],fill:"none",opacity:is(e,n,i),cx:t[0],cy:t[1],r:o-s[1]/2})}function Ql(e,t,n,r,i,s,o){function l(f){const u=ta(s&&!i),d=r[0]-n[0],p=r[1]-n[1],b=Math.atan2(p,d),h=Math.cos(b)*u,_=Math.sin(b)*u,E=rs(e);return se(re("line"),{stroke:f?E.color:t.color,"stroke-width":ea(t,i)*(f?1.14:1),"stroke-linecap":"round","marker-end":`url(#arrowhead-${f?E.key:t.key})`,opacity:e.modifiers?.hilite&&!o?1:is(t,i,o),x1:n[0],y1:n[1],x2:r[0]-h,y2:r[1]-_})}if(!e.modifiers?.hilite)return l(!1);const a=se(re("g"),{opacity:t.opacity}),c=se(re("g"),{filter:"url(#cg-filter-blur)"});return c.appendChild(na(n,r)),c.appendChild(l(!0)),a.appendChild(c),a.appendChild(l(!1)),a}function Yl(e){const t=se(re("marker"),{id:"arrowhead-"+e.key,orient:"auto",overflow:"visible",markerWidth:4,markerHeight:4,refX:e.key.startsWith("hilite")?1.86:2.05,refY:2});return t.appendChild(se(re("path"),{d:"M0,0 V4 L3,2 Z",fill:e.color})),t.setAttribute("cgKey",e.key),t}function Zl(e,t,n,r,i,s){const l=.4*.75**e.text.length,a=ss(n,r,i),c=s==="tr"?.4:0,f=se(re("g"),{transform:`translate(${a[0]+c},${a[1]-c})`,cgHash:t});f.appendChild(se(re("circle"),{r:.4/2,"fill-opacity":s?1:.8,"stroke-opacity":s?1:.7,"stroke-width":.03,fill:e.fill??"#666",stroke:"white"}));const u=se(re("text"),{"font-size":l,"font-family":"Noto Sans","text-anchor":"middle",fill:"white",y:.13*.75**e.text.length});return u.innerHTML=e.text,f.appendChild(u),f}function Jt(e,t){return t==="white"?e:[7-e[0],7-e[1]]}function Wn(e,t){return(e&&t.has(e)&&t.get(e).size>1)===!0}function re(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function se(e,t){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.setAttribute(n,t[n]);return e}function ns(e,t){return t?{color:e.color,opacity:Math.round(e.opacity*10)/10,lineWidth:Math.round(t.lineWidth||e.lineWidth),key:[e.key,t.lineWidth].filter(n=>n).join("")}:e}function Jl(){return[3/64,4/64]}function ea(e,t){return(e.lineWidth||10)*(t?.85:1)/64}function rs(e){const t=e.modifiers?.hilite;return{key:t&&`hilite-${t.replace("#","")}`,color:t}}function is(e,t,n){return(e.opacity||1)*(n?.6:t?.9:1)}function ta(e){return(e?20:10)/64}function en(e,t){const n=Math.min(1,t.width/t.height),r=Math.min(1,t.height/t.width);return[(e[0]-3.5)*n,(3.5-e[1])*r]}function na(e,t){const n={from:[Math.floor(Math.min(e[0],t[0])),Math.floor(Math.min(e[1],t[1]))],to:[Math.ceil(Math.max(e[0],t[0])),Math.ceil(Math.max(e[1],t[1]))]};return se(re("rect"),{x:n.from[0],y:n.from[1],width:n.to[0]-n.from[0],height:n.to[1]-n.from[1],fill:"none",stroke:"none"})}function Gn(e,t,n=!0){const r=Math.atan2(t[1]-e[1],t[0]-e[0])+Math.PI;return n?(Math.round(r*8/Math.PI)+16)%16:r}function ra(e,t){return Math.sqrt([e[0]-t[0],e[1]-t[1]].reduce((n,r)=>n+r*r,0))}function ss(e,t,n){let r=ra(e,t);const i=Gn(e,t,!1);if(n&&(r-=33/64,n.size>1)){r-=10/64;const s=Gn(e,t);(n.has((s+1)%16)||n.has((s+15)%16))&&s&1&&(r-=.4)}return[e[0]-Math.cos(i)*r,e[1]-Math.sin(i)*r].map(s=>s+.5)}function ia(e,t){e.innerHTML="",e.classList.add("cg-wrap");for(const f of Ho)e.classList.toggle("orientation-"+f,t.orientation===f);e.classList.toggle("manipulable",!t.viewOnly);const n=Oe("cg-container");e.appendChild(n);const r=Oe("cg-board");n.appendChild(r);let i,s,o,l,a;if(t.drawable.visible&&([i,s]=["cg-shapes-below","cg-shapes"].map(f=>Hr(f,!0)),[o,l]=["cg-custom-below","cg-custom-svgs"].map(f=>Hr(f,!1)),a=Oe("cg-auto-pieces"),n.appendChild(i),n.appendChild(o),n.appendChild(s),n.appendChild(l),n.appendChild(a)),t.coordinates){const f=t.orientation==="black"?" black":"",u=t.ranksPosition==="left"?" left":"";if(t.coordinatesOnSquares){const d=t.orientation==="white"?p=>p+1:p=>8-p;Vt.forEach((p,b)=>n.appendChild(xn(Xt.map(h=>p+h),"squares rank"+d(b)+f+u)))}else n.appendChild(xn(Xt,"ranks"+f+u)),n.appendChild(xn(Vt,"files"+f))}let c;return t.draggable.enabled&&t.draggable.showGhost&&(c=Oe("piece","ghost"),fr(c,!1),n.appendChild(c)),{board:r,container:n,wrap:e,ghost:c,shapes:s,shapesBelow:i,custom:l,customBelow:o,autoPieces:a}}function Hr(e,t){const n=se(re("svg"),{class:e,viewBox:t?"-4 -4 8 8":"-3.5 -3.5 8 8",preserveAspectRatio:"xMidYMid slice"});return t&&n.appendChild(Kl()),n.appendChild(re("g")),n}function xn(e,t){const n=Oe("coords",t);let r;for(const i of e)r=Oe("coord"),r.textContent=i,n.appendChild(r);return n}function sa(e,t){if(!e.dropmode.active)return;Fe(e),Be(e);const n=e.dropmode.piece;if(n){e.pieces.set("a0",n);const r=et(t),i=r&&tt(r,ae(e),e.dom.bounds());i&&Ki(e,"a0",i)}e.dom.redraw()}function oa(e,t){const n=e.dom.elements.board;if("ResizeObserver"in window&&new ResizeObserver(t).observe(e.dom.elements.wrap),(e.disableContextMenu||e.drawable.enabled)&&n.addEventListener("contextmenu",i=>i.preventDefault()),e.viewOnly)return;const r=aa(e);n.addEventListener("touchstart",r,{passive:!1}),n.addEventListener("mousedown",r,{passive:!1})}function la(e,t){const n=[];if("ResizeObserver"in window||n.push(ht(document.body,"chessground.resize",t)),!e.viewOnly){const r=Ur(e,Il,Ol),i=Ur(e,Fl,Rl);for(const o of["touchmove","mousemove"])n.push(ht(document,o,r));for(const o of["touchend","mouseup"])n.push(ht(document,o,i));const s=()=>e.dom.bounds.clear();n.push(ht(document,"scroll",s,{capture:!0,passive:!0})),n.push(ht(window,"resize",s,{passive:!0}))}return()=>n.forEach(r=>r())}function ht(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}const aa=e=>t=>{e.draggable.current?Zt(e):e.drawable.current?Yi(e):t.shiftKey||Ai(t)?e.drawable.enabled&&Al(e,t):e.viewOnly||(e.dropmode.active?sa(e,t):Nl(e,t))},Ur=(e,t,n)=>r=>{e.drawable.current?e.drawable.enabled&&n(e,r):e.viewOnly||t(e,r)};function ca(e){const t=ae(e),n=Lt(e.dom.bounds()),r=e.dom.elements.board,i=e.pieces,s=e.animation.current,o=s?s.plan.anims:new Map,l=s?s.plan.fadings:new Map,a=e.draggable.current,c=fa(e),f=new Set,u=new Set,d=new Map,p=new Map;let b,h,_,E,v,j,O,R,G,U;for(h=r.firstChild;h;){if(b=h.cgKey,os(h))if(_=i.get(b),v=o.get(b),j=l.get(b),E=h.cgPiece,h.cgDragging&&(!a||a.orig!==b)&&(h.classList.remove("dragging"),_e(h,n(z(b),t)),h.cgDragging=!1),!j&&h.cgFading&&(h.cgFading=!1,h.classList.remove("fading")),_){if(v&&h.cgAnimating&&E===pt(_)){const D=z(b);D[0]+=v[2],D[1]+=v[3],h.classList.add("anim"),_e(h,n(D,t))}else h.cgAnimating&&(h.cgAnimating=!1,h.classList.remove("anim"),_e(h,n(z(b),t)),e.addPieceZIndex&&(h.style.zIndex=Mn(z(b),t)));E===pt(_)&&(!j||!h.cgFading)?f.add(b):j&&E===pt(j)?(h.classList.add("fading"),h.cgFading=!0):Ln(d,E,h)}else Ln(d,E,h);else if(ls(h)){const D=h.className;c.get(b)===D?u.add(b):Ln(p,D,h)}h=h.nextSibling}for(const[D,Y]of c)if(!u.has(D)){G=p.get(Y),U=G&&G.pop();const q=n(z(D),t);if(U)U.cgKey=D,_e(U,q);else{const y=Oe("square",Y);y.cgKey=D,_e(y,q),r.insertBefore(y,r.firstChild)}}for(const[D,Y]of i)if(v=o.get(D),!f.has(D))if(O=d.get(pt(Y)),R=O&&O.pop(),R){R.cgKey=D,R.cgFading&&(R.classList.remove("fading"),R.cgFading=!1);const q=z(D);e.addPieceZIndex&&(R.style.zIndex=Mn(q,t)),v&&(R.cgAnimating=!0,R.classList.add("anim"),q[0]+=v[2],q[1]+=v[3]),_e(R,n(q,t))}else{const q=pt(Y),y=Oe("piece",q),k=z(D);y.cgPiece=q,y.cgKey=D,v&&(y.cgAnimating=!0,k[0]+=v[2],k[1]+=v[3]),_e(y,n(k,t)),e.addPieceZIndex&&(y.style.zIndex=Mn(k,t)),r.appendChild(y)}for(const D of d.values())Gr(e,D);for(const D of p.values())Gr(e,D)}function ua(e){const t=ae(e),n=Lt(e.dom.bounds());let r=e.dom.elements.board.firstChild;for(;r;)(os(r)&&!r.cgAnimating||ls(r))&&_e(r,n(z(r.cgKey),t)),r=r.nextSibling}function Wr(e){const t=e.dom.elements.wrap.getBoundingClientRect(),n=e.dom.elements.container,r=t.height/t.width,i=Math.floor(t.width*window.devicePixelRatio/8)*8/window.devicePixelRatio,s=i*r;n.style.width=i+"px",n.style.height=s+"px",e.dom.bounds.clear(),e.addDimensionsCssVarsTo?.style.setProperty("---cg-width",i+"px"),e.addDimensionsCssVarsTo?.style.setProperty("---cg-height",s+"px")}const os=e=>e.tagName==="PIECE",ls=e=>e.tagName==="SQUARE";function Gr(e,t){for(const n of t)e.dom.elements.board.removeChild(n)}function Mn(e,t){const r=e[1];return`${t?10-r:3+r}`}const pt=e=>`${e.color} ${e.role}`;function fa(e){const t=new Map;if(e.lastMove&&e.highlight.lastMove)for(const i of e.lastMove)Se(t,i,"last-move");if(e.check&&e.highlight.check&&Se(t,e.check,"check"),e.selected&&(Se(t,e.selected,"selected"),e.movable.showDests)){const i=e.movable.dests?.get(e.selected);if(i)for(const o of i)Se(t,o,"move-dest"+(e.pieces.has(o)?" oc":""));const s=e.premovable.customDests?.get(e.selected)??e.premovable.dests;if(s)for(const o of s)Se(t,o,"premove-dest"+(e.pieces.has(o)?" oc":""))}const n=e.premovable.current;if(n)for(const i of n)Se(t,i,"current-premove");else e.predroppable.current&&Se(t,e.predroppable.current.key,"current-premove");const r=e.exploding;if(r)for(const i of r.keys)Se(t,i,"exploding"+r.stage);return e.highlight.custom&&e.highlight.custom.forEach((i,s)=>{Se(t,s,i)}),t}function Se(e,t,n){const r=e.get(t);r?e.set(t,`${r} ${n}`):e.set(t,n)}function Ln(e,t,n){const r=e.get(t);r?r.push(n):e.set(t,[n])}function da(e,t,n){const r=new Map,i=[];for(const l of e)r.set(l.hash,!1);let s=t.firstElementChild,o;for(;s;)o=s.getAttribute("cgHash"),r.has(o)?r.set(o,!0):i.push(s),s=s.nextElementSibling;for(const l of i)t.removeChild(l);for(const l of e)r.get(l.hash)||t.appendChild(n(l))}function ha(e,t){const r=e.drawable.autoShapes.filter(i=>i.piece).map(i=>({shape:i,hash:ma(i),current:!1,pendingErase:!1}));da(r,t,i=>ga(e,i,e.dom.bounds()))}function pa(e){const t=ae(e),n=Lt(e.dom.bounds());let r=e.dom.elements.autoPieces?.firstChild;for(;r;)Si(r,n(z(r.cgKey),t),r.cgScale),r=r.nextSibling}function ga(e,{shape:t,hash:n},r){const i=t.orig,s=t.piece?.role,o=t.piece?.color,l=t.piece?.scale,a=Oe("piece",`${s} ${o}`);return a.setAttribute("cgHash",n),a.cgKey=i,a.cgScale=l,Si(a,Lt(r)(z(i),ae(e)),l),a}const ma=e=>[e.orig,e.piece?.role,e.piece?.color,e.piece?.scale].join(",");function wa(e,t){const n=jl();Vi(n,t||{});function r(){const i="dom"in n?n.dom.unbind:void 0,s=ia(e,n),o=Ei(()=>s.board.getBoundingClientRect()),l=f=>{ca(c),s.autoPieces&&ha(c,s.autoPieces),!f&&s.shapes&&zl(c,s)},a=()=>{Wr(c),ua(c),s.autoPieces&&pa(c)},c=n;return c.dom={elements:s,bounds:o,redraw:ba(l),redrawNow:l,unbind:i},c.drawable.prevSvgHash="",Wr(c),l(!1),oa(c,a),i||(c.dom.unbind=la(c,a)),c.events.insert&&c.events.insert(s),c}return ql(r(),r)}function ba(e){let t=!1;return()=>{t||(t=!0,requestAnimationFrame(()=>{e(),t=!1}))}}const tn=["a","b","c","d","e","f","g","h"],as=["1","2","3","4","5","6","7","8"],Ve=["white","black"],pe=["pawn","knight","bishop","rook","queen","king"],ya=["a","h"],nn=e=>"role"in e,N=e=>e!==void 0,ee=e=>e==="white"?"black":"white",Xe=e=>e>>3,ce=e=>e&7,Vn=(e,t)=>0<=e&&e<8&&0<=t&&t<8?e+8*t:void 0,yt=e=>{switch(e){case"pawn":return"p";case"knight":return"n";case"bishop":return"b";case"rook":return"r";case"queen":return"q";case"king":return"k"}};function Xn(e){switch(e.toLowerCase()){case"p":return"pawn";case"n":return"knight";case"b":return"bishop";case"r":return"rook";case"q":return"queen";case"k":return"king";default:return}}function _t(e){if(e.length===2)return Vn(e.charCodeAt(0)-97,e.charCodeAt(1)-49)}const St=e=>tn[ce(e)]+as[Xe(e)],_a=e=>{if(e[1]==="@"&&e.length===4){const t=Xn(e[0]),n=_t(e.slice(2));if(t&&N(n))return{role:t,to:n}}else if(e.length===4||e.length===5){const t=_t(e.slice(0,2)),n=_t(e.slice(2,4));let r;if(e.length===5&&(r=Xn(e[4]),!r))return;if(N(t)&&N(n))return{from:t,to:n,promotion:r}}},vr=(e,t)=>e==="white"?t==="a"?2:6:t==="a"?58:62,Cr=(e,t)=>e==="white"?t==="a"?3:5:t==="a"?59:61,ka=(e,t)=>{const n=new Map,r=e.ctx();for(const[i,s]of e.allDests(r))if(s.nonEmpty()){const o=Array.from(s,St);i===r.king&&ce(i)===4&&(s.has(0)?o.push("c1"):s.has(56)&&o.push("c8"),s.has(7)?o.push("g1"):s.has(63)&&o.push("g8")),n.set(St(i),o)}return n};function va(e){let t=0;return n=>{t+=n.deltaY*(n.deltaMode?40:1),Math.abs(t)>=4?(e(n,!0),t=0):e(n,!1)}}const Vr=e=>(e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),Math.imul(e+(e>>>4)&252645135,16843009)>>24),Qn=e=>(e=e>>>8&16711935|(e&16711935)<<8,e>>>16&65535|(e&65535)<<16),Xr=e=>(e=e>>>1&1431655765|(e&1431655765)<<1,e=e>>>2&858993459|(e&858993459)<<2,e=e>>>4&252645135|(e&252645135)<<4,Qn(e));class g{constructor(t,n){this.lo=t|0,this.hi=n|0}static fromSquare(t){return t>=32?new g(0,1<<t-32):new g(1<<t,0)}static fromRank(t){return new g(255,0).shl64(8*t)}static fromFile(t){return new g(16843009<<t,16843009<<t)}static empty(){return new g(0,0)}static full(){return new g(4294967295,4294967295)}static corners(){return new g(129,2164260864)}static center(){return new g(402653184,24)}static backranks(){return new g(255,4278190080)}static backrank(t){return t==="white"?new g(255,0):new g(0,4278190080)}static lightSquares(){return new g(1437226410,1437226410)}static darkSquares(){return new g(2857740885,2857740885)}complement(){return new g(~this.lo,~this.hi)}xor(t){return new g(this.lo^t.lo,this.hi^t.hi)}union(t){return new g(this.lo|t.lo,this.hi|t.hi)}intersect(t){return new g(this.lo&t.lo,this.hi&t.hi)}diff(t){return new g(this.lo&~t.lo,this.hi&~t.hi)}intersects(t){return this.intersect(t).nonEmpty()}isDisjoint(t){return this.intersect(t).isEmpty()}supersetOf(t){return t.diff(this).isEmpty()}subsetOf(t){return this.diff(t).isEmpty()}shr64(t){return t>=64?g.empty():t>=32?new g(this.hi>>>t-32,0):t>0?new g(this.lo>>>t^this.hi<<32-t,this.hi>>>t):this}shl64(t){return t>=64?g.empty():t>=32?new g(0,this.lo<<t-32):t>0?new g(this.lo<<t,this.hi<<t^this.lo>>>32-t):this}bswap64(){return new g(Qn(this.hi),Qn(this.lo))}rbit64(){return new g(Xr(this.hi),Xr(this.lo))}minus64(t){const n=this.lo-t.lo,r=(n&t.lo&1)+(t.lo>>>1)+(n>>>1)>>>31;return new g(n,this.hi-(t.hi+r))}equals(t){return this.lo===t.lo&&this.hi===t.hi}size(){return Vr(this.lo)+Vr(this.hi)}isEmpty(){return this.lo===0&&this.hi===0}nonEmpty(){return this.lo!==0||this.hi!==0}has(t){return(t>=32?this.hi&1<<t-32:this.lo&1<<t)!==0}set(t,n){return n?this.with(t):this.without(t)}with(t){return t>=32?new g(this.lo,this.hi|1<<t-32):new g(this.lo|1<<t,this.hi)}without(t){return t>=32?new g(this.lo,this.hi&~(1<<t-32)):new g(this.lo&~(1<<t),this.hi)}toggle(t){return t>=32?new g(this.lo,this.hi^1<<t-32):new g(this.lo^1<<t,this.hi)}last(){if(this.hi!==0)return 63-Math.clz32(this.hi);if(this.lo!==0)return 31-Math.clz32(this.lo)}first(){if(this.lo!==0)return 31-Math.clz32(this.lo&-this.lo);if(this.hi!==0)return 63-Math.clz32(this.hi&-this.hi)}withoutFirst(){return this.lo!==0?new g(this.lo&this.lo-1,this.hi):new g(0,this.hi&this.hi-1)}moreThanOne(){return this.hi!==0&&this.lo!==0||(this.lo&this.lo-1)!==0||(this.hi&this.hi-1)!==0}singleSquare(){return this.moreThanOne()?void 0:this.last()}*[Symbol.iterator](){let t=this.lo,n=this.hi;for(;t!==0;){const r=31-Math.clz32(t&-t);t^=1<<r,yield r}for(;n!==0;){const r=31-Math.clz32(n&-n);n^=1<<r,yield 32+r}}*reversed(){let t=this.lo,n=this.hi;for(;n!==0;){const r=31-Math.clz32(n);n^=1<<r,yield 32+r}for(;t!==0;){const r=31-Math.clz32(t);t^=1<<r,yield r}}}const rn=(e,t)=>{let n=g.empty();for(const r of t){const i=e+r;0<=i&&i<64&&Math.abs(ce(e)-ce(i))<=2&&(n=n.with(i))}return n},Ie=e=>{const t=[];for(let n=0;n<64;n++)t[n]=e(n);return t},Ca=Ie(e=>rn(e,[-9,-8,-7,-1,1,7,8,9])),Pa=Ie(e=>rn(e,[-17,-15,-10,-6,6,10,15,17])),$a={white:Ie(e=>rn(e,[7,9])),black:Ie(e=>rn(e,[-7,-9]))},Pr=e=>Ca[e],$r=e=>Pa[e],yn=(e,t)=>$a[e][t],Yn=Ie(e=>g.fromFile(ce(e)).without(e)),Zn=Ie(e=>g.fromRank(Xe(e)).without(e)),Jn=Ie(e=>{const t=new g(134480385,2151686160),n=8*(Xe(e)-ce(e));return(n>=0?t.shl64(n):t.shr64(-n)).without(e)}),er=Ie(e=>{const t=new g(270549120,16909320),n=8*(Xe(e)+ce(e)-7);return(n>=0?t.shl64(n):t.shr64(-n)).without(e)}),tr=(e,t,n)=>{let r=n.intersect(t),i=r.bswap64();return r=r.minus64(e),i=i.minus64(e.bswap64()),r.xor(i.bswap64()).intersect(t)},Ea=(e,t)=>tr(g.fromSquare(e),Yn[e],t),Sa=(e,t)=>{const n=Zn[e];let r=t.intersect(n),i=r.rbit64();return r=r.minus64(g.fromSquare(e)),i=i.minus64(g.fromSquare(63-e)),r.xor(i.rbit64()).intersect(n)},At=(e,t)=>{const n=g.fromSquare(e);return tr(n,Jn[e],t).xor(tr(n,er[e],t))},Ot=(e,t)=>Ea(e,t).xor(Sa(e,t)),cs=(e,t)=>At(e,t).xor(Ot(e,t)),us=(e,t)=>{const n=g.fromSquare(t);return Zn[e].intersects(n)?Zn[e].with(e):er[e].intersects(n)?er[e].with(e):Jn[e].intersects(n)?Jn[e].with(e):Yn[e].intersects(n)?Yn[e].with(e):g.empty()},Rt=(e,t)=>us(e,t).intersect(g.full().shl64(e).xor(g.full().shl64(t))).withoutFirst();class at{constructor(){}static default(){const t=new at;return t.reset(),t}reset(){this.occupied=new g(65535,4294901760),this.promoted=g.empty(),this.white=new g(65535,0),this.black=new g(0,4294901760),this.pawn=new g(65280,16711680),this.knight=new g(66,1107296256),this.bishop=new g(36,603979776),this.rook=new g(129,2164260864),this.queen=new g(8,134217728),this.king=new g(16,268435456)}static empty(){const t=new at;return t.clear(),t}clear(){this.occupied=g.empty(),this.promoted=g.empty();for(const t of Ve)this[t]=g.empty();for(const t of pe)this[t]=g.empty()}clone(){const t=new at;t.occupied=this.occupied,t.promoted=this.promoted;for(const n of Ve)t[n]=this[n];for(const n of pe)t[n]=this[n];return t}getColor(t){if(this.white.has(t))return"white";if(this.black.has(t))return"black"}getRole(t){for(const n of pe)if(this[n].has(t))return n}get(t){const n=this.getColor(t);if(!n)return;const r=this.getRole(t),i=this.promoted.has(t);return{color:n,role:r,promoted:i}}take(t){const n=this.get(t);return n&&(this.occupied=this.occupied.without(t),this[n.color]=this[n.color].without(t),this[n.role]=this[n.role].without(t),n.promoted&&(this.promoted=this.promoted.without(t))),n}set(t,n){const r=this.take(t);return this.occupied=this.occupied.with(t),this[n.color]=this[n.color].with(t),this[n.role]=this[n.role].with(t),n.promoted&&(this.promoted=this.promoted.with(t)),r}has(t){return this.occupied.has(t)}*[Symbol.iterator](){for(const t of this.occupied)yield[t,this.get(t)]}pieces(t,n){return this[t].intersect(this[n])}rooksAndQueens(){return this.rook.union(this.queen)}bishopsAndQueens(){return this.bishop.union(this.queen)}steppers(){return this.knight.union(this.pawn).union(this.king)}sliders(){return this.bishop.union(this.rook).union(this.queen)}kingOf(t){return this.pieces(t,"king").singleSquare()}}class ke{constructor(){}static empty(){const t=new ke;for(const n of pe)t[n]=0;return t}static fromBoard(t,n){const r=new ke;for(const i of pe)r[i]=t.pieces(n,i).size();return r}clone(){const t=new ke;for(const n of pe)t[n]=this[n];return t}equals(t){return pe.every(n=>this[n]===t[n])}add(t){const n=new ke;for(const r of pe)n[r]=this[r]+t[r];return n}subtract(t){const n=new ke;for(const r of pe)n[r]=this[r]-t[r];return n}nonEmpty(){return pe.some(t=>this[t]>0)}isEmpty(){return!this.nonEmpty()}hasPawns(){return this.pawn>0}hasNonPawns(){return this.knight>0||this.bishop>0||this.rook>0||this.queen>0||this.king>0}size(){return this.pawn+this.knight+this.bishop+this.rook+this.queen+this.king}}class He{constructor(t,n){this.white=t,this.black=n}static empty(){return new He(ke.empty(),ke.empty())}static fromBoard(t){return new He(ke.fromBoard(t,"white"),ke.fromBoard(t,"black"))}clone(){return new He(this.white.clone(),this.black.clone())}equals(t){return this.white.equals(t.white)&&this.black.equals(t.black)}add(t){return new He(this.white.add(t.white),this.black.add(t.black))}subtract(t){return new He(this.white.subtract(t.white),this.black.subtract(t.black))}count(t){return this.white[t]+this.black[t]}size(){return this.white.size()+this.black.size()}isEmpty(){return this.white.isEmpty()&&this.black.isEmpty()}nonEmpty(){return!this.isEmpty()}hasPawns(){return this.white.hasPawns()||this.black.hasPawns()}hasNonPawns(){return this.white.hasNonPawns()||this.black.hasNonPawns()}}class xt{constructor(t,n){this.white=t,this.black=n}static default(){return new xt(3,3)}clone(){return new xt(this.white,this.black)}equals(t){return this.white===t.white&&this.black===t.black}}class fs{unwrap(t,n){const r=this._chain(i=>S.ok(t?t(i):i),i=>n?S.ok(n(i)):S.err(i));if(r.isErr)throw r.error;return r.value}map(t,n){return this._chain(r=>S.ok(t(r)),r=>S.err(n?n(r):r))}chain(t,n){return this._chain(t,n??(r=>S.err(r)))}}class Aa extends fs{constructor(t){super(),this.value=t,this.isOk=!0,this.isErr=!1}_chain(t,n){return t(this.value)}}class Oa extends fs{constructor(t){super(),this.error=t,this.isOk=!1,this.isErr=!0}_chain(t,n){return n(this.error)}}var S;(function(e){function t(i){return new Aa(i)}e.ok=t;function n(i){return new Oa(i||new Error)}e.err=n;function r(i){if(Array.isArray(i)){const l=[];for(let a=0;a<i.length;a++){const c=i[a];if(c.isErr)return c;l.push(c.value)}return e.ok(l)}const s={},o=Object.keys(i);for(let l=0;l<o.length;l++){const a=i[o[l]];if(a.isErr)return a;s[o[l]]=a.value}return e.ok(s)}e.all=r})(S||(S={}));var Ne;(function(e){e.Empty="ERR_EMPTY",e.OppositeCheck="ERR_OPPOSITE_CHECK",e.PawnsOnBackrank="ERR_PAWNS_ON_BACKRANK",e.Kings="ERR_KINGS",e.Variant="ERR_VARIANT"})(Ne||(Ne={}));class it extends Error{}const Ra=(e,t,n,r)=>n[t].intersect(Ot(e,r).intersect(n.rooksAndQueens()).union(At(e,r).intersect(n.bishopsAndQueens())).union($r(e).intersect(n.knight)).union(Pr(e).intersect(n.king)).union(yn(ee(t),e).intersect(n.pawn)));class Ue{constructor(){}static default(){const t=new Ue;return t.castlingRights=g.corners(),t.rook={white:{a:0,h:7},black:{a:56,h:63}},t.path={white:{a:new g(14,0),h:new g(96,0)},black:{a:new g(0,234881024),h:new g(0,1610612736)}},t}static empty(){const t=new Ue;return t.castlingRights=g.empty(),t.rook={white:{a:void 0,h:void 0},black:{a:void 0,h:void 0}},t.path={white:{a:g.empty(),h:g.empty()},black:{a:g.empty(),h:g.empty()}},t}clone(){const t=new Ue;return t.castlingRights=this.castlingRights,t.rook={white:{a:this.rook.white.a,h:this.rook.white.h},black:{a:this.rook.black.a,h:this.rook.black.h}},t.path={white:{a:this.path.white.a,h:this.path.white.h},black:{a:this.path.black.a,h:this.path.black.h}},t}add(t,n,r,i){const s=vr(t,n),o=Cr(t,n);this.castlingRights=this.castlingRights.with(i),this.rook[t][n]=i,this.path[t][n]=Rt(i,o).with(o).union(Rt(r,s).with(s)).without(r).without(i)}static fromSetup(t){const n=Ue.empty(),r=t.castlingRights.intersect(t.board.rook);for(const i of Ve){const s=g.backrank(i),o=t.board.kingOf(i);if(!N(o)||!s.has(o))continue;const l=r.intersect(t.board[i]).intersect(s),a=l.first();N(a)&&a<o&&n.add(i,"a",o,a);const c=l.last();N(c)&&o<c&&n.add(i,"h",o,c)}return n}discardRook(t){if(this.castlingRights.has(t)){this.castlingRights=this.castlingRights.without(t);for(const n of Ve)for(const r of ya)this.rook[n][r]===t&&(this.rook[n][r]=void 0)}}discardColor(t){this.castlingRights=this.castlingRights.diff(g.backrank(t)),this.rook[t].a=void 0,this.rook[t].h=void 0}}class xa{constructor(t){this.rules=t}reset(){this.board=at.default(),this.pockets=void 0,this.turn="white",this.castles=Ue.default(),this.epSquare=void 0,this.remainingChecks=void 0,this.halfmoves=0,this.fullmoves=1}setupUnchecked(t){this.board=t.board.clone(),this.board.promoted=g.empty(),this.pockets=void 0,this.turn=t.turn,this.castles=Ue.fromSetup(t),this.epSquare=Ma(this,t.epSquare),this.remainingChecks=void 0,this.halfmoves=t.halfmoves,this.fullmoves=t.fullmoves}kingAttackers(t,n,r){return Ra(t,n,this.board,r)}playCaptureAt(t,n){this.halfmoves=0,n.role==="rook"&&this.castles.discardRook(t),this.pockets&&this.pockets[ee(n.color)][n.promoted?"pawn":n.role]++}ctx(){const t=this.isVariantEnd(),n=this.board.kingOf(this.turn);if(!N(n))return{king:n,blockers:g.empty(),checkers:g.empty(),variantEnd:t,mustCapture:!1};const r=Ot(n,g.empty()).intersect(this.board.rooksAndQueens()).union(At(n,g.empty()).intersect(this.board.bishopsAndQueens())).intersect(this.board[ee(this.turn)]);let i=g.empty();for(const o of r){const l=Rt(n,o).intersect(this.board.occupied);l.moreThanOne()||(i=i.union(l))}const s=this.kingAttackers(n,ee(this.turn),this.board.occupied);return{king:n,blockers:i,checkers:s,variantEnd:t,mustCapture:!1}}clone(){var t,n;const r=new this.constructor;return r.board=this.board.clone(),r.pockets=(t=this.pockets)===null||t===void 0?void 0:t.clone(),r.turn=this.turn,r.castles=this.castles.clone(),r.epSquare=this.epSquare,r.remainingChecks=(n=this.remainingChecks)===null||n===void 0?void 0:n.clone(),r.halfmoves=this.halfmoves,r.fullmoves=this.fullmoves,r}validate(){if(this.board.occupied.isEmpty())return S.err(new it(Ne.Empty));if(this.board.king.size()!==2)return S.err(new it(Ne.Kings));if(!N(this.board.kingOf(this.turn)))return S.err(new it(Ne.Kings));const t=this.board.kingOf(ee(this.turn));return N(t)?this.kingAttackers(t,this.turn,this.board.occupied).nonEmpty()?S.err(new it(Ne.OppositeCheck)):g.backranks().intersects(this.board.pawn)?S.err(new it(Ne.PawnsOnBackrank)):S.ok(void 0):S.err(new it(Ne.Kings))}dropDests(t){return g.empty()}dests(t,n){if(n=n||this.ctx(),n.variantEnd)return g.empty();const r=this.board.get(t);if(!r||r.color!==this.turn)return g.empty();let i,s;if(r.role==="pawn"){i=yn(this.turn,t).intersect(this.board[ee(this.turn)]);const o=this.turn==="white"?8:-8,l=t+o;if(0<=l&&l<64&&!this.board.occupied.has(l)){i=i.with(l);const a=this.turn==="white"?t<16:t>=48,c=l+o;a&&!this.board.occupied.has(c)&&(i=i.with(c))}N(this.epSquare)&&Na(this,t,n)&&(s=g.fromSquare(this.epSquare))}else r.role==="bishop"?i=At(t,this.board.occupied):r.role==="knight"?i=$r(t):r.role==="rook"?i=Ot(t,this.board.occupied):r.role==="queen"?i=cs(t,this.board.occupied):i=Pr(t);if(i=i.diff(this.board[this.turn]),N(n.king)){if(r.role==="king"){const o=this.board.occupied.without(t);for(const l of i)this.kingAttackers(l,ee(this.turn),o).nonEmpty()&&(i=i.without(l));return i.union(Qr(this,"a",n)).union(Qr(this,"h",n))}if(n.checkers.nonEmpty()){const o=n.checkers.singleSquare();if(!N(o))return g.empty();i=i.intersect(Rt(o,n.king).with(o))}n.blockers.has(t)&&(i=i.intersect(us(t,n.king)))}return s&&(i=i.union(s)),i}isVariantEnd(){return!1}variantOutcome(t){}hasInsufficientMaterial(t){return this.board[t].intersect(this.board.pawn.union(this.board.rooksAndQueens())).nonEmpty()?!1:this.board[t].intersects(this.board.knight)?this.board[t].size()<=2&&this.board[ee(t)].diff(this.board.king).diff(this.board.queen).isEmpty():this.board[t].intersects(this.board.bishop)?(!this.board.bishop.intersects(g.darkSquares())||!this.board.bishop.intersects(g.lightSquares()))&&this.board.pawn.isEmpty()&&this.board.knight.isEmpty():!0}toSetup(){var t,n;return{board:this.board.clone(),pockets:(t=this.pockets)===null||t===void 0?void 0:t.clone(),turn:this.turn,castlingRights:this.castles.castlingRights,epSquare:La(this),remainingChecks:(n=this.remainingChecks)===null||n===void 0?void 0:n.clone(),halfmoves:Math.min(this.halfmoves,150),fullmoves:Math.min(Math.max(this.fullmoves,1),9999)}}isInsufficientMaterial(){return Ve.every(t=>this.hasInsufficientMaterial(t))}hasDests(t){t=t||this.ctx();for(const n of this.board[this.turn])if(this.dests(n,t).nonEmpty())return!0;return this.dropDests(t).nonEmpty()}isLegal(t,n){if(nn(t))return!this.pockets||this.pockets[this.turn][t.role]<=0||t.role==="pawn"&&g.backranks().has(t.to)?!1:this.dropDests(n).has(t.to);{if(t.promotion==="pawn"||t.promotion==="king"&&this.rules!=="antichess"||!!t.promotion!==(this.board.pawn.has(t.from)&&g.backranks().has(t.to)))return!1;const r=this.dests(t.from,n);return r.has(t.to)||r.has(Ta(this,t).to)}}isCheck(){const t=this.board.kingOf(this.turn);return N(t)&&this.kingAttackers(t,ee(this.turn),this.board.occupied).nonEmpty()}isEnd(t){return(t?t.variantEnd:this.isVariantEnd())?!0:this.isInsufficientMaterial()||!this.hasDests(t)}isCheckmate(t){return t=t||this.ctx(),!t.variantEnd&&t.checkers.nonEmpty()&&!this.hasDests(t)}isStalemate(t){return t=t||this.ctx(),!t.variantEnd&&t.checkers.isEmpty()&&!this.hasDests(t)}outcome(t){const n=this.variantOutcome(t);return n||(t=t||this.ctx(),this.isCheckmate(t)?{winner:ee(this.turn)}:this.isInsufficientMaterial()||this.isStalemate(t)?{winner:void 0}:void 0)}allDests(t){t=t||this.ctx();const n=new Map;if(t.variantEnd)return n;for(const r of this.board[this.turn])n.set(r,this.dests(r,t));return n}play(t){const n=this.turn,r=this.epSquare,i=hs(this,t);if(this.epSquare=void 0,this.halfmoves+=1,n==="black"&&(this.fullmoves+=1),this.turn=ee(n),nn(t))this.board.set(t.to,{role:t.role,color:n}),this.pockets&&this.pockets[n][t.role]--,t.role==="pawn"&&(this.halfmoves=0);else{const s=this.board.take(t.from);if(!s)return;let o;if(s.role==="pawn"){this.halfmoves=0,t.to===r&&(o=this.board.take(t.to+(n==="white"?-8:8)));const l=t.from-t.to;Math.abs(l)===16&&8<=t.from&&t.from<=55&&(this.epSquare=t.from+t.to>>1),t.promotion&&(s.role=t.promotion,s.promoted=!!this.pockets)}else if(s.role==="rook")this.castles.discardRook(t.from);else if(s.role==="king"){if(i){const l=this.castles.rook[n][i];if(N(l)){const a=this.board.take(l);this.board.set(vr(n,i),s),a&&this.board.set(Cr(n,i),a)}}this.castles.discardColor(n)}if(!i){const l=this.board.set(t.to,s)||o;l&&this.playCaptureAt(t.to,l)}}this.remainingChecks&&this.isCheck()&&(this.remainingChecks[n]=Math.max(this.remainingChecks[n]-1,0))}}class ds extends xa{constructor(){super("chess")}static default(){const t=new this;return t.reset(),t}static fromSetup(t){const n=new this;return n.setupUnchecked(t),n.validate().map(r=>n)}clone(){return super.clone()}}const Ma=(e,t)=>{if(!N(t))return;const n=e.turn==="white"?5:2,r=e.turn==="white"?8:-8;if(Xe(t)!==n||e.board.occupied.has(t+r))return;const i=t-r;if(!(!e.board.pawn.has(i)||!e.board[ee(e.turn)].has(i)))return t},La=e=>{if(!N(e.epSquare))return;const t=e.ctx(),r=e.board.pieces(e.turn,"pawn").intersect(yn(ee(e.turn),e.epSquare));for(const i of r)if(e.dests(i,t).has(e.epSquare))return e.epSquare},Na=(e,t,n)=>{if(!N(e.epSquare)||!yn(e.turn,t).has(e.epSquare))return!1;if(!N(n.king))return!0;const r=e.turn==="white"?8:-8,i=e.epSquare-r;return e.kingAttackers(n.king,ee(e.turn),e.board.occupied.toggle(t).toggle(i).with(e.epSquare)).without(i).isEmpty()},Qr=(e,t,n)=>{if(!N(n.king)||n.checkers.nonEmpty())return g.empty();const r=e.castles.rook[e.turn][t];if(!N(r)||e.castles.path[e.turn][t].intersects(e.board.occupied))return g.empty();const i=vr(e.turn,t),s=Rt(n.king,i),o=e.board.occupied.without(n.king);for(const c of s)if(e.kingAttackers(c,ee(e.turn),o).nonEmpty())return g.empty();const l=Cr(e.turn,t),a=e.board.occupied.toggle(n.king).toggle(r).toggle(l);return e.kingAttackers(i,ee(e.turn),a).nonEmpty()?g.empty():g.fromSquare(r)},hs=(e,t)=>{if(nn(t))return;const n=t.to-t.from;if(!(Math.abs(n)!==2&&!e.board[e.turn].has(t.to))&&e.board.king.has(t.from))return n>0?"h":"a"},Ta=(e,t)=>{const n=hs(e,t);if(!n)return t;const r=e.castles.rook[e.turn][n];return{from:t.from,to:N(r)?r:t.to}},Da="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",Ia=Da+" w KQkq -",Er=Ia+" 0 1";var Q;(function(e){e.Fen="ERR_FEN",e.Board="ERR_BOARD",e.Pockets="ERR_POCKETS",e.Turn="ERR_TURN",e.Castling="ERR_CASTLING",e.EpSquare="ERR_EP_SQUARE",e.RemainingChecks="ERR_REMAINING_CHECKS",e.Halfmoves="ERR_HALFMOVES",e.Fullmoves="ERR_FULLMOVES"})(Q||(Q={}));class te extends Error{}const Fa=(e,t,n)=>{let r=e.indexOf(t);for(;n-- >0&&r!==-1;)r=e.indexOf(t,r+t.length);return r},st=e=>/^\d{1,4}$/.test(e)?parseInt(e,10):void 0,ps=e=>{const t=Xn(e);return t&&{role:t,color:e.toLowerCase()===e?"black":"white"}},Nn=e=>{const t=at.empty();let n=7,r=0;for(let i=0;i<e.length;i++){const s=e[i];if(s==="/"&&r===8)r=0,n--;else{const o=parseInt(s,10);if(o>0)r+=o;else{if(r>=8||n<0)return S.err(new te(Q.Board));const l=r+n*8,a=ps(s);if(!a)return S.err(new te(Q.Board));e[i+1]==="~"&&(a.promoted=!0,i++),t.set(l,a),r++}}}return n!==0||r!==8?S.err(new te(Q.Board)):S.ok(t)},Yr=e=>{if(e.length>64)return S.err(new te(Q.Pockets));const t=He.empty();for(const n of e){const r=ps(n);if(!r)return S.err(new te(Q.Pockets));t[r.color][r.role]++}return S.ok(t)},Ba=(e,t)=>{let n=g.empty();if(t==="-")return S.ok(n);for(const r of t){const i=r.toLowerCase(),s=r===i?"black":"white",o=s==="white"?0:7;if("a"<=i&&i<="h")n=n.with(Vn(i.charCodeAt(0)-97,o));else if(i==="k"||i==="q"){const l=e[s].intersect(g.backrank(s)).intersect(e.rook.union(e.king)),a=i==="k"?l.last():l.first();n=n.with(N(a)&&e.rook.has(a)?a:Vn(i==="k"?7:0,o))}else return S.err(new te(Q.Castling))}return Ve.some(r=>g.backrank(r).intersect(n).size()>2)?S.err(new te(Q.Castling)):S.ok(n)},Zr=e=>{const t=e.split("+");if(t.length===3&&t[0]===""){const n=st(t[1]),r=st(t[2]);return!N(n)||n>3||!N(r)||r>3?S.err(new te(Q.RemainingChecks)):S.ok(new xt(3-n,3-r))}else if(t.length===2){const n=st(t[0]),r=st(t[1]);return!N(n)||n>3||!N(r)||r>3?S.err(new te(Q.RemainingChecks)):S.ok(new xt(n,r))}else return S.err(new te(Q.RemainingChecks))},qa=e=>{const t=e.split(/[\s_]+/),n=t.shift();let r,i=S.ok(void 0);if(n.endsWith("]")){const l=n.indexOf("[");if(l===-1)return S.err(new te(Q.Fen));r=Nn(n.slice(0,l)),i=Yr(n.slice(l+1,-1))}else{const l=Fa(n,"/",7);l===-1?r=Nn(n):(r=Nn(n.slice(0,l)),i=Yr(n.slice(l+1)))}let s;const o=t.shift();if(!N(o)||o==="w")s="white";else if(o==="b")s="black";else return S.err(new te(Q.Turn));return r.chain(l=>{const a=t.shift(),c=N(a)?Ba(l,a):S.ok(g.empty()),f=t.shift();let u;if(N(f)&&f!=="-"&&(u=_t(f),!N(u)))return S.err(new te(Q.EpSquare));let d=t.shift(),p;N(d)&&d.includes("+")&&(p=Zr(d),d=t.shift());const b=N(d)?st(d):0;if(!N(b))return S.err(new te(Q.Halfmoves));const h=t.shift(),_=N(h)?st(h):1;if(!N(_))return S.err(new te(Q.Fullmoves));const E=t.shift();let v=S.ok(void 0);if(N(E)){if(N(p))return S.err(new te(Q.RemainingChecks));v=Zr(E)}else N(p)&&(v=p);return t.length>0?S.err(new te(Q.Fen)):i.chain(j=>c.chain(O=>v.map(R=>({board:l,pockets:j,turn:s,castlingRights:O,remainingChecks:R,epSquare:u,halfmoves:b,fullmoves:Math.max(1,_)}))))})},ja=e=>{let t=yt(e.role);return e.color==="white"&&(t=t.toUpperCase()),e.promoted&&(t+="~"),t},Ka=e=>{let t="",n=0;for(let r=7;r>=0;r--)for(let i=0;i<8;i++){const s=i+r*8,o=e.get(s);o?(n>0&&(t+=n,n=0),t+=ja(o)):n++,i===7&&(n>0&&(t+=n,n=0),r!==0&&(t+="/"))}return t},Jr=e=>pe.map(t=>yt(t).repeat(e[t])).join(""),za=e=>Jr(e.white).toUpperCase()+Jr(e.black),Ha=(e,t)=>{let n="";for(const r of Ve){const i=g.backrank(r);let s=e.kingOf(r);N(s)&&!i.has(s)&&(s=void 0);const o=e.pieces(r,"rook").intersect(i);for(const l of t.intersect(i).reversed())if(l===o.first()&&N(s)&&l<s)n+=r==="white"?"Q":"q";else if(l===o.last()&&N(s)&&s<l)n+=r==="white"?"K":"k";else{const a=tn[ce(l)];n+=r==="white"?a.toUpperCase():a}}return n||"-"},Ua=e=>`${e.white}+${e.black}`,Wa=(e,t)=>[Ka(e.board)+(e.pockets?`[${za(e.pockets)}]`:""),e.turn[0],Ha(e.board,e.castlingRights),N(e.epSquare)?St(e.epSquare):"-",...e.remainingChecks?[Ua(e.remainingChecks)]:[],Math.max(0,Math.min(e.halfmoves,9999)),Math.max(1,Math.min(e.fullmoves,9999))].join(" "),Ga=(e,t)=>{let n="";if(nn(t))t.role!=="pawn"&&(n=yt(t.role).toUpperCase()),n+="@"+St(t.to);else{const r=e.board.getRole(t.from);if(!r)return"--";if(r==="king"&&(e.board[e.turn].has(t.to)||Math.abs(t.to-t.from)===2))n=t.to>t.from?"O-O":"O-O-O";else{const i=e.board.occupied.has(t.to)||r==="pawn"&&ce(t.from)!==ce(t.to);if(r!=="pawn"){n=yt(r).toUpperCase();let s;if(r==="king"?s=Pr(t.to).intersect(e.board.king):r==="queen"?s=cs(t.to,e.board.occupied).intersect(e.board.queen):r==="rook"?s=Ot(t.to,e.board.occupied).intersect(e.board.rook):r==="bishop"?s=At(t.to,e.board.occupied).intersect(e.board.bishop):s=$r(t.to).intersect(e.board.knight),s=s.intersect(e.board[e.turn]).without(t.from),s.nonEmpty()){const o=e.ctx();for(const l of s)e.dests(l,o).has(t.to)||(s=s.without(l));if(s.nonEmpty()){let l=!1,a=s.intersects(g.fromRank(Xe(t.from)));s.intersects(g.fromFile(ce(t.from)))?l=!0:a=!0,a&&(n+=tn[ce(t.from)]),l&&(n+=as[Xe(t.from)])}}}else i&&(n=tn[ce(t.from)]);i&&(n+="x"),n+=St(t.to),t.promotion&&(n+="="+yt(t.promotion).toUpperCase())}}return n},Va=(e,t)=>{var n;const r=Ga(e,t);return e.play(t),!((n=e.outcome())===null||n===void 0)&&n.winner?r+"#":e.isCheck()?r+"+":r},Xa=(e,t)=>Va(e.clone(),t),_n=e=>ds.fromSetup(qa(e).unwrap()).unwrap(),Qa=e=>_n(e).turn,Ya=(e,t)=>{let n=e[e.length-1]?.fen??Er,r=_n(n),i=_a(t),s=Xa(r,i);return r.play(i),{fen:Wa(r.toSetup()),before_fen:n,uci:t,san:s}},Za=e=>e.map((t,n)=>`${gs(n+1)}${t.san}`).join(" "),gs=e=>e%2===0?"":Ja(e),Ja=e=>`${Math.ceil(e/2)}.`+(e%2===0?"..":"");var ec=L('<div class="is2d chessboard"> ');function tc(e){let t,n,r=A(()=>{try{return _n(e.fen??Er)}catch{return ds.default()}}),i=A(()=>ka(r())),s=A(()=>r().isCheck());return rr(()=>{let o=r().isCheck(),l={fen:e.fen,check:o,premovable:{enabled:!1},movable:{color:e.movable_color,free:!1,dests:i(),events:{after:e.play_orig_key}}};n=wa(t,l)}),be(()=>{let o;if(e.last_move_uci){let l=e.last_move_uci;o=[l.slice(0,2),l.slice(2,4)]}n.set({lastMove:o,fen:e.fen,turnColor:e.turn_color,orientation:e.orientation??"white",check:s(),movable:{color:e.movable_color,dests:i()}})}),be(()=>{n.setAutoShapes(e.shapes??[])}),(()=>{var o=ec();return De(l=>t=l,o),o})()}const nc=e=>va(t=>{const n=t.target;n.tagName!=="PIECE"&&n.tagName!=="SQUARE"&&n.tagName!=="CG-BOARD"||(t.preventDefault(),e(Math.sign(t.deltaY)))});var rc=L('<button class="meet-button draw">');function ic(e){return(()=>{var t=rc();return We(t,"click",e.onClick,!0),$(t,()=>e.children),J(n=>{var r=e.disabled,i=!!e.gray,s=!!(e.draw||e.meet),o=!!e.meet;return r!==n.e&&(t.disabled=n.e=r),i!==n.t&&t.classList.toggle("gray",n.t=i),s!==n.a&&t.classList.toggle("draw",n.a=s),o!==n.o&&t.classList.toggle("meet",n.o=o),n},{e:void 0,t:void 0,a:void 0,o:void 0}),t})()}xe(["click"]);var sc=L("<div class=moves-wrap><ul class=replay>"),oc=L("<li class=move><span class=index>");function lc(e){let t;return be(()=>{let n=e.cursor,r=t.parentElement;if(!r)return;const i=t.querySelector(".cursor");if(!i){r.scrollTop=n>0?99999:0;return}let s=i.offsetTop-r.offsetHeight/2+i.offsetHeight;r.scrollTo({behavior:"smooth",top:s})}),(()=>{var n=sc(),r=n.firstChild;return De(i=>t=i,r),$(r,m(or,{get fallback(){return e.fallback},get each(){return e.san_moves},children:(i,s)=>(()=>{var o=oc(),l=o.firstChild;return o.$$click=()=>e.on_set_cursor(s()),$(l,()=>gs(s()+1)),$(o,i,null),J(()=>o.classList.toggle("cursor",e.cursor===s())),o})()})),n})()}xe(["click"]);const nr={equals:!1},ac=(e,t)=>e.length>0?()=>e(X(t)):e;function cc(e,t){let n=0;const r=e.map((i,s)=>A(()=>(n=s,i()),void 0,nr));return A(()=>r.map(i=>i())[n],void 0,t)}function uc(e,t,n){let r=()=>t;const[i,s]=T(t,nr),o=A(ac(e,()=>r()),t,nr);return[r=cc([i,o],n),(l=>s(()=>typeof l=="function"?l(X(r)):l))]}function fc(e,t){const n=16.666666666666668;let r=performance.now(),i=0,s;function o(l){s=requestAnimationFrame(o);let a=Math.min(l-r,1e3);for(r=l,i+=a;i>=n;)e(n),i-=n}return{start(){cancelAnimationFrame(s),s=requestAnimationFrame(o)},stop(){cancelAnimationFrame(s)}}}function dc(e,t){const n=u=>{if(u.clientX||u.clientX===0)return[u.clientX,u.clientY]},r=u=>{let[d,p]=n(u)??[0,0];return[d-l.left,p-l.top]};function i(u){u.preventDefault(),e.setPointerCapture(u.pointerId);let d=r(u);t.on_down(d)}function s(u){let d=r(u);t.on_up(d)}function o(u){let d=r(u);t.on_move(d)}let l;a();function a(){l=e.getBoundingClientRect()}function c(){a()}e.addEventListener("pointerdown",i,{passive:!1}),e.addEventListener("pointermove",o,{passive:!1}),document.addEventListener("pointerup",s);let f=new ResizeObserver(a);return f.observe(e),document.addEventListener("scroll",c,{capture:!0,passive:!0}),window.addEventListener("resize",c,{passive:!0}),()=>{e.removeEventListener("pointerdown",i),e.removeEventListener("pointermove",o),document.removeEventListener("pointerup",s),document.removeEventListener("scroll",c),window.removeEventListener("resize",c),f.unobserve(e)}}function hc(e,t,n){return e<t?Math.min(e+n,t):e>t?Math.max(e-n,t):e}function gt(e,t){let[n,r,i,s]=e,[o,l,a,c]=t;return n<o+a&&n+i>o&&r<l+c&&r+s>l}function pc(e,t){let n,r,i,s,o,l=!1,a=0,c={on_down(u){i=void 0,r=u,s=u,l=!1,t()},on_up(u){r=void 0,n=void 0,i=u},on_move(u){n=u,l=!0}},f=dc(e,c);return{get is_hovering(){return n},get is_down(){return r},get is_up(){return i},get is_just_down(){return s},get is_double_click(){return o},get has_moved_after_last_down(){return l},update(u){o=void 0,s&&a>0&&(o=s,a=0),a=hc(a,0,u),s=void 0,i=void 0},disconnect(){f()},manual_trigger_down_hook(u){c.on_down(u)}}}const gc=1e-4;class V{static rotate_point(t,n,r,i,s){let o=Math.cos(r),l=Math.sin(r),a=t-i,c=n-s,f=a*o-c*l,u=a*l+c*o;return f+=i,u+=s,V.make(f,u)}static from_angle=t=>new V(Math.cos(t),Math.sin(t));static make=(t,n)=>new V(t,n);static xy=t=>new V(t[0],t[1]);static get unit(){return new V(1,1)}static get zero(){return new V(0,0)}get xy(){return[this.x,this.y]}get mul_inverse(){return new V(1/this.x,1/this.y)}get inverse(){return new V(-this.x,-this.y)}get half(){return new V(this.x/2,this.y/2)}get length_squared(){return this.x*this.x+this.y*this.y}get length(){return Math.sqrt(this.length_squared)}get normalize(){if(this.length!==0)return this.scale(1/this.length)}get perpendicular(){return new V(-this.y,this.x)}get angle(){return Math.atan2(this.y,this.x)}x;y;constructor(t,n){this.x=t,this.y=n}clamp_epsilon(t=gc){return this.length<t?V.zero:this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}project_to(t){let n=t.length_squared,r=this.dot(t);return V.make(r*t.x/n,r*t.y/n)}distance(t){return this.sub(t).length}addy(t){return V.make(this.x,this.y+t)}add_angle(t){return V.from_angle(this.angle+t)}scale(t){return V.make(this.x*t,this.y*t)}add(t){return V.make(this.x+t.x,this.y+t.y)}sub(t){return V.make(this.x-t.x,this.y-t.y)}mul(t){return V.make(this.x*t.x,this.y*t.y)}div(t){return V.make(this.x/t.x,this.y/t.y)}truncate(t){let n=this.length;return n>t?this.scale(t/n):this}}var mc=L("<i>");const ge=e=>(()=>{var t=mc();return J(()=>vt(t,"data-icon",e.icon)),t})(),me={Gear:"",CrossX:"",Gears:"",Delete:"",HeartEmpty:"",HeartFilled:"",DotEmpty:""};var wc=L("<div class=sortable-list-wrap><ul class=sortable-list>"),bc=L("<div class=sortable-list-dragging>"),yc=L("<li class=draggable><div class=handle><span>.</span></div><div class=content>");function _c(e){const[t,n]=T(void 0),[r,i]=uc(()=>e.list.map(y=>({item:y}))),s=A(()=>t()?r().indexOf(t()):-1),o=(y,k)=>{if(y===k)return;let P=r();[P[y],P[k]]=[P[k],P[y]],i(P.slice(0))};let l,a;const c=()=>(a===void 0&&(a=e.portal_selector.getBoundingClientRect()),a);let f,[u,d]=T(void 0);const p=()=>(f===void 0&&(f=U.getBoundingClientRect()),f),b=()=>{let y=c(),k=p(),P=10;return[k.left-y.left,k.bottom-y.top-P,k.width,P]},h=()=>{let y=c(),k=p();return[k.left-y.left,k.top-y.top,k.width,10]},_=()=>(u()===void 0&&d(D.getBoundingClientRect()),u()),E=y=>[y[0]-5,y[1]-5,10,10];rr(()=>{let y,P=fc(I=>{if(l.is_just_down&&(y=l.is_just_down),l.is_hovering){if(gt(b(),E(l.is_hovering))&&(U.scrollTop+=10),gt(h(),E(l.is_hovering))&&(U.scrollTop-=10),R(l.is_hovering),t()!==void 0){let K=B(l.is_hovering);K&&o(s(),K[0])}if(y&&V.make(...l.is_hovering).distance(V.make(...y))>4){let K=B(l.is_hovering);if(K){let[W,ie]=K,Ee=r()[W];n(Ee),j(ie)}y=void 0}}l.is_up&&(n(void 0),P.stop(),e.set_ordered(r().map(K=>K.item)),e.portal_selector.classList.remove("active")),l.update(I)});l=pc(e.portal_selector,P.start);const x=()=>{d(void 0),f=void 0,a=void 0};U.addEventListener("scroll",x);let w=new ResizeObserver(x);w.observe(U),Re(()=>{l.disconnect(),P.stop(),U.removeEventListener("scroll",x),w.unobserve(U)});const C=A(()=>{_();let I=c();return[...D.querySelectorAll(".draggable")].map(K=>{let W=K.getBoundingClientRect(),ie=[W.left-I.left,W.top-I.top];return[ie[0],ie[1],W.width,W.height]})}),B=I=>{let K=C().findIndex(ie=>gt(ie,E(I)));if(K===-1)return;let W=C()[K];return[K,[I[0]-W[0],I[1]-W[1]]]}});const[v,j]=T([0,0]),[O,R]=T([0,0]),G=A(()=>({transform:`translate(${O()[0]-v()[0]}px, ${O()[1]-v()[1]}px)`}));let U,D;const Y=y=>{if(l===void 0)return;let k=c(),P=[y.clientX-k.left,y.clientY-k.top];gt(b(),E(P))||gt(h(),E(P))||(l.manual_trigger_down_hook(P),y.preventDefault(),e.portal_selector.classList.add("active"))},q=(y,k)=>fn(()=>e.children(y,k));return[m(ye,{get when(){return t()},children:y=>m(lr,{get mount(){return e.portal_selector},get children(){var k=bc();return $(k,()=>e.dragging(y().item)),J(P=>fi(k,G(),P)),k}})}),(()=>{var y=wc(),k=y.firstChild;return De(P=>U=P,y),De(P=>D=P,k),$(k,m(or,{get each(){return r()},children:(P,x)=>(()=>{var w=yc(),C=w.firstChild,B=C.firstChild,I=B.firstChild,K=C.nextSibling;return C.$$pointerdown=Y,$(C,m(ge,{get icon(){return me.DotEmpty}}),B),$(B,()=>x()+1,I),$(K,()=>q(P.item,x)()),J(()=>w.classList.toggle("dragging",s()===x())),w})()})),y})()]}xe(["pointerdown"]);var kc=L('<div class="dropdown-menu show">'),vc=L("<button class=dropdown-menu-toggle-button>");const ms=e=>{let t,n;const[r,i]=T(!1);be(()=>{if(r(),n===void 0||t===void 0)return;let a=e.portal_selector.getBoundingClientRect(),c=n.getBoundingClientRect(),f=c.bottom-a.top,u=c.left-a.left;u+200>window.innerWidth&&(u-=200-c.width),t.style.top=`${f}px`,t.style.left=`${u}px`});const s=()=>{i(!1)};Re(()=>{window.removeEventListener("resize",s),document.removeEventListener("click",o)}),rr(()=>{window.addEventListener("resize",s),document.addEventListener("click",o)});function o(a){t===void 0||t.contains(a.target),i(!1)}function l(a){e.portal_selector.classList.contains("active")||a.stopImmediatePropagation(),i(!r())}return be(()=>{r()?e.portal_selector.classList.add("active"):e.portal_selector.classList.remove("active")}),[m(lr,{get mount(){return e.portal_selector},get children(){return m(ye,{get when(){return r()},get children(){var a=kc(),c=t;return typeof c=="function"?De(c,a):t=a,$(a,()=>e.children),a}})}}),(()=>{var a=vc();a.$$click=l;var c=n;return typeof c=="function"?De(c,a):n=a,$(a,()=>e.button),J(()=>a.classList.toggle("active",!!r())),a})()]};xe(["click"]);var Cc=L("<span class=heart><span class=nb>");const Pc=e=>{const[t,n]=T(!1),[r,i]=T(e.is_heart),s=()=>{i(!r()),e.on_heart(r()),n(!0),setTimeout(()=>n(!1),200)};return(()=>{var o=Cc(),l=o.firstChild;return o.$$click=s,$(o,m(ye,{get when(){return r()},get fallback(){return m(ge,{get icon(){return me.HeartEmpty}})},get children(){return m(ge,{get icon(){return me.HeartFilled}})}}),l),$(l,()=>e.nb_heart),J(a=>{var c=!!r(),f=!!t();return c!==a.e&&o.classList.toggle("is-heart",a.e=c),f!==a.t&&o.classList.toggle("beat",a.t=f),a},{e:void 0,t:void 0}),o})()};xe(["click"]);var $c=L("<button class=action-button>");const ve={Ok:1,Cancel:2,Normal:3},Qe=e=>{const t=oi(()=>e.action);return(()=>{var n=$c();return We(n,"click",e.onClick,!0),$(n,m(ye,{get when(){return e.waiting},get fallback(){return e.children},children:"..."})),J(r=>{var i=e.waiting,s=!!e.waiting,o=!!t(ve.Ok),l=!!t(ve.Cancel),a=!!t(ve.Normal);return i!==r.e&&(n.disabled=r.e=i),s!==r.t&&n.classList.toggle("waiting",r.t=s),o!==r.a&&n.classList.toggle("ok",r.a=o),l!==r.o&&n.classList.toggle("cancel",r.o=l),a!==r.i&&n.classList.toggle("normal",r.i=a),r},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),n})()};xe(["click"]);const sn=(e,t,n=[],r=[])=>{if(e){if(Array.isArray(e))e.forEach(i=>sn(i,t,n,r));else if(typeof e=="function")sn(e.apply(null,n),t,n,r);else{const i=e;(!t||(typeof t=="function"?t(i):i.nodeName===t))&&r.push(i)}return r}};var Nt=L("<div>");const Tt=e=>{const[t,n]=sr(e,["open","children","portal_selector","close_on_click_outside"]),[r,i]=T(!1),[s,o]=T(t.open);be(()=>o(t.open));const l=d=>o(typeof d=="boolean"?d:p=>!p),a=A(()=>sn(t.children,d=>d.className.indexOf("sb-modal-content")!==-1,[{open:s,toggle:l,set_hold_close_outside:i}])??[]),c=A(()=>sn(t.children,d=>d.className.indexOf("sb-modal-content")===-1,[{open:s,toggle:l,set_hold_close_outside:i}]));let f;be(()=>s()&&f?.focus(),f?.scrollIntoView());const u=Te(n,{role:"dialog",tabIndex:-1,class:e.class?`sb-modal ${e.class}`:"sb-modal",children:a(),onClick:A(()=>t.close_on_click_outside?d=>{if(r())return;const p=d.target;a().some(b=>b?.contains(p))||l(!1)}:void 0)()});return m(ye,{get when(){return s()},get fallback(){return c()},get children(){return[ut(c),m(lr,{get mount(){return t.portal_selector},get children(){var d=Nt(),p=f;return typeof p=="function"?De(p,d):f=d,Ze(d,u,!1,!1),d}})]}})},kn=e=>(()=>{var t=Nt();return Ze(t,Te(e,{get class(){return ut(()=>!!e.class)()?`sb-modal-content ${e.class}`:"sb-modal-content"}}),!1,!1),t})(),vn=e=>(()=>{var t=Nt();return Ze(t,Te(e,{get class(){return ut(()=>!!e.class)()?`sb-modal-header ${e.class}`:"sb-modal-header"}}),!1,!1),t})(),Cn=e=>(()=>{var t=Nt();return Ze(t,Te(e,{get class(){return ut(()=>!!e.class)()?`sb-modal-body ${e.class}`:"sb-modal-body"}}),!1,!1),t})(),Sr=e=>(()=>{var t=Nt();return Ze(t,Te(e,{get class(){return ut(()=>!!e.class)()?`sb-modal-footer ${e.class}`:"sb-modal-footer"}}),!1,!1),t})();var Ec=L("<label class=custom-field><input name=custom-field class=highlighted-text type=text placeholder=_><span class=placeholder>");const Pn=e=>{const t=n=>{e.on_keyup(n.target.value,n.key==="Enter")};return(()=>{var n=Ec(),r=n.firstChild,i=r.nextSibling;return We(r,"keyup",t),$(i,()=>e.placeholder),J(()=>vt(r,"size",e.size??50)),n})()},Sc="https://api.linechess.com:3300",Ar=(e,t)=>fetch(Sc+e,{...t,credentials:"include"}).then(n=>n.json());async function Ac(e,t={}){return await Ar(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).catch(r=>new Oc(r))}const ws=Ar("/session/init"),Me=(e,t)=>ws.then(()=>Ar(e,t)),oe=(e,t={})=>ws.then(()=>Ac(e,t));class Oc extends Error{constructor(t){super(t),this.name="FetchError"}}const Z=e=>e instanceof Error?S.err(e):typeof e=="object"&&e.errors!==void 0?S.err(e.errors):typeof e=="object"&&e.ok===!0?S.ok(e.data):S.ok(e);function Rc(){return{undo:function(){return oe("/undo")},set_search_lines_term:function(e){return oe("/search",{term:e})},next_searched_lines_page:function(e){return oe("/search/next-page",{i:e})},next_playlist_page:function(e){return oe("/playlist/next-page",{i:e})},like_line:function(e,t){return oe("/line/like",{id:e,yes:t}).then(Z)},like_playlist:function(e,t){return oe("/playlist/like",{id:e,yes:t}).then(Z)},edit_playlist:function(e,t){return oe("/playlist/edit",{id:e,body:t}).then(Z)},create_playlist:function(e,t){return oe("/playlist/create",{name:e,line:t}).then(Z)},delete_playlist:function(e){return oe("/playlist/delete",{id:e}).then(Z)},add_line_to_playlist:function(e,t){return oe("/playlist/add",{id:e,line_id:t}).then(Z)},delete_line:function(e){return oe("/line/delete",{id:e}).then(Z)},edit_line:function(e,t){return oe("/line/edit",{id:e,...t}).then(Z)},create_line:function(e,t,n,r){return oe("/line/create",{playlist_id:e,name:t,moves:n,orientation:r}).then(Z)},set_ordered_line_slots:function(e,t){return oe("/line/set_ordered",{playlist_id:e,lines:t}).then(Z)},get_searched_playlists:function(){return Me("/playlist/search").then(Z)},get_global_recent_playlists:function(){return Me("/playlist/global/recent").then(Z)},get_mine_recent_playlists:function(){return Me("/playlist/mine/recent").then(Z)},get_global_playlists:function(){return Me("/playlist/global").then(Z)},get_mine_playlists:function(){return Me("/playlist/mine").then(Z)},get_liked_playlists:function(){return Me("/playlist/liked").then(Z)},get_selected_playlist_model:function(e){return Me(`/playlist/selected/${e}`).then(Z)},get_working_playlist_model:function(){return Me("/playlist/selected").then(Z)}}}function xc(){let e=Rc();const[t,n]=T(void 0,{equals:!1}),[r,i]=T(!0,{equals:!1}),[s,o]=T(!0,{equals:!1}),[l,a]=T(!0,{equals:!1}),[c,f]=T(!0,{equals:!1}),[u,d]=T(!0,{equals:!1}),[p,b]=T(!1,{equals:!1}),[h,_]=T(!1,{equals:!1}),E=qe(async()=>{let w=t();return w===void 0?e.get_working_playlist_model():e.get_selected_playlist_model(w)}),v=qe(async()=>r()?e.get_mine_playlists():S.err(new Error("No Fetch Requested"))),j=qe(async()=>s()?e.get_liked_playlists():S.err(new Error("No Fetch Requested"))),O=qe(async()=>l()?e.get_global_playlists():S.err(new Error("No Fetch Requested"))),R=qe(async()=>c()?e.get_mine_recent_playlists():S.err(new Error("No Fetch Requested"))),G=qe(async()=>u()?e.get_global_recent_playlists():S.err(new Error("No Fetch Requested"))),U=qe(async()=>h()?e.get_searched_playlists():S.err(new Error("No Fetch Requested")));function D(w){k.global_playlists&&P("global_playlists","list",k.global_playlists.list.map(C=>C._id===w._id?w:C))}function Y(w){k.global_recent_playlists&&P("global_recent_playlists",k.global_recent_playlists.map(C=>C._id===w._id?w:C))}function q(w){k.mine_playlists&&P("mine_playlists",k.mine_playlists.map(C=>C._id===w._id?w:C))}function y(w){k.mine_recent_playlists&&P("mine_recent_playlists",k.mine_recent_playlists.map(C=>C._id===w._id?w:C))}let[k,P]=Ko({get playlist(){return E()?.unwrap()},get mine_playlists(){return v()?.unwrap()},get liked_playlists(){return j()?.unwrap()},get global_playlists(){return O()?.unwrap()},get mine_recent_playlists(){return R()?.unwrap()},get global_recent_playlists(){return G()?.unwrap()},get searched_playlists(){return U()?.unwrap()}});return[k,{create_line:async function(w,C,B){let I=t(),K=await e.create_line(I,w,C,B);return K.isErr||await K.map(W=>{W._playlist_id===t()?k.playlist&&P("playlist","lines",k.playlist.lines.length,W):n(W._playlist_id)}),K},delete_line:async function(w){let C=await e.delete_line(w);return C.isErr||k.playlist&&P("playlist","lines",k.playlist.lines.filter(B=>B._id!==w)),C},edit_line:async function(w,C,B,I){return(await e.edit_line(w,{name:C,orientation:B,moves:I})).map(W=>{k.playlist&&P("playlist","lines",ie=>ie._id===W._id,W)})},set_ordered_line_slots:async function(w){let C=await e.set_ordered_line_slots(w[0]._playlist_id,w.map(B=>B._id));return k.playlist&&ln(()=>{w.forEach((B,I)=>{P("playlist","lines",K=>K._id===B._id,"slot",I)})}),C.map(()=>{})},add_line_to_playlist:async function(w,C){return(await e.add_line_to_playlist(w,C)).map(I=>{n(w),a(!0),d(!0),i(!0),f(!0)})},create_playlist:async function(w,C){let B=await e.create_playlist(w,C);return B.map(I=>{n(I._id),a(!0),d(!0),i(!0),f(!0)}),B},delete_playlist:async function(w){let C=await e.delete_playlist(w);return C.map(B=>{n(void 0),a(!0),d(!0),i(!0),f(!0)}),C.map(()=>{})},edit_playlist:async function(w,C){let B=await e.edit_playlist(w,{name:C});return B.map(I=>{n(void 0),D(I),Y(I),q(I),y(I)}),B.map(()=>{})},like_playlist:async function(w,C){let B=await e.like_playlist(w,C);return o(!0),k.playlist&&k.playlist.playlist._id===w&&P("playlist","playlist","nb_likes",I=>C?I+1:I-1),B.map(()=>{})},like_line:async function(w,C){let B=await e.like_line(w,C);return o(!0),k.playlist&&P("playlist","lines",I=>I._id===w,"nb_likes",I=>C?I+1:I-1),B.map(()=>{})},next_playlist_page:async function(w){await e.next_playlist_page(w),a(!0)},next_searched_lines_page:async function(w){await e.next_searched_lines_page(w),b(p())},next_searched_playlist_page:async function(w){await e.next_searched_lines_page(w),_(h())},set_search_lines_term:async function(w){await e.set_search_lines_term(w),_(!0),b(!0)},undo:async function(){await e.undo(),n(t()),i(!0),o(!0),a(!0),f(!0),d(!0),b(!1),_(!1)}}]}const bs=ir();function Dt(){return un(bs)}function Mc(e){const t=xc();return m(bs.Provider,{value:t,get children(){return e.children}})}var Lc=L("<div class=openings><div class=build><h3>Build</h3><div class=board-wrap><div class=board></div></div><div class=board-tools><a>Flip</a></div></div><div class=explore><h3>Explore</h3><div class=replay-wrap><div class=replay-tools><a></a><a>Clear</a><a>Delete after</a></div></div><div class=tools><div class=action>"),Nc=L("<span>Play an opening line to save it."),Tc=L("<a><small>+ Add to Playlist"),Dc=L("<div class=playlist><h3>Playlist</h3><div class=filters><div class=tab>Mine</div><div class=tab>Liked</div><div class=tab>Global</div></div><div class=lists></div><div class=info></div><div class=lines>"),Ic=L("<div class=sortable-list-portal>"),Fc=L("<div class=dropdown-menu-portal>"),Bc=L("<div class=modal-portal>"),qc=L("<span class=no-playlist>Please Select a Playlist"),jc=L("<ul>"),Kc=L("<li class=item-new><div class=icon>+</div><div class=title>Create New Playlist"),zc=L("<li class=item><div class=title></div><div class=likes> </div><div class=nb> lines"),Hc=L("<span class=no-lines>No Lines here. Let's add some lines."),Uc=L("<div class=title>"),ys=L("<ul><li><div>Edit </div></li><li class=red>Delete "),Wc=L("<div class=more>"),Gc=L("<div class=a-line><span class=name></span><div class=more>"),Vc=L("<div class=number2> woop woop!"),Xc=L("<h3>Edit Line"),Qc=L("<h3>Edit Playlist"),Yc=L("<h3>Create New Playlist"),Zc=L("<span class=error>"),Jc=L("<h2>Add To Playlist"),eu=L("<div class=close>"),tu=L("<div class=add-to-playlist-modal-body><h3>Recent</h3><div class=recent></div><h3>All</h3><div class=all></div><div class=new-playlist-float>");const nu=()=>{let[e,t]=T(0);const[n,r]=T([]),i=A(()=>n()[e()]),s=A(()=>i()?.fen??Er),o=A(()=>Qa(s())),l=A(()=>n().map(b=>b.san)),a=A(()=>i()?.uci),c=A(()=>n().slice(0,e()+1)),f=A(()=>Za(n()));let u={get cursor(){return e()},get fen(){return s()},get turn_color(){return o()},get san_moves(){return l()},get last_move_uci(){return a()},get export_PGN(){return f()}};const d=b=>{b<0?t(-1):n()[b]!==void 0&&t(b)};return[u,{add_uci_and_goto_it(b){ln(()=>{let h=c(),_=Ya(h,b);r([...h,_]),t(n().length-1)})},goto_next_step(){d(e()+1)},goto_prev_step(){d(e()-1)},goto_first_step(){d(0)},goto_last_step(){d(n().length-1)},goto_set_cursor(b){d(b)},clear_steps(){r([]),t(0)},delete_after(){r(c())}}]},ru=()=>{let[e,{add_uci_and_goto_it:t,goto_next_step:n,goto_prev_step:r,goto_set_cursor:i,clear_steps:s,delete_after:o}]=nu();const l=(O,R)=>{let G=O+R;{let U=_n(e.fen),D=U.turn;U.board.get(_t(O)).role==="pawn"&&(R[1]==="8"&&D==="white"||R[1]==="1"&&D==="black")&&(G+="q")}t(G)},a=O=>{O<0?r():n()};let[c,f]=T("white");const u=()=>{f(ee(c()))},[d,p]=T(!1),b=A(()=>d()?"Copied!":"Copy"),h=async()=>{await navigator.clipboard.writeText(e.export_PGN),p(!0),await new Promise(O=>setTimeout(O,1e3)),p(!1)};let _;const E=(O,R)=>{_=O},[,{create_line:v}]=Dt(),j=()=>{let O=_,R=e.export_PGN;v(O,R,c())};return(()=>{var O=Lc(),R=O.firstChild,G=R.firstChild,U=G.nextSibling,D=U.firstChild,Y=U.nextSibling,q=Y.firstChild,y=R.nextSibling,k=y.firstChild,P=k.nextSibling,x=P.firstChild,w=x.firstChild,C=w.nextSibling,B=C.nextSibling,I=P.nextSibling,K=I.firstChild;return We(D,"wheel",{handleEvent:nc(a),passive:!1}),$(D,m(tc,{get fen(){return e.fen},play_orig_key:l,get turn_color(){return e.turn_color},get movable_color(){return e.turn_color},get orientation(){return c()},get last_move_uci(){return e.last_move_uci}})),q.$$click=u,$(P,m(lc,{get fallback(){return Nc()},get san_moves(){return e.san_moves},get cursor(){return e.cursor},on_set_cursor:i}),x),w.$$click=h,$(w,b),We(C,"click",s,!0),We(B,"click",o,!0),$(I,m(Pn,{size:30,on_keyup:E,placeholder:"Opening Line Name"}),K),$(K,m(ic,{meet:!0,onClick:j,children:"Save"}),null),$(K,m(Tt,{close_on_click_outside:!0,get portal_selector(){return document.querySelector(".modal-portal")},children:({toggle:W,set_hold_close_outside:ie})=>[(()=>{var Ee=Tc();return Ee.$$click=()=>W(!0),Ee})(),m(du,{toggle:W,set_hold_close_outside:ie})]}),null),$(O,m(iu,{}),null),O})()},iu=()=>{let[e]=Dt();const t=A(()=>e.playlist),[n,r]=T("mine"),i=oi(n),s={mine:Tn,liked:Tn,global:Tn};return[(()=>{var o=Dc(),l=o.firstChild,a=l.nextSibling,c=a.firstChild,f=c.nextSibling,u=f.nextSibling,d=a.nextSibling,p=d.nextSibling,b=p.nextSibling;return c.$$click=h=>r("mine"),f.$$click=h=>r("liked"),u.$$click=h=>r("global"),$(d,m(io,{get component(){return s[n()]}})),$(p,m(ye,{get when(){return t()},get fallback(){return qc()},children:h=>m(lu,{get playlist(){return h().playlist}})})),$(b,m(ye,{get when(){return t()},children:h=>m(ou,{get lines(){return h().lines}})})),J(h=>{var _=!!i("mine"),E=!!i("liked"),v=!!i("global");return _!==h.e&&c.classList.toggle("active",h.e=_),E!==h.t&&f.classList.toggle("active",h.t=E),v!==h.a&&u.classList.toggle("active",h.a=v),h},{e:void 0,t:void 0,a:void 0}),o})(),Ic(),Fc(),Bc()]},Tn=()=>{let[e]=Dt();const t=A(()=>e.mine_playlists);return(()=>{var n=jc();return $(n,m(Tt,{close_on_click_outside:!0,get portal_selector(){return document.querySelector(".modal-portal")},children:({open:r,toggle:i})=>[(()=>{var s=Kc();return s.$$click=()=>i(!0),s})(),m(_s,{open:r,toggle:i})]}),null),$(n,m(or,{get each(){return t()},children:r=>m(su,{item:r})}),null),n})()},su=e=>{const t=A(()=>e.item);return(()=>{var n=zc(),r=n.firstChild,i=r.nextSibling,s=i.firstChild,o=i.nextSibling,l=o.firstChild;return $(r,()=>t().name),$(i,()=>t().nb_likes,s),$(i,m(ge,{get icon(){return me.HeartFilled}}),null),$(o,()=>t().nb_lines,l),n})()},ou=e=>{let[,{set_ordered_line_slots:t}]=Dt();const n=A(()=>e.lines.slice(0).sort((r,i)=>r.slot-i.slot));return m(ye,{get when(){return n()},get fallback(){return Hc()},children:r=>m(_c,{set_ordered:t,children:au,dragging:cu,get portal_selector(){return document.querySelector(".sortable-list-portal")},get list(){return r()}})})},lu=e=>{const[t,n]=T(!1,{equals:!1});return[(()=>{var r=Uc();return $(r,()=>e.playlist.name),r})(),(()=>{var r=Wc();return $(r,m(Pc,{get nb_heart(){return e.playlist.nb_likes},is_heart:!1,on_heart:()=>{}}),null),$(r,m(ms,{get portal_selector(){return document.querySelector(".dropdown-menu-portal")},get button(){return m(ge,{get icon(){return me.Gear}})},get children(){var i=ys(),s=i.firstChild,o=s.firstChild;o.firstChild;var l=s.nextSibling;return l.firstChild,o.$$click=()=>n(!0),$(o,m(ge,{get icon(){return me.Gears}}),null),$(l,m(ge,{get icon(){return me.Delete}}),null),i}}),null),$(r,m(Tt,{close_on_click_outside:!0,get open(){return t()},get portal_selector(){return document.querySelector(".modal-portal")},children:({toggle:i})=>m(fu,{toggle:i})}),null),r})()]},au=e=>{const[t,n]=T(!1,{equals:!1});return(()=>{var r=Gc(),i=r.firstChild,s=i.nextSibling;return $(i,()=>e.name),$(s,m(ms,{get portal_selector(){return document.querySelector(".dropdown-menu-portal")},get button(){return m(ge,{get icon(){return me.Gear}})},get children(){var o=ys(),l=o.firstChild,a=l.firstChild;a.firstChild;var c=l.nextSibling;return c.firstChild,a.$$click=()=>n(!0),$(a,m(ge,{get icon(){return me.Gears}}),null),$(c,m(ge,{get icon(){return me.Delete}}),null),o}})),$(r,m(Tt,{close_on_click_outside:!0,get open(){return t()},get portal_selector(){return document.querySelector(".modal-portal")},children:({toggle:o})=>m(uu,{toggle:o})}),null),r})()},cu=e=>(()=>{var t=Vc(),n=t.firstChild;return $(t,()=>e.name,n),t})(),uu=e=>{const t=(n,r)=>{r&&(console.log(n),e.toggle(!1))};return m(kn,{get children(){return[m(vn,{get children(){return Xc()}}),m(Cn,{get children(){return m(Pn,{placeholder:"Line Name",on_keyup:t})}}),m(Sr,{get children(){return[m(Qe,{get action(){return ve.Cancel},onClick:()=>e.toggle(!1),children:"Cancel"}),m(Qe,{get action(){return ve.Ok},onClick:()=>e.toggle(!1),children:"Ok"})]}})]}})},fu=e=>{const t=(n,r)=>{r&&(console.log(n),e.toggle(!1))};return m(kn,{get children(){return[m(vn,{get children(){return Qc()}}),m(Cn,{get children(){return m(Pn,{placeholder:"Playlist Name",on_keyup:t})}}),m(Sr,{get children(){return[m(Qe,{get action(){return ve.Cancel},onClick:()=>e.toggle(!1),children:"Cancel"}),m(Qe,{get action(){return ve.Ok},onClick:()=>e.toggle(!1),children:"Ok"})]}})]}})},_s=e=>{let[t,n]=T(void 0),[r,i]=T(!1),[,{create_playlist:s}]=Dt(),o;const l=async(c,f)=>{o=c,f&&a()},a=async()=>{i(!0),n(void 0);let c=await s(o);c.isOk?e.toggle(!1):c.isErr&&(console.error(c.error),n(c.error.message??"Something went wrong.")),i(!1)};return be(an(e.open,c=>{c||(n(void 0),i(!1))})),m(kn,{get children(){return[m(vn,{get children(){return Yc()}}),m(Cn,{get children(){return[m(Pn,{placeholder:"Playlist Name",on_keyup:l}),m(ye,{get when(){return t()},get children(){var c=Zc();return $(c,t),c}})]}}),m(Sr,{get children(){return[m(Qe,{get action(){return ve.Cancel},onClick:()=>e.toggle(!1),children:"Cancel"}),m(Qe,{get waiting(){return r()},get action(){return ve.Ok},onClick:()=>a(),children:"Create"})]}})]}})},du=e=>{const t=n=>(be(()=>{e.set_hold_close_outside(n.open())}),Re(()=>{e.set_hold_close_outside(!1)}),[m(Qe,{get action(){return ve.Normal},onClick:()=>n.toggle(!0),children:"+ New Playlist"}),m(_s,{get open(){return n.open},get toggle(){return n.toggle}})]);return m(kn,{get children(){return[m(vn,{get children(){return[Jc(),(()=>{var n=eu();return n.$$click=()=>e.toggle(!1),$(n,m(ge,{get icon(){return me.CrossX}})),n})()]}}),m(Cn,{get children(){var n=tu(),r=n.firstChild,i=r.nextSibling,s=i.nextSibling,o=s.nextSibling,l=o.nextSibling;return $(l,m(Tt,{close_on_click_outside:!0,get portal_selector(){return document.querySelector(".modal-portal")},children:({open:a,toggle:c})=>m(t,{toggle:c,open:a})})),n}})]}})};xe(["click"]);var hu=L("<div class=challenges><div class=skills><h3>Skills</h3></div><div class=boards><h3>Leaderboards");const pu=()=>hu();var gu=L("<div class=main-wrap>"),mu=L("<small class=com>.com"),wu=L("<main class=main><h1></h1><p> Explore, Build, and Share opening lines.</p><p> Complete Challenges on a unique Skill Tree. </p><p> Compete on the Leaderboards. </p><p> Free, Open Source, No Ads, No Trackers.</p><p>For the  of Chess</p><p><small> to make your data publicly available.</small></p><section class=section-openings><h2>Openings</h2></section><section class=section-challenges><h2>Challenges"),bu=L("<footer><!><!>");const yu=dn(()=>hn(()=>import("./MainLegal-DZ2lS-pW.js"),__vite__mapDeps([0,1]))),_u=dn(()=>hn(()=>import("./Main404-BSqbm4XA.js"),[])),ku=dn(()=>hn(()=>import("./MainAbout-WIqSEt7m.js"),__vite__mapDeps([2,1]))),vu=dn(()=>hn(()=>import("./MainContact-BauyCZhg.js"),__vite__mapDeps([3,4,1])));function Cu(){return m(Do,{root:Pu,get children(){return[m(dt,{path:"/",component:$u}),m(dt,{path:"/about",component:ku}),m(dt,{path:"/legal",component:yu}),m(dt,{path:"/contact",component:vu}),m(dt,{path:"*",component:_u})]}})}function Pu(e){return(()=>{var t=gu();return $(t,m(Mc,{get children(){return e.children}})),t})()}function $u(){return[(()=>{var e=wu(),t=e.firstChild,n=t.nextSibling,r=n.nextSibling,i=r.nextSibling,s=i.nextSibling,o=s.nextSibling,l=o.nextSibling,a=l.firstChild,c=a.firstChild,f=l.nextSibling;f.firstChild;var u=f.nextSibling;return u.firstChild,$(t,m(rt,{class:"title",href:"/",get children(){return["LineChess",mu()]}})),$(a,m(rt,{href:"/lichess",children:"Login with Lichess"}),c),$(f,m(ru,{}),null),$(u,m(pu,{}),null),e})(),(()=>{var e=bu(),t=e.firstChild,n=t.nextSibling,r=n.nextSibling,i=r.nextSibling;return i.nextSibling,$(e,m(rt,{href:"/",children:"LineChess.com"}),t),$(e,m(rt,{href:"/about",children:"About"}),n),$(e,m(rt,{href:"/legal",children:"Legal"}),i),$(e,m(rt,{href:"/contact",children:"Contact"}),null),e})()]}const Eu=document.getElementById("root");Us(()=>m(Cu,{}),Eu);export{rt as A,T as a,A as b,m as c,J as d,xe as e,$ as i,L as t};
