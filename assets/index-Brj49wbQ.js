const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MainLegal-CRYUpMf9.js","assets/MainLegal-CZOPaPYE.css","assets/MainAbout-hH5OZPHV.js","assets/MainContact-c7rxTmkE.js","assets/MainContact-BM86F0VK.css"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();const P={context:void 0,registry:void 0,effects:void 0,done:!1,getContextId(){return Sn(this.context.count)},getNextContextId(){return Sn(this.context.count++)}};function Sn(e){const t=String(e),n=t.length-1;return P.context.id+(n?String.fromCharCode(96+n):"")+t}function Fe(e){P.context=e}const Yn=!1,ti=(e,t)=>e===t,ot=Symbol("solid-proxy"),Xn=typeof Proxy=="function",ni=Symbol("solid-track"),st={equals:ti};let Zn=or;const fe=1,ct=2,Jn={owned:null,cleanups:null,context:null,owner:null},St={};var O=null;let xt=null,ri=null,M=null,z=null,ue=null,kt=0;function Be(e,t){const n=M,r=O,i=e.length===0,o=t===void 0?r:t,s=i?Jn:{owned:null,cleanups:null,context:o?o.context:null,owner:o},c=i?e:()=>e(()=>Q(()=>ze(s)));O=s,M=null;try{return ce(c,!0)}finally{M=n,O=r}}function W(e,t){t=t?Object.assign({},st,t):st;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},r=i=>(typeof i=="function"&&(i=i(n.value)),ir(n,i));return[rr.bind(n),r]}function ii(e,t,n){const r=yt(e,t,!0,fe);Te(r)}function se(e,t,n){const r=yt(e,t,!1,fe);Te(r)}function It(e,t,n){Zn=di;const r=yt(e,t,!1,fe);r.user=!0,ue?ue.push(r):Te(r)}function x(e,t,n){n=n?Object.assign({},st,n):st;const r=yt(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,Te(r),rr.bind(r)}function oi(e){return e&&typeof e=="object"&&"then"in e}function si(e,t,n){let r,i,o;r=!0,i=e,o={};let s=null,c=St,l=null,a=!1,f="initialValue"in o,u=typeof r=="function"&&x(r);const h=new Set,[g,m]=(o.storage||W)(o.initialValue),[p,w]=W(void 0),[k,b]=W(void 0,{equals:!1}),[A,_]=W(f?"ready":"unresolved");P.context&&(l=P.getNextContextId(),o.ssrLoadFrom==="initial"?c=o.initialValue:P.load&&P.has(l)&&(c=P.load(l)));function C(R,S,I,D){return s===R&&(s=null,D!==void 0&&(f=!0),(R===c||S===c)&&o.onHydrated&&queueMicrotask(()=>o.onHydrated(D,{value:S})),c=St,H(S,I)),S}function H(R,S){ce(()=>{S===void 0&&m(()=>R),_(S!==void 0?"errored":f?"ready":"unresolved"),w(S);for(const I of h.keys())I.decrement();h.clear()},!1)}function q(){const R=ai,S=g(),I=p();if(I!==void 0&&!s)throw I;return M&&M.user,S}function $(R=!0){if(R!==!1&&a)return;a=!1;const S=u?u():r;if(S==null||S===!1){C(s,Q(g));return}let I;const D=c!==St?c:Q(()=>{try{return i(S,{value:g(),refetching:R})}catch(E){I=E}});if(I!==void 0){C(s,void 0,rt(I),S);return}else if(!oi(D))return C(s,D,void 0,S),D;return s=D,"v"in D?(D.s===1?C(s,D.v,void 0,S):C(s,void 0,rt(D.v),S),D):(a=!0,queueMicrotask(()=>a=!1),ce(()=>{_(f?"refreshing":"pending"),b()},!1),D.then(E=>C(D,E,void 0,S),E=>C(D,void 0,rt(E),S)))}Object.defineProperties(q,{state:{get:()=>A()},error:{get:()=>p()},loading:{get(){const R=A();return R==="pending"||R==="refreshing"}},latest:{get(){if(!f)return q();const R=p();if(R&&!s)throw R;return g()}}});let V=O;return u?ii(()=>(V=O,$(!1))):$(!1),[q,{refetch:R=>on(V,()=>$(R)),mutate:m}]}function er(e){return ce(e,!1)}function Q(e){if(M===null)return e();const t=M;M=null;try{return e()}finally{M=t}}function nn(e,t,n){const r=Array.isArray(e);let i,o=n&&n.defer;return s=>{let c;if(r){c=Array(e.length);for(let a=0;a<e.length;a++)c[a]=e[a]()}else c=e();if(o)return o=!1,s;const l=Q(()=>t(c,i,s));return i=c,l}}function ci(e){It(()=>Q(e))}function rn(e){return O===null||(O.cleanups===null?O.cleanups=[e]:O.cleanups.push(e)),e}function tr(){return O}function on(e,t){const n=O,r=M;O=e,M=null;try{return ce(t,!0)}catch(i){ln(i)}finally{O=n,M=r}}function li(e){const t=M,n=O;return Promise.resolve().then(()=>{M=t,O=n;let r;return ce(e,!1),M=O=null,r?r.done:void 0})}const[zc,Hc]=W(!1);function nr(e,t){const n=Symbol("context");return{id:n,Provider:hi(n),defaultValue:e}}function sn(e){let t;return O&&O.context&&(t=O.context[e.id])!==void 0?t:e.defaultValue}function cn(e){const t=x(e),n=x(()=>Kt(t()));return n.toArray=()=>{const r=n();return Array.isArray(r)?r:r!=null?[r]:[]},n}let ai;function rr(){if(this.sources&&this.state)if(this.state===fe)Te(this);else{const e=z;z=null,ce(()=>at(this),!1),z=e}if(M){const e=this.observers?this.observers.length:0;M.sources?(M.sources.push(this),M.sourceSlots.push(e)):(M.sources=[this],M.sourceSlots=[e]),this.observers?(this.observers.push(M),this.observerSlots.push(M.sources.length-1)):(this.observers=[M],this.observerSlots=[M.sources.length-1])}return this.value}function ir(e,t,n){let r=e.value;return(!e.comparator||!e.comparator(r,t))&&(e.value=t,e.observers&&e.observers.length&&ce(()=>{for(let i=0;i<e.observers.length;i+=1){const o=e.observers[i],s=xt&&xt.running;s&&xt.disposed.has(o),(s?!o.tState:!o.state)&&(o.pure?z.push(o):ue.push(o),o.observers&&sr(o)),s||(o.state=fe)}if(z.length>1e6)throw z=[],new Error},!1)),t}function Te(e){if(!e.fn)return;ze(e);const t=kt;ui(e,e.value,t)}function ui(e,t,n){let r;const i=O,o=M;M=O=e;try{r=e.fn(t)}catch(s){return e.pure&&(e.state=fe,e.owned&&e.owned.forEach(ze),e.owned=null),e.updatedAt=n+1,ln(s)}finally{M=o,O=i}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?ir(e,r):e.value=r,e.updatedAt=n)}function yt(e,t,n,r=fe,i){const o={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:O,context:O?O.context:null,pure:n};return O===null||O!==Jn&&(O.owned?O.owned.push(o):O.owned=[o]),o}function lt(e){if(e.state===0)return;if(e.state===ct)return at(e);if(e.suspense&&Q(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<kt);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===fe)Te(e);else if(e.state===ct){const r=z;z=null,ce(()=>at(e,t[0]),!1),z=r}}function ce(e,t){if(z)return e();let n=!1;t||(z=[]),ue?n=!0:ue=[],kt++;try{const r=e();return fi(n),r}catch(r){n||(ue=null),z=null,ln(r)}}function fi(e){if(z&&(or(z),z=null),e)return;const t=ue;ue=null,t.length&&ce(()=>Zn(t),!1)}function or(e){for(let t=0;t<e.length;t++)lt(e[t])}function di(e){let t,n=0;for(t=0;t<e.length;t++){const r=e[t];r.user?e[n++]=r:lt(r)}if(P.context){if(P.count){P.effects||(P.effects=[]),P.effects.push(...e.slice(0,n));return}Fe()}for(P.effects&&(P.done||!P.count)&&(e=[...P.effects,...e],n+=P.effects.length,delete P.effects),t=0;t<n;t++)lt(e[t])}function at(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const r=e.sources[n];if(r.sources){const i=r.state;i===fe?r!==t&&(!r.updatedAt||r.updatedAt<kt)&&lt(r):i===ct&&at(r,t)}}}function sr(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=ct,n.pure?z.push(n):ue.push(n),n.observers&&sr(n))}}function ze(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),i=n.observers;if(i&&i.length){const o=i.pop(),s=n.observerSlots.pop();r<i.length&&(o.sourceSlots[s]=r,i[r]=o,n.observerSlots[r]=s)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)ze(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)ze(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function rt(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function ln(e,t=O){throw rt(e)}function Kt(e){if(typeof e=="function"&&!e.length)return Kt(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const r=Kt(e[n]);Array.isArray(r)?t.push.apply(t,r):t.push(r)}return t}return e}function hi(e,t){return function(r){let i;return se(()=>i=Q(()=>(O.context={...O.context,[e]:r.value},cn(()=>r.children))),void 0),i}}const pi=Symbol("fallback");function xn(e){for(let t=0;t<e.length;t++)e[t]()}function gi(e,t,n={}){let r=[],i=[],o=[],s=0,c=t.length>1?[]:null;return rn(()=>xn(o)),()=>{let l=e()||[],a=l.length,f,u;return l[ni],Q(()=>{let g,m,p,w,k,b,A,_,C;if(a===0)s!==0&&(xn(o),o=[],r=[],i=[],s=0,c&&(c=[])),n.fallback&&(r=[pi],i[0]=Be(H=>(o[0]=H,n.fallback())),s=1);else if(s===0){for(i=new Array(a),u=0;u<a;u++)r[u]=l[u],i[u]=Be(h);s=a}else{for(p=new Array(a),w=new Array(a),c&&(k=new Array(a)),b=0,A=Math.min(s,a);b<A&&r[b]===l[b];b++);for(A=s-1,_=a-1;A>=b&&_>=b&&r[A]===l[_];A--,_--)p[_]=i[A],w[_]=o[A],c&&(k[_]=c[A]);for(g=new Map,m=new Array(_+1),u=_;u>=b;u--)C=l[u],f=g.get(C),m[u]=f===void 0?-1:f,g.set(C,u);for(f=b;f<=A;f++)C=r[f],u=g.get(C),u!==void 0&&u!==-1?(p[u]=i[f],w[u]=o[f],c&&(k[u]=c[f]),u=m[u],g.set(C,u)):o[f]();for(u=b;u<a;u++)u in p?(i[u]=p[u],o[u]=w[u],c&&(c[u]=k[u],c[u](u))):i[u]=Be(h);i=i.slice(0,s=a),r=l.slice(0)}return i});function h(g){if(o[u]=g,c){const[m,p]=W(u);return c[u]=p,t(l[u],m)}return t(l[u])}}}function T(e,t){return Q(()=>e(t||{}))}function nt(){return!0}const Ft={get(e,t,n){return t===ot?n:e.get(t)},has(e,t){return t===ot?!0:e.has(t)},set:nt,deleteProperty:nt,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:nt,deleteProperty:nt}},ownKeys(e){return e.keys()}};function Rt(e){return(e=typeof e=="function"?e():e)?e:{}}function mi(){for(let e=0,t=this.length;e<t;++e){const n=this[e]();if(n!==void 0)return n}}function Bt(...e){let t=!1;for(let s=0;s<e.length;s++){const c=e[s];t=t||!!c&&ot in c,e[s]=typeof c=="function"?(t=!0,x(c)):c}if(Xn&&t)return new Proxy({get(s){for(let c=e.length-1;c>=0;c--){const l=Rt(e[c])[s];if(l!==void 0)return l}},has(s){for(let c=e.length-1;c>=0;c--)if(s in Rt(e[c]))return!0;return!1},keys(){const s=[];for(let c=0;c<e.length;c++)s.push(...Object.keys(Rt(e[c])));return[...new Set(s)]}},Ft);const n={},r=Object.create(null);for(let s=e.length-1;s>=0;s--){const c=e[s];if(!c)continue;const l=Object.getOwnPropertyNames(c);for(let a=l.length-1;a>=0;a--){const f=l[a];if(f==="__proto__"||f==="constructor")continue;const u=Object.getOwnPropertyDescriptor(c,f);if(!r[f])r[f]=u.get?{enumerable:!0,configurable:!0,get:mi.bind(n[f]=[u.get.bind(c)])}:u.value!==void 0?u:void 0;else{const h=n[f];h&&(u.get?h.push(u.get.bind(c)):u.value!==void 0&&h.push(()=>u.value))}}}const i={},o=Object.keys(r);for(let s=o.length-1;s>=0;s--){const c=o[s],l=r[c];l&&l.get?Object.defineProperty(i,c,l):i[c]=l?l.value:void 0}return i}function wi(e,...t){if(Xn&&ot in e){const i=new Set(t.length>1?t.flat():t[0]),o=t.map(s=>new Proxy({get(c){return s.includes(c)?e[c]:void 0},has(c){return s.includes(c)&&c in e},keys(){return s.filter(c=>c in e)}},Ft));return o.push(new Proxy({get(s){return i.has(s)?void 0:e[s]},has(s){return i.has(s)?!1:s in e},keys(){return Object.keys(e).filter(s=>!i.has(s))}},Ft)),o}const n={},r=t.map(()=>({}));for(const i of Object.getOwnPropertyNames(e)){const o=Object.getOwnPropertyDescriptor(e,i),s=!o.get&&!o.set&&o.enumerable&&o.writable&&o.configurable;let c=!1,l=0;for(const a of t)a.includes(i)&&(c=!0,s?r[l][i]=o.value:Object.defineProperty(r[l],i,o)),++l;c||(s?n[i]=o.value:Object.defineProperty(n,i,o))}return[...r,n]}function vt(e){let t,n;const r=i=>{const o=P.context;if(o){const[c,l]=W();P.count||(P.count=0),P.count++,(n||(n=e())).then(a=>{!P.done&&Fe(o),P.count--,l(()=>a.default),Fe()}),t=c}else if(!t){const[c]=si(()=>(n||(n=e())).then(l=>l.default));t=c}let s;return x(()=>(s=t())?Q(()=>{if(!o||P.done)return s(i);const c=P.context;Fe(o);const l=s(i);return Fe(c),l}):"")};return r.preload=()=>n||((n=e()).then(i=>t=()=>i.default),n),r}const bi=e=>`Stale read from <${e}>.`;function ki(e){const t="fallback"in e&&{fallback:()=>e.fallback};return x(gi(()=>e.each,e.children,t||void 0))}function cr(e){const t=e.keyed,n=x(()=>e.when,void 0,void 0),r=t?n:x(n,void 0,{equals:(i,o)=>!i==!o});return x(()=>{const i=r();if(i){const o=e.children;return typeof o=="function"&&o.length>0?Q(()=>o(t?i:()=>{if(!Q(r))throw bi("Show");return n()})):o}return e.fallback},void 0,void 0)}const yi=["allowfullscreen","async","alpha","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected","adauctionheaders","browsingtopics","credentialless","defaultchecked","defaultmuted","defaultselected","defer","disablepictureinpicture","disableremoteplayback","preservespitch","shadowrootclonable","shadowrootcustomelementregistry","shadowrootdelegatesfocus","shadowrootserializable","sharedstoragewritable"],vi=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline","adAuctionHeaders","allowFullscreen","browsingTopics","defaultChecked","defaultMuted","defaultSelected","disablePictureInPicture","disableRemotePlayback","preservesPitch","shadowRootClonable","shadowRootCustomElementRegistry","shadowRootDelegatesFocus","shadowRootSerializable","sharedStorageWritable",...yi]),Ci=new Set(["innerHTML","textContent","innerText","children"]),Pi=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),Ei=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1},adauctionheaders:{$:"adAuctionHeaders",IFRAME:1},allowfullscreen:{$:"allowFullscreen",IFRAME:1},browsingtopics:{$:"browsingTopics",IMG:1},defaultchecked:{$:"defaultChecked",INPUT:1},defaultmuted:{$:"defaultMuted",AUDIO:1,VIDEO:1},defaultselected:{$:"defaultSelected",OPTION:1},disablepictureinpicture:{$:"disablePictureInPicture",VIDEO:1},disableremoteplayback:{$:"disableRemotePlayback",AUDIO:1,VIDEO:1},preservespitch:{$:"preservesPitch",AUDIO:1,VIDEO:1},shadowrootclonable:{$:"shadowRootClonable",TEMPLATE:1},shadowrootdelegatesfocus:{$:"shadowRootDelegatesFocus",TEMPLATE:1},shadowrootserializable:{$:"shadowRootSerializable",TEMPLATE:1},sharedstoragewritable:{$:"sharedStorageWritable",IFRAME:1,IMG:1}});function Ai(e,t){const n=Ei[e];return typeof n=="object"?n[t]?n.$:void 0:n}const _i=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),Si=e=>x(()=>e());function xi(e,t,n){let r=n.length,i=t.length,o=r,s=0,c=0,l=t[i-1].nextSibling,a=null;for(;s<i||c<o;){if(t[s]===n[c]){s++,c++;continue}for(;t[i-1]===n[o-1];)i--,o--;if(i===s){const f=o<r?c?n[c-1].nextSibling:n[o-c]:l;for(;c<o;)e.insertBefore(n[c++],f)}else if(o===c)for(;s<i;)(!a||!a.has(t[s]))&&t[s].remove(),s++;else if(t[s]===n[o-1]&&n[c]===t[i-1]){const f=t[--i].nextSibling;e.insertBefore(n[c++],t[s++].nextSibling),e.insertBefore(n[--o],f),t[i]=n[o]}else{if(!a){a=new Map;let u=c;for(;u<o;)a.set(n[u],u++)}const f=a.get(t[s]);if(f!=null)if(c<f&&f<o){let u=s,h=1,g;for(;++u<i&&u<o&&!((g=a.get(t[u]))==null||g!==f+h);)h++;if(h>f-c){const m=t[s];for(;c<f;)e.insertBefore(n[c++],m)}else e.replaceChild(n[c++],t[s++])}else s++;else t[s++].remove()}}}const Rn="_$DX_DELEGATE";function Ri(e,t,n,r={}){let i;return Be(o=>{i=o,t===document?e():B(t,e(),t.firstChild?null:void 0,n)},r.owner),()=>{i(),t.textContent=""}}function ne(e,t,n,r){let i;const o=()=>{const c=document.createElement("template");return c.innerHTML=e,c.content.firstChild},s=()=>(i||(i=o())).cloneNode(!0);return s.cloneNode=s,s}function Ze(e,t=window.document){const n=t[Rn]||(t[Rn]=new Set);for(let r=0,i=e.length;r<i;r++){const o=e[r];n.has(o)||(n.add(o),t.addEventListener(o,Ii))}}function jt(e,t,n){Je(e)||(n==null?e.removeAttribute(t):e.setAttribute(t,n))}function Oi(e,t,n){Je(e)||(n?e.setAttribute(t,""):e.removeAttribute(t))}function $i(e,t){Je(e)||(t==null?e.removeAttribute("class"):e.className=t)}function je(e,t,n,r){if(r)Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n;else if(Array.isArray(n)){const i=n[0];e.addEventListener(t,n[0]=o=>i.call(e,n[1],o))}else e.addEventListener(t,n,typeof n!="function"&&n)}function Mi(e,t,n={}){const r=Object.keys(t||{}),i=Object.keys(n);let o,s;for(o=0,s=i.length;o<s;o++){const c=i[o];!c||c==="undefined"||t[c]||(On(e,c,!1),delete n[c])}for(o=0,s=r.length;o<s;o++){const c=r[o],l=!!t[c];!c||c==="undefined"||n[c]===l||!l||(On(e,c,!0),n[c]=l)}return n}function Li(e,t,n){if(!t)return n?jt(e,"style"):t;const r=e.style;if(typeof t=="string")return r.cssText=t;typeof n=="string"&&(r.cssText=n=void 0),n||(n={}),t||(t={});let i,o;for(o in n)t[o]==null&&r.removeProperty(o),delete n[o];for(o in t)i=t[o],i!==n[o]&&(r.setProperty(o,i),n[o]=i);return n}function Ti(e,t={},n,r){const i={};return se(()=>i.children=He(e,t.children,i.children)),se(()=>typeof t.ref=="function"&&lr(t.ref,e)),se(()=>Ni(e,t,n,!0,i,!0)),i}function lr(e,t,n){return Q(()=>e(t,n))}function B(e,t,n,r){if(n!==void 0&&!r&&(r=[]),typeof t!="function")return He(e,t,r,n);se(i=>He(e,t(),i,n),r)}function Ni(e,t,n,r,i={},o=!1){t||(t={});for(const s in i)if(!(s in t)){if(s==="children")continue;i[s]=$n(e,s,null,i[s],n,o,t)}for(const s in t){if(s==="children")continue;const c=t[s];i[s]=$n(e,s,c,i[s],n,o,t)}}function Je(e){return!!P.context&&!P.done&&(!e||e.isConnected)}function Di(e){return e.toLowerCase().replace(/-([a-z])/g,(t,n)=>n.toUpperCase())}function On(e,t,n){const r=t.trim().split(/\s+/);for(let i=0,o=r.length;i<o;i++)e.classList.toggle(r[i],n)}function $n(e,t,n,r,i,o,s){let c,l,a,f,u;if(t==="style")return Li(e,n,r);if(t==="classList")return Mi(e,n,r);if(n===r)return r;if(t==="ref")o||n(e);else if(t.slice(0,3)==="on:"){const h=t.slice(3);r&&e.removeEventListener(h,r,typeof r!="function"&&r),n&&e.addEventListener(h,n,typeof n!="function"&&n)}else if(t.slice(0,10)==="oncapture:"){const h=t.slice(10);r&&e.removeEventListener(h,r,!0),n&&e.addEventListener(h,n,!0)}else if(t.slice(0,2)==="on"){const h=t.slice(2).toLowerCase(),g=_i.has(h);if(!g&&r){const m=Array.isArray(r)?r[0]:r;e.removeEventListener(h,m)}(g||n)&&(je(e,h,n,g),g&&Ze([h]))}else if(t.slice(0,5)==="attr:")jt(e,t.slice(5),n);else if(t.slice(0,5)==="bool:")Oi(e,t.slice(5),n);else if((u=t.slice(0,5)==="prop:")||(a=Ci.has(t))||(f=Ai(t,e.tagName))||(l=vi.has(t))||(c=e.nodeName.includes("-")||"is"in s)){if(u)t=t.slice(5),l=!0;else if(Je(e))return n;t==="class"||t==="className"?$i(e,n):c&&!l&&!a?e[Di(t)]=n:e[f||t]=n}else jt(e,Pi[t]||t,n);return n}function Ii(e){if(P.registry&&P.events&&P.events.find(([l,a])=>a===e))return;let t=e.target;const n=`$$${e.type}`,r=e.target,i=e.currentTarget,o=l=>Object.defineProperty(e,"target",{configurable:!0,value:l}),s=()=>{const l=t[n];if(l&&!t.disabled){const a=t[`${n}Data`];if(a!==void 0?l.call(t,a,e):l.call(t,e),e.cancelBubble)return}return t.host&&typeof t.host!="string"&&!t.host._$host&&t.contains(e.target)&&o(t.host),!0},c=()=>{for(;s()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}}),P.registry&&!P.done&&(P.done=_$HY.done=!0),e.composedPath){const l=e.composedPath();o(l[0]);for(let a=0;a<l.length-2&&(t=l[a],!!s());a++){if(t._$host){t=t._$host,c();break}if(t.parentNode===i)break}}else c();o(r)}function He(e,t,n,r,i){const o=Je(e);if(o){!n&&(n=[...e.childNodes]);let l=[];for(let a=0;a<n.length;a++){const f=n[a];f.nodeType===8&&f.data.slice(0,2)==="!$"?f.remove():l.push(f)}n=l}for(;typeof n=="function";)n=n();if(t===n)return n;const s=typeof t,c=r!==void 0;if(e=c&&n[0]&&n[0].parentNode||e,s==="string"||s==="number"){if(o||s==="number"&&(t=t.toString(),t===n))return n;if(c){let l=n[0];l&&l.nodeType===3?l.data!==t&&(l.data=t):l=document.createTextNode(t),n=Re(e,n,r,l)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||s==="boolean"){if(o)return n;n=Re(e,n,r)}else{if(s==="function")return se(()=>{let l=t();for(;typeof l=="function";)l=l();n=He(e,l,n,r)}),()=>n;if(Array.isArray(t)){const l=[],a=n&&Array.isArray(n);if(Ut(l,t,n,i))return se(()=>n=He(e,l,n,r,!0)),()=>n;if(o){if(!l.length)return n;if(r===void 0)return n=[...e.childNodes];let f=l[0];if(f.parentNode!==e)return n;const u=[f];for(;(f=f.nextSibling)!==r;)u.push(f);return n=u}if(l.length===0){if(n=Re(e,n,r),c)return n}else a?n.length===0?Mn(e,l,r):xi(e,n,l):(n&&Re(e),Mn(e,l));n=l}else if(t.nodeType){if(o&&t.parentNode)return n=c?[t]:t;if(Array.isArray(n)){if(c)return n=Re(e,n,r,t);Re(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function Ut(e,t,n,r){let i=!1;for(let o=0,s=t.length;o<s;o++){let c=t[o],l=n&&n[e.length],a;if(!(c==null||c===!0||c===!1))if((a=typeof c)=="object"&&c.nodeType)e.push(c);else if(Array.isArray(c))i=Ut(e,c,l)||i;else if(a==="function")if(r){for(;typeof c=="function";)c=c();i=Ut(e,Array.isArray(c)?c:[c],Array.isArray(l)?l:[l])||i}else e.push(c),i=!0;else{const f=String(c);l&&l.nodeType===3&&l.data===f?e.push(l):e.push(document.createTextNode(f))}}return i}function Mn(e,t,n=null){for(let r=0,i=t.length;r<i;r++)e.insertBefore(t[r],n)}function Re(e,t,n,r){if(n===void 0)return e.textContent="";const i=r||document.createTextNode("");if(t.length){let o=!1;for(let s=t.length-1;s>=0;s--){const c=t[s];if(i!==c){const l=c.parentNode===e;!o&&!s?l?e.replaceChild(i,c):e.insertBefore(i,n):l&&c.remove()}else o=!0}}else e.insertBefore(i,n);return[i]}const Ki=!1,Fi="modulepreload",Bi=function(e){return"/"+e},Ln={},Ct=function(t,n,r){let i=Promise.resolve();if(n&&n.length>0){let l=function(a){return Promise.all(a.map(f=>Promise.resolve(f).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),c=s?.nonce||s?.getAttribute("nonce");i=l(n.map(a=>{if(a=Bi(a),a in Ln)return;Ln[a]=!0;const f=a.endsWith(".css"),u=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${u}`))return;const h=document.createElement("link");if(h.rel=f?"stylesheet":Fi,f||(h.as="script"),h.crossOrigin="",h.href=a,c&&h.setAttribute("nonce",c),document.head.appendChild(h),f)return new Promise((g,m)=>{h.addEventListener("load",g),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${a}`)))})}))}function o(s){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=s,window.dispatchEvent(c),!c.defaultPrevented)throw s}return i.then(s=>{for(const c of s||[])c.status==="rejected"&&o(c.reason);return t().catch(o)})};function ar(){let e=new Set;function t(i){return e.add(i),()=>e.delete(i)}let n=!1;function r(i,o){if(n)return!(n=!1);const s={to:i,options:o,defaultPrevented:!1,preventDefault:()=>s.defaultPrevented=!0};for(const c of e)c.listener({...s,from:c.location,retry:l=>{l&&(n=!0),c.navigate(i,{...o,resolve:!1})}});return!s.defaultPrevented}return{subscribe:t,confirm:r}}let Wt;function an(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Wt=window.history.state._depth}an();function ji(e){return{...e,_depth:window.history.state&&window.history.state._depth}}function Ui(e,t){let n=!1;return()=>{const r=Wt;an();const i=r==null?null:Wt-r;if(n){n=!1;return}i&&t(i)?(n=!0,window.history.go(-i)):e()}}const Wi=/^(?:[a-z0-9]+:)?\/\//i,zi=/^\/+|(\/)\/+$/g,ur="http://sr";function ve(e,t=!1){const n=e.replace(zi,"$1");return n?t||/^[?#]/.test(n)?n:"/"+n:""}function it(e,t,n){if(Wi.test(t))return;const r=ve(e),i=n&&ve(n);let o="";return!i||t.startsWith("/")?o=r:i.toLowerCase().indexOf(r.toLowerCase())!==0?o=r+i:o=i,(o||"/")+ve(t,!o)}function Hi(e,t){if(e==null)throw new Error(t);return e}function qi(e,t){return ve(e).replace(/\/*(\*.*)?$/g,"")+ve(t)}function fr(e){const t={};return e.searchParams.forEach((n,r)=>{r in t?Array.isArray(t[r])?t[r].push(n):t[r]=[t[r],n]:t[r]=n}),t}function Vi(e,t,n){const[r,i]=e.split("/*",2),o=r.split("/").filter(Boolean),s=o.length;return c=>{const l=c.split("/").filter(Boolean),a=l.length-s;if(a<0||a>0&&i===void 0&&!t)return null;const f={path:s?"":"/",params:{}},u=h=>n===void 0?void 0:n[h];for(let h=0;h<s;h++){const g=o[h],m=g[0]===":",p=m?l[h]:l[h].toLowerCase(),w=m?g.slice(1):g.toLowerCase();if(m&&Ot(p,u(w)))f.params[w]=p;else if(m||!Ot(p,w))return null;f.path+=`/${p}`}if(i){const h=a?l.slice(-a).join("/"):"";if(Ot(h,u(i)))f.params[i]=h;else return null}return f}}function Ot(e,t){const n=r=>r===e;return t===void 0?!0:typeof t=="string"?n(t):typeof t=="function"?t(e):Array.isArray(t)?t.some(n):t instanceof RegExp?t.test(e):!1}function Gi(e){const[t,n]=e.pattern.split("/*",2),r=t.split("/").filter(Boolean);return r.reduce((i,o)=>i+(o.startsWith(":")?2:3),r.length-(n===void 0?0:1))}function dr(e){const t=new Map,n=tr();return new Proxy({},{get(r,i){return t.has(i)||on(n,()=>t.set(i,x(()=>e()[i]))),t.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(e())}})}function hr(e){let t=/(\/?\:[^\/]+)\?/.exec(e);if(!t)return[e];let n=e.slice(0,t.index),r=e.slice(t.index+t[0].length);const i=[n,n+=t[1]];for(;t=/^(\/\:[^\/]+)\?/.exec(r);)i.push(n+=t[1]),r=r.slice(t[0].length);return hr(r).reduce((o,s)=>[...o,...i.map(c=>c+s)],[])}const Qi=100,pr=nr(),un=nr(),fn=()=>Hi(sn(pr),"<A> and 'use' router primitives can be only used inside a Route."),Yi=()=>sn(un)||fn().base,Xi=e=>{const t=Yi();return x(()=>t.resolvePath(e()))},Zi=e=>{const t=fn();return x(()=>{const n=e();return n!==void 0?t.renderPath(n):n})},Ji=()=>fn().location;function eo(e,t=""){const{component:n,preload:r,load:i,children:o,info:s}=e,c=!o||Array.isArray(o)&&!o.length,l={key:e,component:n,preload:r||i,info:s};return gr(e.path).reduce((a,f)=>{for(const u of hr(f)){const h=qi(t,u);let g=c?h:h.split("/*",1)[0];g=g.split("/").map(m=>m.startsWith(":")||m.startsWith("*")?m:encodeURIComponent(m)).join("/"),a.push({...l,originalPath:f,pattern:g,matcher:Vi(g,!c,e.matchFilters)})}return a},[])}function to(e,t=0){return{routes:e,score:Gi(e[e.length-1])*1e4-t,matcher(n){const r=[];for(let i=e.length-1;i>=0;i--){const o=e[i],s=o.matcher(n);if(!s)return null;r.unshift({...s,route:o})}return r}}}function gr(e){return Array.isArray(e)?e:[e]}function mr(e,t="",n=[],r=[]){const i=gr(e);for(let o=0,s=i.length;o<s;o++){const c=i[o];if(c&&typeof c=="object"){c.hasOwnProperty("path")||(c.path="");const l=eo(c,t);for(const a of l){n.push(a);const f=Array.isArray(c.children)&&c.children.length===0;if(c.children&&!f)mr(c.children,a.pattern,n,r);else{const u=to([...n],r.length);r.push(u)}n.pop()}}}return n.length?r:r.sort((o,s)=>s.score-o.score)}function $t(e,t){for(let n=0,r=e.length;n<r;n++){const i=e[n].matcher(t);if(i)return i}return[]}function no(e,t,n){const r=new URL(ur),i=x(f=>{const u=e();try{return new URL(u,r)}catch{return console.error(`Invalid path ${u}`),f}},r,{equals:(f,u)=>f.href===u.href}),o=x(()=>i().pathname),s=x(()=>i().search,!0),c=x(()=>i().hash),l=()=>"",a=nn(s,()=>fr(i()));return{get pathname(){return o()},get search(){return s()},get hash(){return c()},get state(){return t()},get key(){return l()},query:n?n(a):dr(a)}}let be;function ro(){return be}function io(e,t,n,r={}){const{signal:[i,o],utils:s={}}=e,c=s.parsePath||(E=>E),l=s.renderPath||(E=>E),a=s.beforeLeave||ar(),f=it("",r.base||"");if(f===void 0)throw new Error(`${f} is not a valid base path`);f&&!i().value&&o({value:f,replace:!0,scroll:!1});const[u,h]=W(!1);let g;const m=(E,L)=>{L.value===p()&&L.state===k()||(g===void 0&&h(!0),be=E,g=L,li(()=>{g===L&&(w(g.value),b(g.state),C[1](Z=>Z.filter(Se=>Se.pending)))}).finally(()=>{g===L&&er(()=>{be=void 0,E==="navigate"&&I(g),h(!1),g=void 0})}))},[p,w]=W(i().value),[k,b]=W(i().state),A=no(p,k,s.queryWrapper),_=[],C=W([]),H=x(()=>typeof r.transformUrl=="function"?$t(t(),r.transformUrl(A.pathname)):$t(t(),A.pathname)),q=()=>{const E=H(),L={};for(let Z=0;Z<E.length;Z++)Object.assign(L,E[Z].params);return L},$=s.paramsWrapper?s.paramsWrapper(q,t):dr(q),V={pattern:f,path:()=>f,outlet:()=>null,resolvePath(E){return it(f,E)}};return se(nn(i,E=>m("native",E),{defer:!0})),{base:V,location:A,params:$,isRouting:u,renderPath:l,parsePath:c,navigatorFactory:S,matches:H,beforeLeave:a,preloadRoute:D,singleFlight:r.singleFlight===void 0?!0:r.singleFlight,submissions:C};function R(E,L,Z){Q(()=>{if(typeof L=="number"){L&&(s.go?s.go(L):console.warn("Router integration does not support relative routing"));return}const Se=!L||L[0]==="?",{replace:At,resolve:xe,scroll:_t,state:Ne}={replace:!1,resolve:!Se,scroll:!0,...Z},tt=xe?E.resolvePath(L):it(Se&&A.pathname||"",L);if(tt===void 0)throw new Error(`Path '${L}' is not a routable path`);if(_.length>=Qi)throw new Error("Too many redirects");const _n=p();(tt!==_n||Ne!==k())&&(Ki||a.confirm(tt,Z)&&(_.push({value:_n,replace:At,scroll:_t,state:k()}),m("navigate",{value:tt,state:Ne})))})}function S(E){return E=E||sn(un)||V,(L,Z)=>R(E,L,Z)}function I(E){const L=_[0];L&&(o({...E,replace:L.replace,scroll:L.scroll}),_.length=0)}function D(E,L){const Z=$t(t(),E.pathname),Se=be;be="preload";for(let At in Z){const{route:xe,params:_t}=Z[At];xe.component&&xe.component.preload&&xe.component.preload();const{preload:Ne}=xe;L&&Ne&&on(n(),()=>Ne({params:_t,location:{pathname:E.pathname,search:E.search,hash:E.hash,query:fr(E),state:null,key:""},intent:"preload"}))}be=Se}}function oo(e,t,n,r){const{base:i,location:o,params:s}=e,{pattern:c,component:l,preload:a}=r().route,f=x(()=>r().path);l&&l.preload&&l.preload();const u=a?a({params:s,location:o,intent:be||"initial"}):void 0;return{parent:t,pattern:c,path:f,outlet:()=>l?T(l,{params:s,location:o,data:u,get children(){return n()}}):n(),resolvePath(g){return it(i.path(),g,f())}}}const so=e=>t=>{const{base:n}=t,r=cn(()=>t.children),i=x(()=>mr(r(),t.base||""));let o;const s=io(e,i,()=>o,{base:n,singleFlight:t.singleFlight,transformUrl:t.transformUrl});return e.create&&e.create(s),T(pr.Provider,{value:s,get children(){return T(co,{routerState:s,get root(){return t.root},get preload(){return t.rootPreload||t.rootLoad},get children(){return[Si(()=>(o=tr())&&null),T(lo,{routerState:s,get branches(){return i()}})]}})}})};function co(e){const t=e.routerState.location,n=e.routerState.params,r=x(()=>e.preload&&Q(()=>{e.preload({params:n,location:t,intent:ro()||"initial"})}));return T(cr,{get when(){return e.root},keyed:!0,get fallback(){return e.children},children:i=>T(i,{params:n,location:t,get data(){return r()},get children(){return e.children}})})}function lo(e){const t=[];let n;const r=x(nn(e.routerState.matches,(i,o,s)=>{let c=o&&i.length===o.length;const l=[];for(let a=0,f=i.length;a<f;a++){const u=o&&o[a],h=i[a];s&&u&&h.route.key===u.route.key?l[a]=s[a]:(c=!1,t[a]&&t[a](),Be(g=>{t[a]=g,l[a]=oo(e.routerState,l[a-1]||e.routerState.base,Tn(()=>r()[a+1]),()=>e.routerState.matches()[a])}))}return t.splice(i.length).forEach(a=>a()),s&&c?s:(n=l[0],l)}));return Tn(()=>r()&&n)()}const Tn=e=>()=>T(cr,{get when(){return e()},keyed:!0,children:t=>T(un.Provider,{value:t,get children(){return t.outlet()}})}),De=e=>{const t=cn(()=>e.children);return Bt(e,{get children(){return t()}})};function ao([e,t],n,r){return[e,r?i=>t(r(i)):t]}function uo(e){let t=!1;const n=i=>typeof i=="string"?{value:i}:i,r=ao(W(n(e.get()),{equals:(i,o)=>i.value===o.value&&i.state===o.state}),void 0,i=>(!t&&e.set(i),P.registry&&!P.done&&(P.done=!0),i));return e.init&&rn(e.init((i=e.get())=>{t=!0,r[1](n(i)),t=!1})),so({signal:r,create:e.create,utils:e.utils})}function fo(e,t,n){return e.addEventListener(t,n),()=>e.removeEventListener(t,n)}function ho(e,t){const n=e&&document.getElementById(e);n?n.scrollIntoView():t&&window.scrollTo(0,0)}const po=new Map;function go(e=!0,t=!1,n="/_server",r){return i=>{const o=i.base.path(),s=i.navigatorFactory(i.base);let c,l;function a(p){return p.namespaceURI==="http://www.w3.org/2000/svg"}function f(p){if(p.defaultPrevented||p.button!==0||p.metaKey||p.altKey||p.ctrlKey||p.shiftKey)return;const w=p.composedPath().find(H=>H instanceof Node&&H.nodeName.toUpperCase()==="A");if(!w||t&&!w.hasAttribute("link"))return;const k=a(w),b=k?w.href.baseVal:w.href;if((k?w.target.baseVal:w.target)||!b&&!w.hasAttribute("state"))return;const _=(w.getAttribute("rel")||"").split(/\s+/);if(w.hasAttribute("download")||_&&_.includes("external"))return;const C=k?new URL(b,document.baseURI):new URL(b);if(!(C.origin!==window.location.origin||o&&C.pathname&&!C.pathname.toLowerCase().startsWith(o.toLowerCase())))return[w,C]}function u(p){const w=f(p);if(!w)return;const[k,b]=w,A=i.parsePath(b.pathname+b.search+b.hash),_=k.getAttribute("state");p.preventDefault(),s(A,{resolve:!1,replace:k.hasAttribute("replace"),scroll:!k.hasAttribute("noscroll"),state:_?JSON.parse(_):void 0})}function h(p){const w=f(p);if(!w)return;const[k,b]=w;r&&(b.pathname=r(b.pathname)),i.preloadRoute(b,k.getAttribute("preload")!=="false")}function g(p){clearTimeout(c);const w=f(p);if(!w)return l=null;const[k,b]=w;l!==k&&(r&&(b.pathname=r(b.pathname)),c=setTimeout(()=>{i.preloadRoute(b,k.getAttribute("preload")!=="false"),l=k},20))}function m(p){if(p.defaultPrevented)return;let w=p.submitter&&p.submitter.hasAttribute("formaction")?p.submitter.getAttribute("formaction"):p.target.getAttribute("action");if(!w)return;if(!w.startsWith("https://action/")){const b=new URL(w,ur);if(w=i.parsePath(b.pathname+b.search),!w.startsWith(n))return}if(p.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const k=po.get(w);if(k){p.preventDefault();const b=new FormData(p.target,p.submitter);k.call({r:i,f:p.target},p.target.enctype==="multipart/form-data"?b:new URLSearchParams(b))}}Ze(["click","submit"]),document.addEventListener("click",u),e&&(document.addEventListener("mousemove",g,{passive:!0}),document.addEventListener("focusin",h,{passive:!0}),document.addEventListener("touchstart",h,{passive:!0})),document.addEventListener("submit",m),rn(()=>{document.removeEventListener("click",u),e&&(document.removeEventListener("mousemove",g),document.removeEventListener("focusin",h),document.removeEventListener("touchstart",h)),document.removeEventListener("submit",m)})}}function mo(e){const t=()=>{const r=window.location.pathname.replace(/^\/+/,"/")+window.location.search,i=window.history.state&&window.history.state._depth&&Object.keys(window.history.state).length===1?void 0:window.history.state;return{value:r+window.location.hash,state:i}},n=ar();return uo({get:t,set({value:r,replace:i,scroll:o,state:s}){i?window.history.replaceState(ji(s),"",r):window.history.pushState(s,"",r),ho(decodeURIComponent(window.location.hash.slice(1)),o),an()},init:r=>fo(window,"popstate",Ui(r,i=>{if(i&&i<0)return!n.confirm(i);{const o=t();return!n.confirm(o.value,{state:o.state})}})),create:go(e.preload,e.explicitLinks,e.actionBase,e.transformUrl),utils:{go:r=>window.history.go(r),beforeLeave:n}})(e)}var wo=ne("<a>");function Oe(e){e=Bt({inactiveClass:"inactive",activeClass:"active"},e);const[,t]=wi(e,["href","state","class","activeClass","inactiveClass","end"]),n=Xi(()=>e.href),r=Zi(n),i=Ji(),o=x(()=>{const s=n();if(s===void 0)return[!1,!1];const c=ve(s.split(/[?#]/,1)[0]).toLowerCase(),l=decodeURI(ve(i.pathname).toLowerCase());return[e.end?c===l:l.startsWith(c+"/")||l===c,c===l]});return(()=>{var s=wo();return Ti(s,Bt(t,{get href(){return r()||e.href},get state(){return JSON.stringify(e.state)},get classList(){return{...e.class&&{[e.class]:!0},[e.inactiveClass]:!o()[0],[e.activeClass]:o()[0],...t.classList}},link:"",get"aria-current"(){return o()[1]?"page":void 0}}),!1),s})()}const bo=["white","black"],ut=["a","b","c","d","e","f","g","h"],ft=["1","2","3","4","5","6","7","8"],ko=[...ft].reverse(),dn=Array.prototype.concat(...ut.map(e=>ft.map(t=>e+t))),ee=e=>dn[8*e[0]+e[1]],N=e=>[e.charCodeAt(0)-97,e.charCodeAt(1)-49],wr=dn.map(N);function yo(e){let t;const n=()=>(t===void 0&&(t=e()),t);return n.clear=()=>{t=void 0},n}const vo=()=>{let e;return{start(){e=performance.now()},cancel(){e=void 0},stop(){if(!e)return 0;const t=performance.now()-e;return e=void 0,t}}},hn=e=>e==="white"?"black":"white",qe=(e,t)=>{const n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r},zt=(e,t)=>e.role===t.role&&e.color===t.color,et=e=>(t,n)=>[(n?t[0]:7-t[0])*e.width/8,(n?7-t[1]:t[1])*e.height/8],ie=(e,t)=>{e.style.transform=`translate(${t[0]}px,${t[1]}px)`},br=(e,t,n=1)=>{e.style.transform=`translate(${t[0]}px,${t[1]}px) scale(${n})`},pn=(e,t)=>{e.style.visibility=t?"visible":"hidden"},Ae=e=>{var t;if(e.clientX||e.clientX===0)return[e.clientX,e.clientY];if(!((t=e.targetTouches)===null||t===void 0)&&t[0])return[e.targetTouches[0].clientX,e.targetTouches[0].clientY]},kr=e=>e.button===2,ae=(e,t)=>{const n=document.createElement(e);return t&&(n.className=t),n};function yr(e,t,n){const r=N(e);return t||(r[0]=7-r[0],r[1]=7-r[1]),[n.left+n.width*r[0]/8+n.width/16,n.top+n.height*(7-r[1])/8+n.height/16]}const Ce=(e,t)=>Math.abs(e-t),Co=e=>(t,n,r,i)=>Ce(t,r)<2&&(e==="white"?i===n+1||n<=1&&i===n+2&&t===r:i===n-1||n>=6&&i===n-2&&t===r),vr=(e,t,n,r)=>{const i=Ce(e,n),o=Ce(t,r);return i===1&&o===2||i===2&&o===1},Cr=(e,t,n,r)=>Ce(e,n)===Ce(t,r),Pr=(e,t,n,r)=>e===n||t===r,Er=(e,t,n,r)=>Cr(e,t,n,r)||Pr(e,t,n,r),Po=(e,t,n)=>(r,i,o,s)=>Ce(r,o)<2&&Ce(i,s)<2||n&&i===s&&i===(e==="white"?0:7)&&(r===4&&(o===2&&t.includes(0)||o===6&&t.includes(7))||t.includes(o));function Eo(e,t){const n=t==="white"?"1":"8",r=[];for(const[i,o]of e)i[1]===n&&o.color===t&&o.role==="rook"&&r.push(N(i)[0]);return r}function Ar(e,t,n){const r=e.get(t);if(!r)return[];const i=N(t),o=r.role,s=o==="pawn"?Co(r.color):o==="knight"?vr:o==="bishop"?Cr:o==="rook"?Pr:o==="queen"?Er:Po(r.color,Eo(e,r.color),n);return wr.filter(c=>(i[0]!==c[0]||i[1]!==c[1])&&s(i[0],i[1],c[0],c[1])).map(ee)}function Y(e,...t){e&&setTimeout(()=>e(...t),1)}function Ao(e){e.orientation=hn(e.orientation),e.animation.current=e.draggable.current=e.selected=void 0}function _o(e,t){for(const[n,r]of t)r?e.pieces.set(n,r):e.pieces.delete(n)}function So(e,t){if(e.check=void 0,t===!0&&(t=e.turnColor),t)for(const[n,r]of e.pieces)r.role==="king"&&r.color===t&&(e.check=n)}function xo(e,t,n,r){me(e),e.premovable.current=[t,n],Y(e.premovable.events.set,t,n,r)}function ge(e){e.premovable.current&&(e.premovable.current=void 0,Y(e.premovable.events.unset))}function Ro(e,t,n){ge(e),e.predroppable.current={role:t,key:n},Y(e.predroppable.events.set,t,n)}function me(e){const t=e.predroppable;t.current&&(t.current=void 0,Y(t.events.unset))}function Oo(e,t,n){if(!e.autoCastle)return!1;const r=e.pieces.get(t);if(!r||r.role!=="king")return!1;const i=N(t),o=N(n);if(i[1]!==0&&i[1]!==7||i[1]!==o[1])return!1;i[0]===4&&!e.pieces.has(n)&&(o[0]===6?n=ee([7,o[1]]):o[0]===2&&(n=ee([0,o[1]])));const s=e.pieces.get(n);return!s||s.color!==r.color||s.role!=="rook"?!1:(e.pieces.delete(t),e.pieces.delete(n),i[0]<o[0]?(e.pieces.set(ee([6,o[1]]),r),e.pieces.set(ee([5,o[1]]),s)):(e.pieces.set(ee([2,o[1]]),r),e.pieces.set(ee([3,o[1]]),s)),!0)}function _r(e,t,n){const r=e.pieces.get(t),i=e.pieces.get(n);if(t===n||!r)return!1;const o=i&&i.color!==r.color?i:void 0;return n===e.selected&&te(e),Y(e.events.move,t,n,o),Oo(e,t,n)||(e.pieces.set(n,r),e.pieces.delete(t)),e.lastMove=[t,n],e.check=void 0,Y(e.events.change),o||!0}function gn(e,t,n,r){if(e.pieces.has(n))if(r)e.pieces.delete(n);else return!1;return Y(e.events.dropNewPiece,t,n),e.pieces.set(n,t),e.lastMove=[n],e.check=void 0,Y(e.events.change),e.movable.dests=void 0,e.turnColor=hn(e.turnColor),!0}function Sr(e,t,n){const r=_r(e,t,n);return r&&(e.movable.dests=void 0,e.turnColor=hn(e.turnColor),e.animation.current=void 0),r}function xr(e,t,n){if(mn(e,t,n)){const r=Sr(e,t,n);if(r){const i=e.hold.stop();te(e);const o={premove:!1,ctrlKey:e.stats.ctrlKey,holdTime:i};return r!==!0&&(o.captured=r),Y(e.movable.events.after,t,n,o),!0}}else if(Mo(e,t,n))return xo(e,t,n,{ctrlKey:e.stats.ctrlKey}),te(e),!0;return te(e),!1}function Rr(e,t,n,r){const i=e.pieces.get(t);i&&($o(e,t,n)||r)?(e.pieces.delete(t),gn(e,i,n,r),Y(e.movable.events.afterNewPiece,i.role,n,{premove:!1,predrop:!1})):i&&Lo(e,t,n)?Ro(e,i.role,n):(ge(e),me(e)),e.pieces.delete(t),te(e)}function Ht(e,t,n){if(Y(e.events.select,t),e.selected){if(e.selected===t&&!e.draggable.enabled){te(e),e.hold.cancel();return}else if((e.selectable.enabled||n)&&e.selected!==t&&xr(e,e.selected,t)){e.stats.dragged=!1;return}}(e.selectable.enabled||e.draggable.enabled)&&($r(e,t)||wn(e,t))&&(Or(e,t),e.hold.start())}function Or(e,t){e.selected=t,wn(e,t)?e.premovable.customDests||(e.premovable.dests=Ar(e.pieces,t,e.premovable.castle)):e.premovable.dests=void 0}function te(e){e.selected=void 0,e.premovable.dests=void 0,e.hold.cancel()}function $r(e,t){const n=e.pieces.get(t);return!!n&&(e.movable.color==="both"||e.movable.color===n.color&&e.turnColor===n.color)}const mn=(e,t,n)=>{var r,i;return t!==n&&$r(e,t)&&(e.movable.free||!!(!((i=(r=e.movable.dests)===null||r===void 0?void 0:r.get(t))===null||i===void 0)&&i.includes(n)))};function $o(e,t,n){const r=e.pieces.get(t);return!!r&&(t===n||!e.pieces.has(n))&&(e.movable.color==="both"||e.movable.color===r.color&&e.turnColor===r.color)}function wn(e,t){const n=e.pieces.get(t);return!!n&&e.premovable.enabled&&e.movable.color===n.color&&e.turnColor!==n.color}function Mo(e,t,n){var r,i;const o=(i=(r=e.premovable.customDests)===null||r===void 0?void 0:r.get(t))!==null&&i!==void 0?i:Ar(e.pieces,t,e.premovable.castle);return t!==n&&wn(e,t)&&o.includes(n)}function Lo(e,t,n){const r=e.pieces.get(t),i=e.pieces.get(n);return!!r&&(!i||i.color!==e.movable.color)&&e.predroppable.enabled&&(r.role!=="pawn"||n[1]!=="1"&&n[1]!=="8")&&e.movable.color===r.color&&e.turnColor!==r.color}function To(e,t){const n=e.pieces.get(t);return!!n&&e.draggable.enabled&&(e.movable.color==="both"||e.movable.color===n.color&&(e.turnColor===n.color||e.premovable.enabled))}function No(e){const t=e.premovable.current;if(!t)return!1;const n=t[0],r=t[1];let i=!1;if(mn(e,n,r)){const o=Sr(e,n,r);if(o){const s={premove:!0};o!==!0&&(s.captured=o),Y(e.movable.events.after,n,r,s),i=!0}}return ge(e),i}function Do(e,t){const n=e.predroppable.current;let r=!1;if(!n)return!1;if(t(n)){const i={role:n.role,color:e.movable.color};gn(e,i,n.key)&&(Y(e.movable.events.afterNewPiece,n.role,n.key,{premove:!1,predrop:!0}),r=!0)}return me(e),r}function bn(e){ge(e),me(e),te(e)}function Nn(e){e.movable.color=e.movable.dests=e.animation.current=void 0,bn(e)}function _e(e,t,n){let r=Math.floor(8*(e[0]-n.left)/n.width);t||(r=7-r);let i=7-Math.floor(8*(e[1]-n.top)/n.height);return t||(i=7-i),r>=0&&r<8&&i>=0&&i<8?ee([r,i]):void 0}function Io(e,t,n,r){const i=N(e),o=wr.filter(a=>Er(i[0],i[1],a[0],a[1])||vr(i[0],i[1],a[0],a[1])),c=o.map(a=>yr(ee(a),n,r)).map(a=>qe(t,a)),[,l]=c.reduce((a,f,u)=>a[0]<f?a:[f,u],[c[0],0]);return ee(o[l])}const X=e=>e.orientation==="white",Mr="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",Ko={p:"pawn",r:"rook",n:"knight",b:"bishop",q:"queen",k:"king"},Fo={pawn:"p",rook:"r",knight:"n",bishop:"b",queen:"q",king:"k"};function Lr(e){e==="start"&&(e=Mr);const t=new Map;let n=7,r=0;for(const i of e)switch(i){case" ":case"[":return t;case"/":if(--n,n<0)return t;r=0;break;case"~":{const o=t.get(ee([r-1,n]));o&&(o.promoted=!0);break}default:{const o=i.charCodeAt(0);if(o<57)r+=o-48;else{const s=i.toLowerCase();t.set(ee([r,n]),{role:Ko[s],color:i===s?"black":"white"}),++r}}}return t}function Bo(e){return ko.map(t=>ut.map(n=>{const r=e.get(n+t);if(r){let i=Fo[r.role];return r.color==="white"&&(i=i.toUpperCase()),r.promoted&&(i+="~"),i}else return"1"}).join("")).join("/").replace(/1{2,}/g,t=>t.length.toString())}function Tr(e,t){t.animation&&(kn(e.animation,t.animation),(e.animation.duration||0)<70&&(e.animation.enabled=!1))}function Nr(e,t){var n,r,i;if(!((n=t.movable)===null||n===void 0)&&n.dests&&(e.movable.dests=void 0),!((r=t.drawable)===null||r===void 0)&&r.autoShapes&&(e.drawable.autoShapes=[]),kn(e,t),t.fen&&(e.pieces=Lr(t.fen),e.drawable.shapes=((i=t.drawable)===null||i===void 0?void 0:i.shapes)||[]),"check"in t&&So(e,t.check||!1),"lastMove"in t&&!t.lastMove?e.lastMove=void 0:t.lastMove&&(e.lastMove=t.lastMove),e.selected&&Or(e,e.selected),Tr(e,t),!e.movable.rookCastle&&e.movable.dests){const o=e.movable.color==="white"?"1":"8",s="e"+o,c=e.movable.dests.get(s),l=e.pieces.get(s);if(!c||!l||l.role!=="king")return;e.movable.dests.set(s,c.filter(a=>!(a==="a"+o&&c.includes("c"+o))&&!(a==="h"+o&&c.includes("g"+o))))}}function kn(e,t){for(const n in t)n==="__proto__"||n==="constructor"||!Object.prototype.hasOwnProperty.call(t,n)||(Object.prototype.hasOwnProperty.call(e,n)&&Dn(e[n])&&Dn(t[n])?kn(e[n],t[n]):e[n]=t[n])}function Dn(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return t===Object.prototype||t===null}const we=(e,t)=>t.animation.enabled?Wo(e,t):de(e,t);function de(e,t){const n=e(t);return t.dom.redraw(),n}const Mt=(e,t)=>({key:e,pos:N(e),piece:t}),jo=(e,t)=>t.sort((n,r)=>qe(e.pos,n.pos)-qe(e.pos,r.pos))[0];function Uo(e,t){const n=new Map,r=[],i=new Map,o=[],s=[],c=new Map;let l,a,f;for(const[u,h]of e)c.set(u,Mt(u,h));for(const u of dn)l=t.pieces.get(u),a=c.get(u),l?a?zt(l,a.piece)||(o.push(a),s.push(Mt(u,l))):s.push(Mt(u,l)):a&&o.push(a);for(const u of s)a=jo(u,o.filter(h=>zt(u.piece,h.piece))),a&&(f=[a.pos[0]-u.pos[0],a.pos[1]-u.pos[1]],n.set(u.key,f.concat(f)),r.push(a.key));for(const u of o)r.includes(u.key)||i.set(u.key,u.piece);return{anims:n,fadings:i}}function Dr(e,t){const n=e.animation.current;if(n===void 0){e.dom.destroyed||e.dom.redrawNow();return}const r=1-(t-n.start)*n.frequency;if(r<=0)e.animation.current=void 0,e.dom.redrawNow();else{const i=zo(r);for(const o of n.plan.anims.values())o[2]=o[0]*i,o[3]=o[1]*i;e.dom.redrawNow(!0),requestAnimationFrame((o=performance.now())=>Dr(e,o))}}function Wo(e,t){const n=new Map(t.pieces),r=e(t),i=Uo(n,t);if(i.anims.size||i.fadings.size){const o=t.animation.current&&t.animation.current.start;t.animation.current={start:performance.now(),frequency:1/t.animation.duration,plan:i},o||Dr(t,performance.now())}else t.dom.redraw();return r}const zo=e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1,Ho=["green","red","blue","yellow"];function qo(e,t){if(t.touches&&t.touches.length>1)return;t.stopPropagation(),t.preventDefault(),t.ctrlKey?te(e):bn(e);const n=Ae(t),r=_e(n,X(e),e.dom.bounds());r&&(e.drawable.current={orig:r,pos:n,brush:Yo(t),snapToValidMove:e.drawable.defaultSnapToValidMove},Ir(e))}function Ir(e){requestAnimationFrame(()=>{const t=e.drawable.current;if(t){const n=_e(t.pos,X(e),e.dom.bounds());n||(t.snapToValidMove=!1);const r=t.snapToValidMove?Io(t.orig,t.pos,X(e),e.dom.bounds()):n;r!==t.mouseSq&&(t.mouseSq=r,t.dest=r!==t.orig?r:void 0,e.dom.redrawNow()),Ir(e)}})}function Vo(e,t){e.drawable.current&&(e.drawable.current.pos=Ae(t))}function Go(e){const t=e.drawable.current;t&&(t.mouseSq&&Xo(e.drawable,t),Kr(e))}function Kr(e){e.drawable.current&&(e.drawable.current=void 0,e.dom.redraw())}function Qo(e){e.drawable.shapes.length&&(e.drawable.shapes=[],e.dom.redraw(),Fr(e.drawable))}function Yo(e){var t;const n=(e.shiftKey||e.ctrlKey)&&kr(e),r=e.altKey||e.metaKey||((t=e.getModifierState)===null||t===void 0?void 0:t.call(e,"AltGraph"));return Ho[(n?1:0)+(r?2:0)]}function Xo(e,t){const n=i=>i.orig===t.orig&&i.dest===t.dest,r=e.shapes.find(n);r&&(e.shapes=e.shapes.filter(i=>!n(i))),(!r||r.brush!==t.brush)&&e.shapes.push({orig:t.orig,dest:t.dest,brush:t.brush}),Fr(e)}function Fr(e){e.onChange&&e.onChange(e.shapes)}function Zo(e,t){if(!(e.trustAllEvents||t.isTrusted)||t.buttons!==void 0&&t.buttons>1||t.touches&&t.touches.length>1)return;const n=e.dom.bounds(),r=Ae(t),i=_e(r,X(e),n);if(!i)return;const o=e.pieces.get(i),s=e.selected;if(!s&&e.drawable.enabled&&(e.drawable.eraseOnClick||!o||o.color!==e.turnColor)&&Qo(e),t.cancelable!==!1&&(!t.touches||e.blockTouchScroll||o||s||Jo(e,r)))t.preventDefault();else if(t.touches)return;const c=!!e.premovable.current,l=!!e.predroppable.current;e.stats.ctrlKey=t.ctrlKey,e.selected&&mn(e,e.selected,i)?we(u=>Ht(u,i),e):Ht(e,i);const a=e.selected===i,f=jr(e,i);if(o&&f&&a&&To(e,i)){e.draggable.current={orig:i,piece:o,origPos:r,pos:r,started:e.draggable.autoDistance&&e.stats.dragged,element:f,previouslySelected:s,originTarget:t.target,keyHasChanged:!1},f.cgDragging=!0,f.classList.add("dragging");const u=e.dom.elements.ghost;u&&(u.className=`ghost ${o.color} ${o.role}`,ie(u,et(n)(N(i),X(e))),pn(u,!0)),yn(e)}else c&&ge(e),l&&me(e);e.dom.redraw()}function Jo(e,t){const n=X(e),r=e.dom.bounds(),i=Math.pow(r.width/8,2);for(const o of e.pieces.keys()){const s=yr(o,n,r);if(qe(s,t)<=i)return!0}return!1}function es(e,t,n,r){e.pieces.set("a0",t),e.dom.redraw();const o=Ae(n);e.draggable.current={orig:"a0",piece:t,origPos:o,pos:o,started:!0,element:()=>jr(e,"a0"),originTarget:n.target,newPiece:!0,force:!!r,keyHasChanged:!1},yn(e)}function yn(e){requestAnimationFrame(()=>{var t;const n=e.draggable.current;if(!n)return;!((t=e.animation.current)===null||t===void 0)&&t.plan.anims.has(n.orig)&&(e.animation.current=void 0);const r=e.pieces.get(n.orig);if(!r||!zt(r,n.piece))dt(e);else if(!n.started&&qe(n.pos,n.origPos)>=Math.pow(e.draggable.distance,2)&&(n.started=!0),n.started){if(typeof n.element=="function"){const o=n.element();if(!o)return;o.cgDragging=!0,o.classList.add("dragging"),n.element=o}const i=e.dom.bounds();ie(n.element,[n.pos[0]-i.left-i.width/16,n.pos[1]-i.top-i.height/16]),n.keyHasChanged||(n.keyHasChanged=n.orig!==_e(n.pos,X(e),i))}yn(e)})}function ts(e,t){e.draggable.current&&(!t.touches||t.touches.length<2)&&(e.draggable.current.pos=Ae(t))}function ns(e,t){const n=e.draggable.current;if(!n)return;if(t.type==="touchend"&&t.cancelable!==!1&&t.preventDefault(),t.type==="touchend"&&n.originTarget!==t.target&&!n.newPiece){e.draggable.current=void 0;return}ge(e),me(e);const r=Ae(t)||n.pos,i=_e(r,X(e),e.dom.bounds());i&&n.started&&n.orig!==i?n.newPiece?Rr(e,n.orig,i,n.force):(e.stats.ctrlKey=t.ctrlKey,xr(e,n.orig,i)&&(e.stats.dragged=!0)):n.newPiece?e.pieces.delete(n.orig):e.draggable.deleteOnDropOff&&!i&&(e.pieces.delete(n.orig),Y(e.events.change)),(n.orig===n.previouslySelected||n.keyHasChanged)&&(n.orig===i||!i)?te(e):e.selectable.enabled||te(e),Br(e),e.draggable.current=void 0,e.dom.redraw()}function dt(e){const t=e.draggable.current;t&&(t.newPiece&&e.pieces.delete(t.orig),e.draggable.current=void 0,te(e),Br(e),e.dom.redraw())}function Br(e){const t=e.dom.elements;t.ghost&&pn(t.ghost,!1)}function jr(e,t){let n=e.dom.elements.board.firstChild;for(;n;){if(n.cgKey===t&&n.tagName==="PIECE")return n;n=n.nextSibling}}function rs(e,t){e.exploding={stage:1,keys:t},e.dom.redraw(),setTimeout(()=>{In(e,2),setTimeout(()=>In(e,void 0),120)},120)}function In(e,t){e.exploding&&(t?e.exploding.stage=t:e.exploding=void 0,e.dom.redraw())}function is(e,t){function n(){Ao(e),t()}return{set(r){r.orientation&&r.orientation!==e.orientation&&n(),Tr(e,r),(r.fen?we:de)(i=>Nr(i,r),e)},state:e,getFen:()=>Bo(e.pieces),toggleOrientation:n,setPieces(r){we(i=>_o(i,r),e)},selectSquare(r,i){r?we(o=>Ht(o,r,i),e):e.selected&&(te(e),e.dom.redraw())},move(r,i){we(o=>_r(o,r,i),e)},newPiece(r,i){we(o=>gn(o,r,i),e)},playPremove(){if(e.premovable.current){if(we(No,e))return!0;e.dom.redraw()}return!1},playPredrop(r){if(e.predroppable.current){const i=Do(e,r);return e.dom.redraw(),i}return!1},cancelPremove(){de(ge,e)},cancelPredrop(){de(me,e)},cancelMove(){de(r=>{bn(r),dt(r)},e)},stop(){de(r=>{Nn(r),dt(r)},e)},explode(r){rs(e,r)},setAutoShapes(r){de(i=>i.drawable.autoShapes=r,e)},setShapes(r){de(i=>i.drawable.shapes=r,e)},getKeyAtDomPos(r){return _e(r,X(e),e.dom.bounds())},redrawAll:t,dragNewPiece(r,i,o){es(e,r,i,o)},destroy(){Nn(e),e.dom.unbind&&e.dom.unbind(),e.dom.destroyed=!0}}}function os(){return{pieces:Lr(Mr),orientation:"white",turnColor:"white",coordinates:!0,coordinatesOnSquares:!1,ranksPosition:"right",autoCastle:!0,viewOnly:!1,disableContextMenu:!1,addPieceZIndex:!1,blockTouchScroll:!1,pieceKey:!1,trustAllEvents:!1,highlight:{lastMove:!0,check:!0},animation:{enabled:!0,duration:200},movable:{free:!0,color:"both",showDests:!0,events:{},rookCastle:!0},premovable:{enabled:!0,showDests:!0,castle:!0,events:{}},predroppable:{enabled:!1,events:{}},draggable:{enabled:!0,distance:3,autoDistance:!0,showGhost:!0,deleteOnDropOff:!1},dropmode:{active:!1},selectable:{enabled:!0},stats:{dragged:!("ontouchstart"in window)},events:{},drawable:{enabled:!0,visible:!0,defaultSnapToValidMove:!0,eraseOnClick:!0,shapes:[],autoShapes:[],brushes:{green:{key:"g",color:"#15781B",opacity:1,lineWidth:10},red:{key:"r",color:"#882020",opacity:1,lineWidth:10},blue:{key:"b",color:"#003088",opacity:1,lineWidth:10},yellow:{key:"y",color:"#e68f00",opacity:1,lineWidth:10},paleBlue:{key:"pb",color:"#003088",opacity:.4,lineWidth:15},paleGreen:{key:"pg",color:"#15781B",opacity:.4,lineWidth:15},paleRed:{key:"pr",color:"#882020",opacity:.4,lineWidth:15},paleGrey:{key:"pgr",color:"#4a4a4a",opacity:.35,lineWidth:15},purple:{key:"purple",color:"#68217a",opacity:.65,lineWidth:10},pink:{key:"pink",color:"#ee2080",opacity:.5,lineWidth:10},white:{key:"white",color:"white",opacity:1,lineWidth:10}},prevSvgHash:""},hold:vo()}}const Kn={hilitePrimary:{key:"hilitePrimary",color:"#3291ff",opacity:1,lineWidth:1},hiliteWhite:{key:"hiliteWhite",color:"#ffffff",opacity:1,lineWidth:1}};function ss(){const e=F("defs"),t=G(F("filter"),{id:"cg-filter-blur"});return t.appendChild(G(F("feGaussianBlur"),{stdDeviation:"0.019"})),e.appendChild(t),e}function cs(e,t,n){var r;const i=e.drawable,o=i.current,s=o&&o.mouseSq?o:void 0,c=new Map,l=e.dom.bounds(),a=i.autoShapes.filter(g=>!g.piece);for(const g of i.shapes.concat(a).concat(s?[s]:[])){if(!g.dest)continue;const m=(r=c.get(g.dest))!==null&&r!==void 0?r:new Set,p=gt(pt(N(g.orig),e.orientation),l),w=gt(pt(N(g.dest),e.orientation),l);m.add(Vt(p,w)),c.set(g.dest,m)}const f=i.shapes.concat(a).map(g=>({shape:g,current:!1,hash:Fn(g,qt(g.dest,c),!1,l)}));s&&f.push({shape:s,current:!0,hash:Fn(s,qt(s.dest,c),!0,l)});const u=f.map(g=>g.hash).join(";");if(u===e.drawable.prevSvgHash)return;e.drawable.prevSvgHash=u;const h=t.querySelector("defs");ls(i,f,h),as(f,t.querySelector("g"),n.querySelector("g"),g=>ds(e,g,i.brushes,c,l))}function ls(e,t,n){var r;const i=new Map;let o;for(const l of t.filter(a=>a.shape.dest&&a.shape.brush))o=Ur(e.brushes[l.shape.brush],l.shape.modifiers),!((r=l.shape.modifiers)===null||r===void 0)&&r.hilite&&i.set(ht(o).key,ht(o)),i.set(o.key,o);const s=new Set;let c=n.firstElementChild;for(;c;)s.add(c.getAttribute("cgKey")),c=c.nextElementSibling;for(const[l,a]of i.entries())s.has(l)||n.appendChild(gs(a))}function as(e,t,n,r){const i=new Map;for(const o of e)i.set(o.hash,!1);for(const o of[t,n]){const s=[];let c=o.firstElementChild,l;for(;c;)l=c.getAttribute("cgHash"),i.has(l)?i.set(l,!0):s.push(c),c=c.nextElementSibling;for(const a of s)o.removeChild(a)}for(const o of e.filter(s=>!i.get(s.hash)))for(const s of r(o))s.isCustom?n.appendChild(s.el):t.appendChild(s.el)}function Fn({orig:e,dest:t,brush:n,piece:r,modifiers:i,customSvg:o,label:s},c,l,a){var f,u;return[a.width,a.height,l,e,t,n,c&&"-",r&&us(r),i&&fs(i),o&&`custom-${Bn(o.html)},${(u=(f=o.center)===null||f===void 0?void 0:f[0])!==null&&u!==void 0?u:"o"}`,s&&`label-${Bn(s.text)}`].filter(h=>h).join(",")}function us(e){return[e.color,e.role,e.scale].filter(t=>t).join(",")}function fs(e){return[e.lineWidth,e.hilite&&"*"].filter(t=>t).join(",")}function Bn(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n)>>>0;return t.toString()}function ds(e,{shape:t,current:n,hash:r},i,o,s){var c,l;const a=gt(pt(N(t.orig),e.orientation),s),f=t.dest?gt(pt(N(t.dest),e.orientation),s):a,u=t.brush&&Ur(i[t.brush],t.modifiers),h=o.get(t.dest),g=[];if(u){const m=G(F("g"),{cgHash:r});g.push({el:m}),a[0]!==f[0]||a[1]!==f[1]?m.appendChild(ps(t,u,a,f,n,qt(t.dest,o))):m.appendChild(hs(i[t.brush],a,n,s))}if(t.label){const m=t.label;(c=m.fill)!==null&&c!==void 0||(m.fill=t.brush&&i[t.brush].color);const p=t.brush?void 0:"tr";g.push({el:ms(m,r,a,f,h,p),isCustom:!0})}if(t.customSvg){const m=(l=t.customSvg.center)!==null&&l!==void 0?l:"orig",[p,w]=m==="label"?zr(a,f,h).map(b=>b-.5):m==="dest"?f:a,k=G(F("g"),{transform:`translate(${p},${w})`,cgHash:r});k.innerHTML=`<svg width="1" height="1" viewBox="0 0 100 100">${t.customSvg.html}</svg>`,g.push({el:k,isCustom:!0})}return g}function hs(e,t,n,r){const i=ws(),o=(r.width+r.height)/(4*Math.max(r.width,r.height));return G(F("circle"),{stroke:e.color,"stroke-width":i[n?0:1],fill:"none",opacity:Wr(e,n),cx:t[0],cy:t[1],r:o-i[1]/2})}function ht(e){return["#ffffff","#fff","white"].includes(e.color)?Kn.hilitePrimary:Kn.hiliteWhite}function ps(e,t,n,r,i,o){var s;function c(f){var u;const h=ks(o&&!i),g=r[0]-n[0],m=r[1]-n[1],p=Math.atan2(m,g),w=Math.cos(p)*h,k=Math.sin(p)*h;return G(F("line"),{stroke:f?ht(t).color:t.color,"stroke-width":bs(t,i)+(f?.04:0),"stroke-linecap":"round","marker-end":`url(#arrowhead-${f?ht(t).key:t.key})`,opacity:!((u=e.modifiers)===null||u===void 0)&&u.hilite?1:Wr(t,i),x1:n[0],y1:n[1],x2:r[0]-w,y2:r[1]-k})}if(!(!((s=e.modifiers)===null||s===void 0)&&s.hilite))return c(!1);const l=F("g"),a=G(F("g"),{filter:"url(#cg-filter-blur)"});return a.appendChild(ys(n,r)),a.appendChild(c(!0)),l.appendChild(a),l.appendChild(c(!1)),l}function gs(e){const t=G(F("marker"),{id:"arrowhead-"+e.key,orient:"auto",overflow:"visible",markerWidth:4,markerHeight:4,refX:e.key.startsWith("hilite")?1.86:2.05,refY:2});return t.appendChild(G(F("path"),{d:"M0,0 V4 L3,2 Z",fill:e.color})),t.setAttribute("cgKey",e.key),t}function ms(e,t,n,r,i,o){var s;const l=.4*.75**e.text.length,a=zr(n,r,i),f=o==="tr"?.4:0,u=G(F("g"),{transform:`translate(${a[0]+f},${a[1]-f})`,cgHash:t});u.appendChild(G(F("circle"),{r:.4/2,"fill-opacity":o?1:.8,"stroke-opacity":o?1:.7,"stroke-width":.03,fill:(s=e.fill)!==null&&s!==void 0?s:"#666",stroke:"white"}));const h=G(F("text"),{"font-size":l,"font-family":"Noto Sans","text-anchor":"middle",fill:"white",y:.13*.75**e.text.length});return h.innerHTML=e.text,u.appendChild(h),u}function pt(e,t){return t==="white"?e:[7-e[0],7-e[1]]}function qt(e,t){return(e&&t.has(e)&&t.get(e).size>1)===!0}function F(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function G(e,t){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.setAttribute(n,t[n]);return e}function Ur(e,t){return t?{color:e.color,opacity:Math.round(e.opacity*10)/10,lineWidth:Math.round(t.lineWidth||e.lineWidth),key:[e.key,t.lineWidth].filter(n=>n).join("")}:e}function ws(){return[3/64,4/64]}function bs(e,t){return(e.lineWidth||10)*(t?.85:1)/64}function Wr(e,t){return(e.opacity||1)*(t?.9:1)}function ks(e){return(e?20:10)/64}function gt(e,t){const n=Math.min(1,t.width/t.height),r=Math.min(1,t.height/t.width);return[(e[0]-3.5)*n,(3.5-e[1])*r]}function ys(e,t){const n={from:[Math.floor(Math.min(e[0],t[0])),Math.floor(Math.min(e[1],t[1]))],to:[Math.ceil(Math.max(e[0],t[0])),Math.ceil(Math.max(e[1],t[1]))]};return G(F("rect"),{x:n.from[0],y:n.from[1],width:n.to[0]-n.from[0],height:n.to[1]-n.from[1],fill:"none",stroke:"none"})}function Vt(e,t,n=!0){const r=Math.atan2(t[1]-e[1],t[0]-e[0])+Math.PI;return n?(Math.round(r*8/Math.PI)+16)%16:r}function vs(e,t){return Math.sqrt([e[0]-t[0],e[1]-t[1]].reduce((n,r)=>n+r*r,0))}function zr(e,t,n){let r=vs(e,t);const i=Vt(e,t,!1);if(n&&(r-=33/64,n.size>1)){r-=10/64;const o=Vt(e,t);(n.has((o+1)%16)||n.has((o+15)%16))&&o&1&&(r-=.4)}return[e[0]-Math.cos(i)*r,e[1]-Math.sin(i)*r].map(o=>o+.5)}function Cs(e,t){e.innerHTML="",e.classList.add("cg-wrap");for(const l of bo)e.classList.toggle("orientation-"+l,t.orientation===l);e.classList.toggle("manipulable",!t.viewOnly);const n=ae("cg-container");e.appendChild(n);const r=ae("cg-board");n.appendChild(r);let i,o,s;if(t.drawable.visible&&(i=G(F("svg"),{class:"cg-shapes",viewBox:"-4 -4 8 8",preserveAspectRatio:"xMidYMid slice"}),i.appendChild(ss()),i.appendChild(F("g")),o=G(F("svg"),{class:"cg-custom-svgs",viewBox:"-3.5 -3.5 8 8",preserveAspectRatio:"xMidYMid slice"}),o.appendChild(F("g")),s=ae("cg-auto-pieces"),n.appendChild(i),n.appendChild(o),n.appendChild(s)),t.coordinates){const l=t.orientation==="black"?" black":"",a=t.ranksPosition==="left"?" left":"";if(t.coordinatesOnSquares){const f=t.orientation==="white"?u=>u+1:u=>8-u;ut.forEach((u,h)=>n.appendChild(Lt(ft.map(g=>u+g),"squares rank"+f(h)+l+a)))}else n.appendChild(Lt(ft,"ranks"+l+a)),n.appendChild(Lt(ut,"files"+l))}let c;return t.draggable.enabled&&t.draggable.showGhost&&(c=ae("piece","ghost"),pn(c,!1),n.appendChild(c)),{board:r,container:n,wrap:e,ghost:c,svg:i,customSvg:o,autoPieces:s}}function Lt(e,t){const n=ae("coords",t);let r;for(const i of e)r=ae("coord"),r.textContent=i,n.appendChild(r);return n}function Ps(e,t){if(!e.dropmode.active)return;ge(e),me(e);const n=e.dropmode.piece;if(n){e.pieces.set("a0",n);const r=Ae(t),i=r&&_e(r,X(e),e.dom.bounds());i&&Rr(e,"a0",i)}e.dom.redraw()}function Es(e,t){const n=e.dom.elements.board;if("ResizeObserver"in window&&new ResizeObserver(t).observe(e.dom.elements.wrap),(e.disableContextMenu||e.drawable.enabled)&&n.addEventListener("contextmenu",i=>i.preventDefault()),e.viewOnly)return;const r=_s(e);n.addEventListener("touchstart",r,{passive:!1}),n.addEventListener("mousedown",r,{passive:!1})}function As(e,t){const n=[];if("ResizeObserver"in window||n.push(Ie(document.body,"chessground.resize",t)),!e.viewOnly){const r=jn(e,ts,Vo),i=jn(e,ns,Go);for(const s of["touchmove","mousemove"])n.push(Ie(document,s,r));for(const s of["touchend","mouseup"])n.push(Ie(document,s,i));const o=()=>e.dom.bounds.clear();n.push(Ie(document,"scroll",o,{capture:!0,passive:!0})),n.push(Ie(window,"resize",o,{passive:!0}))}return()=>n.forEach(r=>r())}function Ie(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}const _s=e=>t=>{e.draggable.current?dt(e):e.drawable.current?Kr(e):t.shiftKey||kr(t)?e.drawable.enabled&&qo(e,t):e.viewOnly||(e.dropmode.active?Ps(e,t):Zo(e,t))},jn=(e,t,n)=>r=>{e.drawable.current?e.drawable.enabled&&n(e,r):e.viewOnly||t(e,r)};function Ss(e){const t=X(e),n=et(e.dom.bounds()),r=e.dom.elements.board,i=e.pieces,o=e.animation.current,s=o?o.plan.anims:new Map,c=o?o.plan.fadings:new Map,l=e.draggable.current,a=Rs(e),f=new Set,u=new Set,h=new Map,g=new Map;let m,p,w,k,b,A,_,C,H,q;for(p=r.firstChild;p;){if(m=p.cgKey,Hr(p))if(w=i.get(m),b=s.get(m),A=c.get(m),k=p.cgPiece,p.cgDragging&&(!l||l.orig!==m)&&(p.classList.remove("dragging"),ie(p,n(N(m),t)),p.cgDragging=!1),!A&&p.cgFading&&(p.cgFading=!1,p.classList.remove("fading")),w){if(b&&p.cgAnimating&&k===Ke(w)){const $=N(m);$[0]+=b[2],$[1]+=b[3],p.classList.add("anim"),ie(p,n($,t))}else p.cgAnimating&&(p.cgAnimating=!1,p.classList.remove("anim"),ie(p,n(N(m),t)),e.addPieceZIndex&&(p.style.zIndex=Tt(N(m),t)));k===Ke(w)&&(!A||!p.cgFading)?f.add(m):A&&k===Ke(A)?(p.classList.add("fading"),p.cgFading=!0):Nt(h,k,p)}else Nt(h,k,p);else if(qr(p)){const $=p.className;a.get(m)===$?u.add(m):Nt(g,$,p)}p=p.nextSibling}for(const[$,V]of a)if(!u.has($)){H=g.get(V),q=H&&H.pop();const R=n(N($),t);if(q)q.cgKey=$,ie(q,R);else{const S=ae("square",V);S.cgKey=$,ie(S,R),r.insertBefore(S,r.firstChild)}}for(const[$,V]of i)if(b=s.get($),!f.has($))if(_=h.get(Ke(V)),C=_&&_.pop(),C){C.cgKey=$,C.cgFading&&(C.classList.remove("fading"),C.cgFading=!1);const R=N($);e.addPieceZIndex&&(C.style.zIndex=Tt(R,t)),b&&(C.cgAnimating=!0,C.classList.add("anim"),R[0]+=b[2],R[1]+=b[3]),ie(C,n(R,t))}else{const R=Ke(V),S=ae("piece",R),I=N($);S.cgPiece=R,S.cgKey=$,b&&(S.cgAnimating=!0,I[0]+=b[2],I[1]+=b[3]),ie(S,n(I,t)),e.addPieceZIndex&&(S.style.zIndex=Tt(I,t)),r.appendChild(S)}for(const $ of h.values())Wn(e,$);for(const $ of g.values())Wn(e,$)}function xs(e){const t=X(e),n=et(e.dom.bounds());let r=e.dom.elements.board.firstChild;for(;r;)(Hr(r)&&!r.cgAnimating||qr(r))&&ie(r,n(N(r.cgKey),t)),r=r.nextSibling}function Un(e){var t,n;const r=e.dom.elements.wrap.getBoundingClientRect(),i=e.dom.elements.container,o=r.height/r.width,s=Math.floor(r.width*window.devicePixelRatio/8)*8/window.devicePixelRatio,c=s*o;i.style.width=s+"px",i.style.height=c+"px",e.dom.bounds.clear(),(t=e.addDimensionsCssVarsTo)===null||t===void 0||t.style.setProperty("---cg-width",s+"px"),(n=e.addDimensionsCssVarsTo)===null||n===void 0||n.style.setProperty("---cg-height",c+"px")}const Hr=e=>e.tagName==="PIECE",qr=e=>e.tagName==="SQUARE";function Wn(e,t){for(const n of t)e.dom.elements.board.removeChild(n)}function Tt(e,t){const r=e[1];return`${t?10-r:3+r}`}const Ke=e=>`${e.color} ${e.role}`;function Rs(e){var t,n,r;const i=new Map;if(e.lastMove&&e.highlight.lastMove)for(const c of e.lastMove)le(i,c,"last-move");if(e.check&&e.highlight.check&&le(i,e.check,"check"),e.selected&&(le(i,e.selected,"selected"),e.movable.showDests)){const c=(t=e.movable.dests)===null||t===void 0?void 0:t.get(e.selected);if(c)for(const a of c)le(i,a,"move-dest"+(e.pieces.has(a)?" oc":""));const l=(r=(n=e.premovable.customDests)===null||n===void 0?void 0:n.get(e.selected))!==null&&r!==void 0?r:e.premovable.dests;if(l)for(const a of l)le(i,a,"premove-dest"+(e.pieces.has(a)?" oc":""))}const o=e.premovable.current;if(o)for(const c of o)le(i,c,"current-premove");else e.predroppable.current&&le(i,e.predroppable.current.key,"current-premove");const s=e.exploding;if(s)for(const c of s.keys)le(i,c,"exploding"+s.stage);return e.highlight.custom&&e.highlight.custom.forEach((c,l)=>{le(i,l,c)}),i}function le(e,t,n){const r=e.get(t);r?e.set(t,`${r} ${n}`):e.set(t,n)}function Nt(e,t,n){const r=e.get(t);r?r.push(n):e.set(t,[n])}function Os(e,t,n){const r=new Map,i=[];for(const c of e)r.set(c.hash,!1);let o=t.firstElementChild,s;for(;o;)s=o.getAttribute("cgHash"),r.has(s)?r.set(s,!0):i.push(o),o=o.nextElementSibling;for(const c of i)t.removeChild(c);for(const c of e)r.get(c.hash)||t.appendChild(n(c))}function $s(e,t){const r=e.drawable.autoShapes.filter(i=>i.piece).map(i=>({shape:i,hash:Ts(i),current:!1}));Os(r,t,i=>Ls(e,i,e.dom.bounds()))}function Ms(e){var t;const n=X(e),r=et(e.dom.bounds());let i=(t=e.dom.elements.autoPieces)===null||t===void 0?void 0:t.firstChild;for(;i;)br(i,r(N(i.cgKey),n),i.cgScale),i=i.nextSibling}function Ls(e,{shape:t,hash:n},r){var i,o,s;const c=t.orig,l=(i=t.piece)===null||i===void 0?void 0:i.role,a=(o=t.piece)===null||o===void 0?void 0:o.color,f=(s=t.piece)===null||s===void 0?void 0:s.scale,u=ae("piece",`${l} ${a}`);return u.setAttribute("cgHash",n),u.cgKey=c,u.cgScale=f,br(u,et(r)(N(c),X(e)),f),u}const Ts=e=>{var t,n,r;return[e.orig,(t=e.piece)===null||t===void 0?void 0:t.role,(n=e.piece)===null||n===void 0?void 0:n.color,(r=e.piece)===null||r===void 0?void 0:r.scale].join(",")};function Ns(e,t){const n=os();Nr(n,t||{});function r(){const i="dom"in n?n.dom.unbind:void 0,o=Cs(e,n),s=yo(()=>o.board.getBoundingClientRect()),c=f=>{Ss(a),o.autoPieces&&$s(a,o.autoPieces),!f&&o.svg&&cs(a,o.svg,o.customSvg)},l=()=>{Un(a),xs(a),o.autoPieces&&Ms(a)},a=n;return a.dom={elements:o,bounds:s,redraw:Ds(c),redrawNow:c,unbind:i},a.drawable.prevSvgHash="",Un(a),c(!1),Es(a,l),i||(a.dom.unbind=As(a,l)),a.events.insert&&a.events.insert(o),a}return is(r(),r)}function Ds(e){let t=!1;return()=>{t||(t=!0,requestAnimationFrame(()=>{e(),t=!1}))}}const mt=["a","b","c","d","e","f","g","h"],Vr=["1","2","3","4","5","6","7","8"],Pe=["white","black"],re=["pawn","knight","bishop","rook","queen","king"],Is=["a","h"],wt=e=>"role"in e,y=e=>e!==void 0,j=e=>e==="white"?"black":"white",Ee=e=>e>>3,J=e=>e&7,Gt=(e,t)=>0<=e&&e<8&&0<=t&&t<8?e+8*t:void 0,Ue=e=>{switch(e){case"pawn":return"p";case"knight":return"n";case"bishop":return"b";case"rook":return"r";case"queen":return"q";case"king":return"k"}};function Qt(e){switch(e.toLowerCase()){case"p":return"pawn";case"n":return"knight";case"b":return"bishop";case"r":return"rook";case"q":return"queen";case"k":return"king";default:return}}function We(e){if(e.length===2)return Gt(e.charCodeAt(0)-97,e.charCodeAt(1)-49)}const Ve=e=>mt[J(e)]+Vr[Ee(e)],Ks=e=>{if(e[1]==="@"&&e.length===4){const t=Qt(e[0]),n=We(e.slice(2));if(t&&y(n))return{role:t,to:n}}else if(e.length===4||e.length===5){const t=We(e.slice(0,2)),n=We(e.slice(2,4));let r;if(e.length===5&&(r=Qt(e[4]),!r))return;if(y(t)&&y(n))return{from:t,to:n,promotion:r}}},vn=(e,t)=>e==="white"?t==="a"?2:6:t==="a"?58:62,Cn=(e,t)=>e==="white"?t==="a"?3:5:t==="a"?59:61,Fs=(e,t)=>{const n=new Map,r=e.ctx();for(const[i,o]of e.allDests(r))if(o.nonEmpty()){const s=Array.from(o,Ve);i===r.king&&J(i)===4&&(o.has(0)?s.push("c1"):o.has(56)&&s.push("c8"),o.has(7)?s.push("g1"):o.has(63)&&s.push("g8")),n.set(Ve(i),s)}return n};function Bs(e){let t=0;return n=>{t+=n.deltaY*(n.deltaMode?40:1),Math.abs(t)>=4?(e(n,!0),t=0):e(n,!1)}}const zn=e=>(e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),Math.imul(e+(e>>>4)&252645135,16843009)>>24),Yt=e=>(e=e>>>8&16711935|(e&16711935)<<8,e>>>16&65535|(e&65535)<<16),Hn=e=>(e=e>>>1&1431655765|(e&1431655765)<<1,e=e>>>2&858993459|(e&858993459)<<2,e=e>>>4&252645135|(e&252645135)<<4,Yt(e));class d{constructor(t,n){this.lo=t|0,this.hi=n|0}static fromSquare(t){return t>=32?new d(0,1<<t-32):new d(1<<t,0)}static fromRank(t){return new d(255,0).shl64(8*t)}static fromFile(t){return new d(16843009<<t,16843009<<t)}static empty(){return new d(0,0)}static full(){return new d(4294967295,4294967295)}static corners(){return new d(129,2164260864)}static center(){return new d(402653184,24)}static backranks(){return new d(255,4278190080)}static backrank(t){return t==="white"?new d(255,0):new d(0,4278190080)}static lightSquares(){return new d(1437226410,1437226410)}static darkSquares(){return new d(2857740885,2857740885)}complement(){return new d(~this.lo,~this.hi)}xor(t){return new d(this.lo^t.lo,this.hi^t.hi)}union(t){return new d(this.lo|t.lo,this.hi|t.hi)}intersect(t){return new d(this.lo&t.lo,this.hi&t.hi)}diff(t){return new d(this.lo&~t.lo,this.hi&~t.hi)}intersects(t){return this.intersect(t).nonEmpty()}isDisjoint(t){return this.intersect(t).isEmpty()}supersetOf(t){return t.diff(this).isEmpty()}subsetOf(t){return this.diff(t).isEmpty()}shr64(t){return t>=64?d.empty():t>=32?new d(this.hi>>>t-32,0):t>0?new d(this.lo>>>t^this.hi<<32-t,this.hi>>>t):this}shl64(t){return t>=64?d.empty():t>=32?new d(0,this.lo<<t-32):t>0?new d(this.lo<<t,this.hi<<t^this.lo>>>32-t):this}bswap64(){return new d(Yt(this.hi),Yt(this.lo))}rbit64(){return new d(Hn(this.hi),Hn(this.lo))}minus64(t){const n=this.lo-t.lo,r=(n&t.lo&1)+(t.lo>>>1)+(n>>>1)>>>31;return new d(n,this.hi-(t.hi+r))}equals(t){return this.lo===t.lo&&this.hi===t.hi}size(){return zn(this.lo)+zn(this.hi)}isEmpty(){return this.lo===0&&this.hi===0}nonEmpty(){return this.lo!==0||this.hi!==0}has(t){return(t>=32?this.hi&1<<t-32:this.lo&1<<t)!==0}set(t,n){return n?this.with(t):this.without(t)}with(t){return t>=32?new d(this.lo,this.hi|1<<t-32):new d(this.lo|1<<t,this.hi)}without(t){return t>=32?new d(this.lo,this.hi&~(1<<t-32)):new d(this.lo&~(1<<t),this.hi)}toggle(t){return t>=32?new d(this.lo,this.hi^1<<t-32):new d(this.lo^1<<t,this.hi)}last(){if(this.hi!==0)return 63-Math.clz32(this.hi);if(this.lo!==0)return 31-Math.clz32(this.lo)}first(){if(this.lo!==0)return 31-Math.clz32(this.lo&-this.lo);if(this.hi!==0)return 63-Math.clz32(this.hi&-this.hi)}withoutFirst(){return this.lo!==0?new d(this.lo&this.lo-1,this.hi):new d(0,this.hi&this.hi-1)}moreThanOne(){return this.hi!==0&&this.lo!==0||(this.lo&this.lo-1)!==0||(this.hi&this.hi-1)!==0}singleSquare(){return this.moreThanOne()?void 0:this.last()}*[Symbol.iterator](){let t=this.lo,n=this.hi;for(;t!==0;){const r=31-Math.clz32(t&-t);t^=1<<r,yield r}for(;n!==0;){const r=31-Math.clz32(n&-n);n^=1<<r,yield 32+r}}*reversed(){let t=this.lo,n=this.hi;for(;n!==0;){const r=31-Math.clz32(n);n^=1<<r,yield 32+r}for(;t!==0;){const r=31-Math.clz32(t);t^=1<<r,yield r}}}const bt=(e,t)=>{let n=d.empty();for(const r of t){const i=e+r;0<=i&&i<64&&Math.abs(J(e)-J(i))<=2&&(n=n.with(i))}return n},pe=e=>{const t=[];for(let n=0;n<64;n++)t[n]=e(n);return t},js=pe(e=>bt(e,[-9,-8,-7,-1,1,7,8,9])),Us=pe(e=>bt(e,[-17,-15,-10,-6,6,10,15,17])),Ws={white:pe(e=>bt(e,[7,9])),black:pe(e=>bt(e,[-7,-9]))},Pn=e=>js[e],En=e=>Us[e],Pt=(e,t)=>Ws[e][t],Xt=pe(e=>d.fromFile(J(e)).without(e)),Zt=pe(e=>d.fromRank(Ee(e)).without(e)),Jt=pe(e=>{const t=new d(134480385,2151686160),n=8*(Ee(e)-J(e));return(n>=0?t.shl64(n):t.shr64(-n)).without(e)}),en=pe(e=>{const t=new d(270549120,16909320),n=8*(Ee(e)+J(e)-7);return(n>=0?t.shl64(n):t.shr64(-n)).without(e)}),tn=(e,t,n)=>{let r=n.intersect(t),i=r.bswap64();return r=r.minus64(e),i=i.minus64(e.bswap64()),r.xor(i.bswap64()).intersect(t)},zs=(e,t)=>tn(d.fromSquare(e),Xt[e],t),Hs=(e,t)=>{const n=Zt[e];let r=t.intersect(n),i=r.rbit64();return r=r.minus64(d.fromSquare(e)),i=i.minus64(d.fromSquare(63-e)),r.xor(i.rbit64()).intersect(n)},Ge=(e,t)=>{const n=d.fromSquare(e);return tn(n,Jt[e],t).xor(tn(n,en[e],t))},Qe=(e,t)=>zs(e,t).xor(Hs(e,t)),Gr=(e,t)=>Ge(e,t).xor(Qe(e,t)),Qr=(e,t)=>{const n=d.fromSquare(t);return Zt[e].intersects(n)?Zt[e].with(e):en[e].intersects(n)?en[e].with(e):Jt[e].intersects(n)?Jt[e].with(e):Xt[e].intersects(n)?Xt[e].with(e):d.empty()},Ye=(e,t)=>Qr(e,t).intersect(d.full().shl64(e).xor(d.full().shl64(t))).withoutFirst();class Le{constructor(){}static default(){const t=new Le;return t.reset(),t}reset(){this.occupied=new d(65535,4294901760),this.promoted=d.empty(),this.white=new d(65535,0),this.black=new d(0,4294901760),this.pawn=new d(65280,16711680),this.knight=new d(66,1107296256),this.bishop=new d(36,603979776),this.rook=new d(129,2164260864),this.queen=new d(8,134217728),this.king=new d(16,268435456)}static empty(){const t=new Le;return t.clear(),t}clear(){this.occupied=d.empty(),this.promoted=d.empty();for(const t of Pe)this[t]=d.empty();for(const t of re)this[t]=d.empty()}clone(){const t=new Le;t.occupied=this.occupied,t.promoted=this.promoted;for(const n of Pe)t[n]=this[n];for(const n of re)t[n]=this[n];return t}getColor(t){if(this.white.has(t))return"white";if(this.black.has(t))return"black"}getRole(t){for(const n of re)if(this[n].has(t))return n}get(t){const n=this.getColor(t);if(!n)return;const r=this.getRole(t),i=this.promoted.has(t);return{color:n,role:r,promoted:i}}take(t){const n=this.get(t);return n&&(this.occupied=this.occupied.without(t),this[n.color]=this[n.color].without(t),this[n.role]=this[n.role].without(t),n.promoted&&(this.promoted=this.promoted.without(t))),n}set(t,n){const r=this.take(t);return this.occupied=this.occupied.with(t),this[n.color]=this[n.color].with(t),this[n.role]=this[n.role].with(t),n.promoted&&(this.promoted=this.promoted.with(t)),r}has(t){return this.occupied.has(t)}*[Symbol.iterator](){for(const t of this.occupied)yield[t,this.get(t)]}pieces(t,n){return this[t].intersect(this[n])}rooksAndQueens(){return this.rook.union(this.queen)}bishopsAndQueens(){return this.bishop.union(this.queen)}steppers(){return this.knight.union(this.pawn).union(this.king)}sliders(){return this.bishop.union(this.rook).union(this.queen)}kingOf(t){return this.pieces(t,"king").singleSquare()}}class oe{constructor(){}static empty(){const t=new oe;for(const n of re)t[n]=0;return t}static fromBoard(t,n){const r=new oe;for(const i of re)r[i]=t.pieces(n,i).size();return r}clone(){const t=new oe;for(const n of re)t[n]=this[n];return t}equals(t){return re.every(n=>this[n]===t[n])}add(t){const n=new oe;for(const r of re)n[r]=this[r]+t[r];return n}subtract(t){const n=new oe;for(const r of re)n[r]=this[r]-t[r];return n}nonEmpty(){return re.some(t=>this[t]>0)}isEmpty(){return!this.nonEmpty()}hasPawns(){return this.pawn>0}hasNonPawns(){return this.knight>0||this.bishop>0||this.rook>0||this.queen>0||this.king>0}size(){return this.pawn+this.knight+this.bishop+this.rook+this.queen+this.king}}class ke{constructor(t,n){this.white=t,this.black=n}static empty(){return new ke(oe.empty(),oe.empty())}static fromBoard(t){return new ke(oe.fromBoard(t,"white"),oe.fromBoard(t,"black"))}clone(){return new ke(this.white.clone(),this.black.clone())}equals(t){return this.white.equals(t.white)&&this.black.equals(t.black)}add(t){return new ke(this.white.add(t.white),this.black.add(t.black))}subtract(t){return new ke(this.white.subtract(t.white),this.black.subtract(t.black))}count(t){return this.white[t]+this.black[t]}size(){return this.white.size()+this.black.size()}isEmpty(){return this.white.isEmpty()&&this.black.isEmpty()}nonEmpty(){return!this.isEmpty()}hasPawns(){return this.white.hasPawns()||this.black.hasPawns()}hasNonPawns(){return this.white.hasNonPawns()||this.black.hasNonPawns()}}class Xe{constructor(t,n){this.white=t,this.black=n}static default(){return new Xe(3,3)}clone(){return new Xe(this.white,this.black)}equals(t){return this.white===t.white&&this.black===t.black}}class Yr{unwrap(t,n){const r=this._chain(i=>v.ok(t?t(i):i),i=>n?v.ok(n(i)):v.err(i));if(r.isErr)throw r.error;return r.value}map(t,n){return this._chain(r=>v.ok(t(r)),r=>v.err(n?n(r):r))}chain(t,n){return this._chain(t,n??(r=>v.err(r)))}}class qs extends Yr{constructor(t){super(),this.value=t,this.isOk=!0,this.isErr=!1}_chain(t,n){return t(this.value)}}class Vs extends Yr{constructor(t){super(),this.error=t,this.isOk=!1,this.isErr=!0}_chain(t,n){return n(this.error)}}var v;(function(e){function t(i){return new qs(i)}e.ok=t;function n(i){return new Vs(i||new Error)}e.err=n;function r(i){if(Array.isArray(i)){const c=[];for(let l=0;l<i.length;l++){const a=i[l];if(a.isErr)return a;c.push(a.value)}return e.ok(c)}const o={},s=Object.keys(i);for(let c=0;c<s.length;c++){const l=i[s[c]];if(l.isErr)return l;o[s[c]]=l.value}return e.ok(o)}e.all=r})(v||(v={}));var he;(function(e){e.Empty="ERR_EMPTY",e.OppositeCheck="ERR_OPPOSITE_CHECK",e.PawnsOnBackrank="ERR_PAWNS_ON_BACKRANK",e.Kings="ERR_KINGS",e.Variant="ERR_VARIANT"})(he||(he={}));class $e extends Error{}const Gs=(e,t,n,r)=>n[t].intersect(Qe(e,r).intersect(n.rooksAndQueens()).union(Ge(e,r).intersect(n.bishopsAndQueens())).union(En(e).intersect(n.knight)).union(Pn(e).intersect(n.king)).union(Pt(j(t),e).intersect(n.pawn)));class ye{constructor(){}static default(){const t=new ye;return t.castlingRights=d.corners(),t.rook={white:{a:0,h:7},black:{a:56,h:63}},t.path={white:{a:new d(14,0),h:new d(96,0)},black:{a:new d(0,234881024),h:new d(0,1610612736)}},t}static empty(){const t=new ye;return t.castlingRights=d.empty(),t.rook={white:{a:void 0,h:void 0},black:{a:void 0,h:void 0}},t.path={white:{a:d.empty(),h:d.empty()},black:{a:d.empty(),h:d.empty()}},t}clone(){const t=new ye;return t.castlingRights=this.castlingRights,t.rook={white:{a:this.rook.white.a,h:this.rook.white.h},black:{a:this.rook.black.a,h:this.rook.black.h}},t.path={white:{a:this.path.white.a,h:this.path.white.h},black:{a:this.path.black.a,h:this.path.black.h}},t}add(t,n,r,i){const o=vn(t,n),s=Cn(t,n);this.castlingRights=this.castlingRights.with(i),this.rook[t][n]=i,this.path[t][n]=Ye(i,s).with(s).union(Ye(r,o).with(o)).without(r).without(i)}static fromSetup(t){const n=ye.empty(),r=t.castlingRights.intersect(t.board.rook);for(const i of Pe){const o=d.backrank(i),s=t.board.kingOf(i);if(!y(s)||!o.has(s))continue;const c=r.intersect(t.board[i]).intersect(o),l=c.first();y(l)&&l<s&&n.add(i,"a",s,l);const a=c.last();y(a)&&s<a&&n.add(i,"h",s,a)}return n}discardRook(t){if(this.castlingRights.has(t)){this.castlingRights=this.castlingRights.without(t);for(const n of Pe)for(const r of Is)this.rook[n][r]===t&&(this.rook[n][r]=void 0)}}discardColor(t){this.castlingRights=this.castlingRights.diff(d.backrank(t)),this.rook[t].a=void 0,this.rook[t].h=void 0}}class Qs{constructor(t){this.rules=t}reset(){this.board=Le.default(),this.pockets=void 0,this.turn="white",this.castles=ye.default(),this.epSquare=void 0,this.remainingChecks=void 0,this.halfmoves=0,this.fullmoves=1}setupUnchecked(t){this.board=t.board.clone(),this.board.promoted=d.empty(),this.pockets=void 0,this.turn=t.turn,this.castles=ye.fromSetup(t),this.epSquare=Ys(this,t.epSquare),this.remainingChecks=void 0,this.halfmoves=t.halfmoves,this.fullmoves=t.fullmoves}kingAttackers(t,n,r){return Gs(t,n,this.board,r)}playCaptureAt(t,n){this.halfmoves=0,n.role==="rook"&&this.castles.discardRook(t),this.pockets&&this.pockets[j(n.color)][n.promoted?"pawn":n.role]++}ctx(){const t=this.isVariantEnd(),n=this.board.kingOf(this.turn);if(!y(n))return{king:n,blockers:d.empty(),checkers:d.empty(),variantEnd:t,mustCapture:!1};const r=Qe(n,d.empty()).intersect(this.board.rooksAndQueens()).union(Ge(n,d.empty()).intersect(this.board.bishopsAndQueens())).intersect(this.board[j(this.turn)]);let i=d.empty();for(const s of r){const c=Ye(n,s).intersect(this.board.occupied);c.moreThanOne()||(i=i.union(c))}const o=this.kingAttackers(n,j(this.turn),this.board.occupied);return{king:n,blockers:i,checkers:o,variantEnd:t,mustCapture:!1}}clone(){var t,n;const r=new this.constructor;return r.board=this.board.clone(),r.pockets=(t=this.pockets)===null||t===void 0?void 0:t.clone(),r.turn=this.turn,r.castles=this.castles.clone(),r.epSquare=this.epSquare,r.remainingChecks=(n=this.remainingChecks)===null||n===void 0?void 0:n.clone(),r.halfmoves=this.halfmoves,r.fullmoves=this.fullmoves,r}validate(){if(this.board.occupied.isEmpty())return v.err(new $e(he.Empty));if(this.board.king.size()!==2)return v.err(new $e(he.Kings));if(!y(this.board.kingOf(this.turn)))return v.err(new $e(he.Kings));const t=this.board.kingOf(j(this.turn));return y(t)?this.kingAttackers(t,this.turn,this.board.occupied).nonEmpty()?v.err(new $e(he.OppositeCheck)):d.backranks().intersects(this.board.pawn)?v.err(new $e(he.PawnsOnBackrank)):v.ok(void 0):v.err(new $e(he.Kings))}dropDests(t){return d.empty()}dests(t,n){if(n=n||this.ctx(),n.variantEnd)return d.empty();const r=this.board.get(t);if(!r||r.color!==this.turn)return d.empty();let i,o;if(r.role==="pawn"){i=Pt(this.turn,t).intersect(this.board[j(this.turn)]);const s=this.turn==="white"?8:-8,c=t+s;if(0<=c&&c<64&&!this.board.occupied.has(c)){i=i.with(c);const l=this.turn==="white"?t<16:t>=48,a=c+s;l&&!this.board.occupied.has(a)&&(i=i.with(a))}y(this.epSquare)&&Zs(this,t,n)&&(o=d.fromSquare(this.epSquare))}else r.role==="bishop"?i=Ge(t,this.board.occupied):r.role==="knight"?i=En(t):r.role==="rook"?i=Qe(t,this.board.occupied):r.role==="queen"?i=Gr(t,this.board.occupied):i=Pn(t);if(i=i.diff(this.board[this.turn]),y(n.king)){if(r.role==="king"){const s=this.board.occupied.without(t);for(const c of i)this.kingAttackers(c,j(this.turn),s).nonEmpty()&&(i=i.without(c));return i.union(qn(this,"a",n)).union(qn(this,"h",n))}if(n.checkers.nonEmpty()){const s=n.checkers.singleSquare();if(!y(s))return d.empty();i=i.intersect(Ye(s,n.king).with(s))}n.blockers.has(t)&&(i=i.intersect(Qr(t,n.king)))}return o&&(i=i.union(o)),i}isVariantEnd(){return!1}variantOutcome(t){}hasInsufficientMaterial(t){return this.board[t].intersect(this.board.pawn.union(this.board.rooksAndQueens())).nonEmpty()?!1:this.board[t].intersects(this.board.knight)?this.board[t].size()<=2&&this.board[j(t)].diff(this.board.king).diff(this.board.queen).isEmpty():this.board[t].intersects(this.board.bishop)?(!this.board.bishop.intersects(d.darkSquares())||!this.board.bishop.intersects(d.lightSquares()))&&this.board.pawn.isEmpty()&&this.board.knight.isEmpty():!0}toSetup(){var t,n;return{board:this.board.clone(),pockets:(t=this.pockets)===null||t===void 0?void 0:t.clone(),turn:this.turn,castlingRights:this.castles.castlingRights,epSquare:Xs(this),remainingChecks:(n=this.remainingChecks)===null||n===void 0?void 0:n.clone(),halfmoves:Math.min(this.halfmoves,150),fullmoves:Math.min(Math.max(this.fullmoves,1),9999)}}isInsufficientMaterial(){return Pe.every(t=>this.hasInsufficientMaterial(t))}hasDests(t){t=t||this.ctx();for(const n of this.board[this.turn])if(this.dests(n,t).nonEmpty())return!0;return this.dropDests(t).nonEmpty()}isLegal(t,n){if(wt(t))return!this.pockets||this.pockets[this.turn][t.role]<=0||t.role==="pawn"&&d.backranks().has(t.to)?!1:this.dropDests(n).has(t.to);{if(t.promotion==="pawn"||t.promotion==="king"&&this.rules!=="antichess"||!!t.promotion!==(this.board.pawn.has(t.from)&&d.backranks().has(t.to)))return!1;const r=this.dests(t.from,n);return r.has(t.to)||r.has(Js(this,t).to)}}isCheck(){const t=this.board.kingOf(this.turn);return y(t)&&this.kingAttackers(t,j(this.turn),this.board.occupied).nonEmpty()}isEnd(t){return(t?t.variantEnd:this.isVariantEnd())?!0:this.isInsufficientMaterial()||!this.hasDests(t)}isCheckmate(t){return t=t||this.ctx(),!t.variantEnd&&t.checkers.nonEmpty()&&!this.hasDests(t)}isStalemate(t){return t=t||this.ctx(),!t.variantEnd&&t.checkers.isEmpty()&&!this.hasDests(t)}outcome(t){const n=this.variantOutcome(t);return n||(t=t||this.ctx(),this.isCheckmate(t)?{winner:j(this.turn)}:this.isInsufficientMaterial()||this.isStalemate(t)?{winner:void 0}:void 0)}allDests(t){t=t||this.ctx();const n=new Map;if(t.variantEnd)return n;for(const r of this.board[this.turn])n.set(r,this.dests(r,t));return n}play(t){const n=this.turn,r=this.epSquare,i=Zr(this,t);if(this.epSquare=void 0,this.halfmoves+=1,n==="black"&&(this.fullmoves+=1),this.turn=j(n),wt(t))this.board.set(t.to,{role:t.role,color:n}),this.pockets&&this.pockets[n][t.role]--,t.role==="pawn"&&(this.halfmoves=0);else{const o=this.board.take(t.from);if(!o)return;let s;if(o.role==="pawn"){this.halfmoves=0,t.to===r&&(s=this.board.take(t.to+(n==="white"?-8:8)));const c=t.from-t.to;Math.abs(c)===16&&8<=t.from&&t.from<=55&&(this.epSquare=t.from+t.to>>1),t.promotion&&(o.role=t.promotion,o.promoted=!!this.pockets)}else if(o.role==="rook")this.castles.discardRook(t.from);else if(o.role==="king"){if(i){const c=this.castles.rook[n][i];if(y(c)){const l=this.board.take(c);this.board.set(vn(n,i),o),l&&this.board.set(Cn(n,i),l)}}this.castles.discardColor(n)}if(!i){const c=this.board.set(t.to,o)||s;c&&this.playCaptureAt(t.to,c)}}this.remainingChecks&&this.isCheck()&&(this.remainingChecks[n]=Math.max(this.remainingChecks[n]-1,0))}}class Xr extends Qs{constructor(){super("chess")}static default(){const t=new this;return t.reset(),t}static fromSetup(t){const n=new this;return n.setupUnchecked(t),n.validate().map(r=>n)}clone(){return super.clone()}}const Ys=(e,t)=>{if(!y(t))return;const n=e.turn==="white"?5:2,r=e.turn==="white"?8:-8;if(Ee(t)!==n||e.board.occupied.has(t+r))return;const i=t-r;if(!(!e.board.pawn.has(i)||!e.board[j(e.turn)].has(i)))return t},Xs=e=>{if(!y(e.epSquare))return;const t=e.ctx(),r=e.board.pieces(e.turn,"pawn").intersect(Pt(j(e.turn),e.epSquare));for(const i of r)if(e.dests(i,t).has(e.epSquare))return e.epSquare},Zs=(e,t,n)=>{if(!y(e.epSquare)||!Pt(e.turn,t).has(e.epSquare))return!1;if(!y(n.king))return!0;const r=e.turn==="white"?8:-8,i=e.epSquare-r;return e.kingAttackers(n.king,j(e.turn),e.board.occupied.toggle(t).toggle(i).with(e.epSquare)).without(i).isEmpty()},qn=(e,t,n)=>{if(!y(n.king)||n.checkers.nonEmpty())return d.empty();const r=e.castles.rook[e.turn][t];if(!y(r)||e.castles.path[e.turn][t].intersects(e.board.occupied))return d.empty();const i=vn(e.turn,t),o=Ye(n.king,i),s=e.board.occupied.without(n.king);for(const a of o)if(e.kingAttackers(a,j(e.turn),s).nonEmpty())return d.empty();const c=Cn(e.turn,t),l=e.board.occupied.toggle(n.king).toggle(r).toggle(c);return e.kingAttackers(i,j(e.turn),l).nonEmpty()?d.empty():d.fromSquare(r)},Zr=(e,t)=>{if(wt(t))return;const n=t.to-t.from;if(!(Math.abs(n)!==2&&!e.board[e.turn].has(t.to))&&e.board.king.has(t.from))return n>0?"h":"a"},Js=(e,t)=>{const n=Zr(e,t);if(!n)return t;const r=e.castles.rook[e.turn][n];return{from:t.from,to:y(r)?r:t.to}},ec="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",tc=ec+" w KQkq -",An=tc+" 0 1";var K;(function(e){e.Fen="ERR_FEN",e.Board="ERR_BOARD",e.Pockets="ERR_POCKETS",e.Turn="ERR_TURN",e.Castling="ERR_CASTLING",e.EpSquare="ERR_EP_SQUARE",e.RemainingChecks="ERR_REMAINING_CHECKS",e.Halfmoves="ERR_HALFMOVES",e.Fullmoves="ERR_FULLMOVES"})(K||(K={}));class U extends Error{}const nc=(e,t,n)=>{let r=e.indexOf(t);for(;n-- >0&&r!==-1;)r=e.indexOf(t,r+t.length);return r},Me=e=>/^\d{1,4}$/.test(e)?parseInt(e,10):void 0,Jr=e=>{const t=Qt(e);return t&&{role:t,color:e.toLowerCase()===e?"black":"white"}},Dt=e=>{const t=Le.empty();let n=7,r=0;for(let i=0;i<e.length;i++){const o=e[i];if(o==="/"&&r===8)r=0,n--;else{const s=parseInt(o,10);if(s>0)r+=s;else{if(r>=8||n<0)return v.err(new U(K.Board));const c=r+n*8,l=Jr(o);if(!l)return v.err(new U(K.Board));e[i+1]==="~"&&(l.promoted=!0,i++),t.set(c,l),r++}}}return n!==0||r!==8?v.err(new U(K.Board)):v.ok(t)},Vn=e=>{if(e.length>64)return v.err(new U(K.Pockets));const t=ke.empty();for(const n of e){const r=Jr(n);if(!r)return v.err(new U(K.Pockets));t[r.color][r.role]++}return v.ok(t)},rc=(e,t)=>{let n=d.empty();if(t==="-")return v.ok(n);for(const r of t){const i=r.toLowerCase(),o=r===i?"black":"white",s=o==="white"?0:7;if("a"<=i&&i<="h")n=n.with(Gt(i.charCodeAt(0)-97,s));else if(i==="k"||i==="q"){const c=e[o].intersect(d.backrank(o)).intersect(e.rook.union(e.king)),l=i==="k"?c.last():c.first();n=n.with(y(l)&&e.rook.has(l)?l:Gt(i==="k"?7:0,s))}else return v.err(new U(K.Castling))}return Pe.some(r=>d.backrank(r).intersect(n).size()>2)?v.err(new U(K.Castling)):v.ok(n)},Gn=e=>{const t=e.split("+");if(t.length===3&&t[0]===""){const n=Me(t[1]),r=Me(t[2]);return!y(n)||n>3||!y(r)||r>3?v.err(new U(K.RemainingChecks)):v.ok(new Xe(3-n,3-r))}else if(t.length===2){const n=Me(t[0]),r=Me(t[1]);return!y(n)||n>3||!y(r)||r>3?v.err(new U(K.RemainingChecks)):v.ok(new Xe(n,r))}else return v.err(new U(K.RemainingChecks))},ic=e=>{const t=e.split(/[\s_]+/),n=t.shift();let r,i=v.ok(void 0);if(n.endsWith("]")){const c=n.indexOf("[");if(c===-1)return v.err(new U(K.Fen));r=Dt(n.slice(0,c)),i=Vn(n.slice(c+1,-1))}else{const c=nc(n,"/",7);c===-1?r=Dt(n):(r=Dt(n.slice(0,c)),i=Vn(n.slice(c+1)))}let o;const s=t.shift();if(!y(s)||s==="w")o="white";else if(s==="b")o="black";else return v.err(new U(K.Turn));return r.chain(c=>{const l=t.shift(),a=y(l)?rc(c,l):v.ok(d.empty()),f=t.shift();let u;if(y(f)&&f!=="-"&&(u=We(f),!y(u)))return v.err(new U(K.EpSquare));let h=t.shift(),g;y(h)&&h.includes("+")&&(g=Gn(h),h=t.shift());const m=y(h)?Me(h):0;if(!y(m))return v.err(new U(K.Halfmoves));const p=t.shift(),w=y(p)?Me(p):1;if(!y(w))return v.err(new U(K.Fullmoves));const k=t.shift();let b=v.ok(void 0);if(y(k)){if(y(g))return v.err(new U(K.RemainingChecks));b=Gn(k)}else y(g)&&(b=g);return t.length>0?v.err(new U(K.Fen)):i.chain(A=>a.chain(_=>b.map(C=>({board:c,pockets:A,turn:o,castlingRights:_,remainingChecks:C,epSquare:u,halfmoves:m,fullmoves:Math.max(1,w)}))))})},oc=e=>{let t=Ue(e.role);return e.color==="white"&&(t=t.toUpperCase()),e.promoted&&(t+="~"),t},sc=e=>{let t="",n=0;for(let r=7;r>=0;r--)for(let i=0;i<8;i++){const o=i+r*8,s=e.get(o);s?(n>0&&(t+=n,n=0),t+=oc(s)):n++,i===7&&(n>0&&(t+=n,n=0),r!==0&&(t+="/"))}return t},Qn=e=>re.map(t=>Ue(t).repeat(e[t])).join(""),cc=e=>Qn(e.white).toUpperCase()+Qn(e.black),lc=(e,t)=>{let n="";for(const r of Pe){const i=d.backrank(r);let o=e.kingOf(r);y(o)&&!i.has(o)&&(o=void 0);const s=e.pieces(r,"rook").intersect(i);for(const c of t.intersect(i).reversed())if(c===s.first()&&y(o)&&c<o)n+=r==="white"?"Q":"q";else if(c===s.last()&&y(o)&&o<c)n+=r==="white"?"K":"k";else{const l=mt[J(c)];n+=r==="white"?l.toUpperCase():l}}return n||"-"},ac=e=>`${e.white}+${e.black}`,uc=(e,t)=>[sc(e.board)+(e.pockets?`[${cc(e.pockets)}]`:""),e.turn[0],lc(e.board,e.castlingRights),y(e.epSquare)?Ve(e.epSquare):"-",...e.remainingChecks?[ac(e.remainingChecks)]:[],Math.max(0,Math.min(e.halfmoves,9999)),Math.max(1,Math.min(e.fullmoves,9999))].join(" "),fc=(e,t)=>{let n="";if(wt(t))t.role!=="pawn"&&(n=Ue(t.role).toUpperCase()),n+="@"+Ve(t.to);else{const r=e.board.getRole(t.from);if(!r)return"--";if(r==="king"&&(e.board[e.turn].has(t.to)||Math.abs(t.to-t.from)===2))n=t.to>t.from?"O-O":"O-O-O";else{const i=e.board.occupied.has(t.to)||r==="pawn"&&J(t.from)!==J(t.to);if(r!=="pawn"){n=Ue(r).toUpperCase();let o;if(r==="king"?o=Pn(t.to).intersect(e.board.king):r==="queen"?o=Gr(t.to,e.board.occupied).intersect(e.board.queen):r==="rook"?o=Qe(t.to,e.board.occupied).intersect(e.board.rook):r==="bishop"?o=Ge(t.to,e.board.occupied).intersect(e.board.bishop):o=En(t.to).intersect(e.board.knight),o=o.intersect(e.board[e.turn]).without(t.from),o.nonEmpty()){const s=e.ctx();for(const c of o)e.dests(c,s).has(t.to)||(o=o.without(c));if(o.nonEmpty()){let c=!1,l=o.intersects(d.fromRank(Ee(t.from)));o.intersects(d.fromFile(J(t.from)))?c=!0:l=!0,l&&(n+=mt[J(t.from)]),c&&(n+=Vr[Ee(t.from)])}}}else i&&(n=mt[J(t.from)]);i&&(n+="x"),n+=Ve(t.to),t.promotion&&(n+="="+Ue(t.promotion).toUpperCase())}}return n},dc=(e,t)=>{var n;const r=fc(e,t);return e.play(t),!((n=e.outcome())===null||n===void 0)&&n.winner?r+"#":e.isCheck()?r+"+":r},hc=(e,t)=>dc(e.clone(),t),Et=e=>Xr.fromSetup(ic(e).unwrap()).unwrap(),pc=e=>Et(e).turn,gc=(e,t)=>{let n=e[e.length-1]?.fen??An,r=Et(n),i=Ks(t),o=hc(r,i);return r.play(i),{fen:uc(r.toSetup()),before_fen:n,uci:t,san:o}},mc=e=>e.map((t,n)=>`${ei(n+1)}${t.san}`).join(" "),ei=e=>e%2===0?"":wc(e),wc=e=>`${Math.ceil(e/2)}.`+(e%2===0?"..":"");var bc=ne('<div class="is2d chessboard"> ');function kc(e){let t,n,r=x(()=>{try{return Et(e.fen??An)}catch{return Xr.default()}}),i=x(()=>Fs(r())),o=x(()=>r().isCheck());return ci(()=>{let s=r().isCheck(),c={fen:e.fen,check:s,premovable:{enabled:!1},movable:{color:e.movable_color,free:!1,dests:i(),events:{after:e.play_orig_key}}};n=Ns(t,c)}),It(()=>{let s;if(e.last_move_uci){let c=e.last_move_uci;s=[c.slice(0,2),c.slice(2,4)]}n.set({lastMove:s,fen:e.fen,turnColor:e.turn_color,orientation:e.orientation??"white",check:o(),movable:{color:e.movable_color,dests:i()}})}),It(()=>{n.setAutoShapes(e.shapes??[])}),(()=>{var s=bc();return lr(c=>t=c,s),s})()}const yc=e=>Bs(t=>{const n=t.target;n.tagName!=="PIECE"&&n.tagName!=="SQUARE"&&n.tagName!=="CG-BOARD"||(t.preventDefault(),e(Math.sign(t.deltaY)))});var vc=ne("<button class=draw>");function Cc(e){return(()=>{var t=vc();return je(t,"click",e.onClick,!0),B(t,()=>e.children),se(n=>{var r=e.disabled,i=!!e.gray,o=!!(e.draw||e.meet),s=!!e.meet;return r!==n.e&&(t.disabled=n.e=r),i!==n.t&&t.classList.toggle("gray",n.t=i),o!==n.a&&t.classList.toggle("draw",n.a=o),s!==n.o&&t.classList.toggle("meet",n.o=s),n},{e:void 0,t:void 0,a:void 0,o:void 0}),t})()}Ze(["click"]);var Pc=ne("<ul class=replay>"),Ec=ne("<li class=move><span class=index>");function Ac(e){return(()=>{var t=Pc();return B(t,T(ki,{get fallback(){return e.fallback},get each(){return e.san_moves},children:(n,r)=>(()=>{var i=Ec(),o=i.firstChild;return i.$$click=()=>e.on_set_cursor(r()),B(o,()=>ei(r()+1)),B(i,n,null),se(()=>i.classList.toggle("cursor",e.cursor===r())),i})()})),t})()}Ze(["click"]);var _c=ne('<div class=openings><div class=build><h3>Build</h3><div class=board-wrap><div class=board></div></div><div class=board-tools><a>Flip</a></div><div class=replay-wrap><div class=replay-tools><a></a><a>Clear</a><a>Delete after</a></div></div><div class=tools><input type=text placeholder="Opening Line Name"><div class=action><a><small>+ Add to Playlist</small></a></div></div></div><div class=explore><h3>Explore</h3></div><div class=playlist><h3>Playlist'),Sc=ne("<span>Play an opening line to save it.");const xc=()=>{let[e,t]=W(0);const[n,r]=W([]),i=x(()=>n()[e()]),o=x(()=>i()?.fen??An),s=x(()=>pc(o())),c=x(()=>n().map(m=>m.san)),l=x(()=>i()?.uci),a=x(()=>n().slice(0,e()+1)),f=x(()=>mc(n()));let u={get cursor(){return e()},get fen(){return o()},get turn_color(){return s()},get san_moves(){return c()},get last_move_uci(){return l()},get export_PGN(){return f()}};const h=m=>{m<0?t(-1):n()[m]!==void 0&&t(m)};return[u,{add_uci_and_goto_it(m){er(()=>{let p=a(),w=gc(p,m);r([...p,w]),t(n().length-1)})},goto_next_step(){h(e()+1)},goto_prev_step(){h(e()-1)},goto_first_step(){h(0)},goto_last_step(){h(n().length-1)},goto_set_cursor(m){h(m)},clear_steps(){r([]),t(0)},delete_after(){r(a())}}]},Rc=()=>{let[e,{add_uci_and_goto_it:t,goto_next_step:n,goto_prev_step:r,goto_set_cursor:i,clear_steps:o,delete_after:s}]=xc();const c=(w,k)=>{let b=w+k;{let A=Et(e.fen),_=A.turn;A.board.get(We(w)).role==="pawn"&&(k[1]==="8"&&_==="white"||k[1]==="1"&&_==="black")&&(b+="q")}t(b)},l=w=>{w<0?r():n()};let[a,f]=W("white");const u=()=>{f(j(a()))},[h,g]=W(!1),m=x(()=>h()?"Copied!":"Copy"),p=async()=>{await navigator.clipboard.writeText(e.export_PGN),g(!0),await new Promise(w=>setTimeout(w,1e3)),g(!1)};return(()=>{var w=_c(),k=w.firstChild,b=k.firstChild,A=b.nextSibling,_=A.firstChild,C=A.nextSibling,H=C.firstChild,q=C.nextSibling,$=q.firstChild,V=$.firstChild,R=V.nextSibling,S=R.nextSibling,I=q.nextSibling,D=I.firstChild,E=D.nextSibling,L=E.firstChild;return je(_,"wheel",yc(l)),B(_,T(kc,{get fen(){return e.fen},play_orig_key:c,get turn_color(){return e.turn_color},get movable_color(){return e.turn_color},get orientation(){return a()},get last_move_uci(){return e.last_move_uci}})),H.$$click=u,B(q,T(Ac,{get fallback(){return Sc()},get san_moves(){return e.san_moves},get cursor(){return e.cursor},on_set_cursor:i}),$),V.$$click=p,B(V,m),je(R,"click",o,!0),je(S,"click",s,!0),D.required=!0,B(E,T(Cc,{meet:!0,children:"Save"}),L),w})()};Ze(["click"]);var Oc=ne("<div class=challenges><div class=skills><h3>Skills</h3></div><div class=boards><h3>Leaderboards");const $c=()=>Oc();var Mc=ne("<div class=main-wrap>"),Lc=ne("<small class=com>.com"),Tc=ne("<main class=main><h1></h1><p> Explore, Build, and Share opening lines.</p><p> Complete Challenges on a unique Skill Tree. </p><p> Compete on the Leaderboards. </p><p> Free, Open Source, No Ads, No Trackers.</p><p>For the  of Chess</p><p><small> to make your data publicly available.</small></p><section class=section-openings><h2>Openings</h2></section><section class=section-challenges><h2>Challenges"),Nc=ne("<footer><!><!>");const Dc=vt(()=>Ct(()=>import("./MainLegal-CRYUpMf9.js"),__vite__mapDeps([0,1]))),Ic=vt(()=>Ct(()=>import("./Main404-Ct9x2UA7.js"),[])),Kc=vt(()=>Ct(()=>import("./MainAbout-hH5OZPHV.js"),__vite__mapDeps([2,1]))),Fc=vt(()=>Ct(()=>import("./MainContact-c7rxTmkE.js"),__vite__mapDeps([3,4,1])));function Bc(){return T(mo,{root:jc,get children(){return[T(De,{path:"/",component:Uc}),T(De,{path:"/about",component:Kc}),T(De,{path:"/legal",component:Dc}),T(De,{path:"/contact",component:Fc}),T(De,{path:"*",component:Ic})]}})}function jc(e){return(()=>{var t=Mc();return B(t,()=>e.children),t})()}function Uc(){return[(()=>{var e=Tc(),t=e.firstChild,n=t.nextSibling,r=n.nextSibling,i=r.nextSibling,o=i.nextSibling,s=o.nextSibling,c=s.nextSibling,l=c.firstChild,a=l.firstChild,f=c.nextSibling;f.firstChild;var u=f.nextSibling;return u.firstChild,B(t,T(Oe,{class:"title",href:"/",get children(){return["LineChess",Lc()]}})),B(l,T(Oe,{href:"/lichess",children:"Login with Lichess"}),a),B(f,T(Rc,{}),null),B(u,T($c,{}),null),e})(),(()=>{var e=Nc(),t=e.firstChild,n=t.nextSibling,r=n.nextSibling,i=r.nextSibling;return i.nextSibling,B(e,T(Oe,{href:"/",children:"LineChess.com"}),t),B(e,T(Oe,{href:"/about",children:"About"}),n),B(e,T(Oe,{href:"/legal",children:"Legal"}),i),B(e,T(Oe,{href:"/contact",children:"Contact"}),null),e})()]}const Wc=document.getElementById("root");Ri(()=>T(Bc,{}),Wc);export{Oe as A,W as a,x as b,T as c,se as d,Ze as e,B as i,ne as t};
